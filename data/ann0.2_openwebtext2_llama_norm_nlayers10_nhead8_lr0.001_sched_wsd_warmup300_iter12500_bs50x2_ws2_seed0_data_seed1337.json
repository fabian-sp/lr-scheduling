{
    "summary": {
        "val/perplexity": 27.09102165415289,
        "iter": 12500,
        "_runtime": 569.2840371131897,
        "val/loss": 3.299204587936402,
        "train/loss": 3.205317258834839,
        "final-val/acc": 0.3978331983089447,
        "_wandb": {
            "runtime": 569
        },
        "val/acc": 0.3985778689384461,
        "_timestamp": 1715582665.8204942,
        "train/perplexity": 24.66327025694202,
        "lr": 0,
        "_step": 64,
        "iter_dt": 0.188136316,
        "parameters": 59845120,
        "final-val/loss": 3.300356864929199,
        "final-val/perplexity": 27.122255985951515,
        "optimized_parameters": 59845120
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 512,
        "n_head": 8,
        "compile": true,
        "dataset": "openwebtext2",
        "dropout": 0,
        "n_layer": 10,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 12500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/openwebtext2_llama_norm_nlayers10_nhead8_lr0.001_sched_wsd_warmup300_iter17500_bs50x2_ws2_seed0_data_seed1337/ckpts/10000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            7500,
            12500,
            17500
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-openwebtext",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_openwebtext2_llama_norm_nlayers10_nhead8_lr0.001_sched_wsd_warmup300_iter12500_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                12500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.300356864929199
            ],
            "final_val_perplexity": [
                27.122255985951515
            ]
        },
        "val": {
            "iter": [
                10000,
                10200,
                10400,
                10600,
                10800,
                11000,
                11200,
                11400,
                11600,
                11800,
                12000,
                12200,
                12400
            ],
            "val_perplexity": [
                31.81757881598236,
                31.517561464842373,
                31.06082848925011,
                30.620130276841046,
                30.218145512767702,
                29.728478053911427,
                29.28978624509813,
                28.89009519223447,
                28.470243146940042,
                28.071654487014275,
                27.70136956338176,
                27.34793752206039,
                27.091021654152886
            ],
            "val_loss": [
                3.4600212574005127,
                3.450547218322754,
                3.4359498023986816,
                3.4216599464416504,
                3.408444881439209,
                3.3921077251434326,
                3.3772411346435547,
                3.3635010719299316,
                3.3488616943359375,
                3.3347625732421875,
                3.321484088897705,
                3.308643341064453,
                3.2992045879364014
            ],
            "val_acc": [
                0.37901729345321655,
                0.3798547387123108,
                0.381683349609375,
                0.3838244676589966,
                0.38503050804138184,
                0.38706541061401367,
                0.38915157318115234,
                0.3906506299972534,
                0.3921545445919037,
                0.3941674828529358,
                0.3959313929080963,
                0.39713746309280396,
                0.39857786893844604
            ]
        },
        "train": {
            "iter": [
                10050,
                10100,
                10150,
                10200,
                10250,
                10300,
                10350,
                10400,
                10450,
                10500,
                10550,
                10600,
                10650,
                10700,
                10750,
                10800,
                10850,
                10900,
                10950,
                11000,
                11050,
                11100,
                11150,
                11200,
                11250,
                11300,
                11350,
                11400,
                11450,
                11500,
                11550,
                11600,
                11650,
                11700,
                11750,
                11800,
                11850,
                11900,
                11950,
                12000,
                12050,
                12100,
                12150,
                12200,
                12250,
                12300,
                12350,
                12400,
                12450,
                12500
            ],
            "train_perplexity": [
                27.82930296505039,
                31.55647231439461,
                34.610497375173125,
                30.94571687929232,
                35.87700990265562,
                33.159830748163536,
                30.9563504454497,
                29.074818300569348,
                32.828460924811274,
                30.510587031895238,
                30.735393728769285,
                30.14743633944424,
                31.1377850768686,
                33.72725529423794,
                30.155386988390003,
                31.087358814128073,
                34.67145738571947,
                25.972537772657194,
                29.665010709567124,
                25.124556074042484,
                31.220492162365044,
                27.97468974207584,
                31.075546651315396,
                29.04208317386965,
                26.04688383836392,
                26.83332037210249,
                29.86369413456047,
                33.71726960376752,
                29.485204378858256,
                31.12489256874602,
                27.294237356113698,
                27.02318390267454,
                25.435484506746675,
                31.022721101031635,
                24.27893376298759,
                27.98572357035337,
                24.657190902384393,
                31.326399435849705,
                28.959346661230963,
                27.305764481564626,
                27.04529827817462,
                24.04474305392244,
                26.853480248479062,
                24.718199274033893,
                26.44763373982826,
                28.703520734933676,
                23.168988177283843,
                27.875248543295445,
                26.852852824107753,
                24.66327025694202
            ],
            "train_lr": [
                0.00098,
                0.00096,
                0.00094,
                0.00092,
                0.0009000000000000001,
                0.00088,
                0.00086,
                0.00084,
                0.0008200000000000001,
                0.0008,
                0.0007800000000000001,
                0.00076,
                0.00074,
                0.0007199999999999999,
                0.0007,
                0.0006799999999999999,
                0.0006599999999999999,
                0.00064,
                0.00062,
                0.0006,
                0.0005800000000000001,
                0.0005600000000000001,
                0.00054,
                0.0005200000000000001,
                0.0005,
                0.00048,
                0.00045999999999999996,
                0.00043999999999999996,
                0.00042000000000000007,
                0.0004,
                0.00038,
                0.00035999999999999997,
                0.00033999999999999997,
                0.00031999999999999997,
                0.00030000000000000003,
                0.00028000000000000003,
                0.00026000000000000003,
                0.00024,
                0.00021999999999999998,
                0.00019999999999999996,
                0.00018000000000000007,
                0.00016000000000000004,
                0.00014000000000000001,
                0.00012,
                9.999999999999998e-05,
                7.999999999999997e-05,
                6.0000000000000056e-05,
                4.000000000000004e-05,
                2.000000000000002e-05,
                0
            ],
            "train_loss": [
                3.326091766357422,
                3.4517810344696045,
                3.544159412384033,
                3.432236909866333,
                3.580099105834961,
                3.5013415813446045,
                3.4325804710388184,
                3.3698747158050537,
                3.491298198699951,
                3.4180760383605957,
                3.425417184829712,
                3.406102180480957,
                3.4384243488311768,
                3.518308639526367,
                3.4063658714294434,
                3.4368035793304443,
                3.545919179916382,
                3.2570419311523438,
                3.389970541000366,
                3.2238478660583496,
                3.4410769939422607,
                3.3313024044036865,
                3.4364235401153564,
                3.368748188018799,
                3.2599003314971924,
                3.289646625518799,
                3.3966457843780518,
                3.518012523651123,
                3.3838908672332764,
                3.4380102157592773,
                3.30667781829834,
                3.2966973781585693,
                3.236147403717041,
                3.4347221851348877,
                3.1896111965179443,
                3.3316967487335205,
                3.205070734024048,
                3.4444634914398193,
                3.3658952713012695,
                3.3071000576019287,
                3.297515392303467,
                3.1799185276031494,
                3.2903976440429688,
                3.2075419425964355,
                3.2751688957214355,
                3.3570220470428467,
                3.1428167819976807,
                3.3277413845062256,
                3.290374279022217,
                3.205317258834839
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}