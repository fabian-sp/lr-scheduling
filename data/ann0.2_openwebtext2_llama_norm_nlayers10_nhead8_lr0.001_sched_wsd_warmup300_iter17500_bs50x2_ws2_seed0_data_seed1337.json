{
    "summary": {
        "final-val/perplexity": 25.96201294236125,
        "iter": 17500,
        "_step": 89,
        "_wandb": {
            "runtime": 994
        },
        "final-val/acc": 0.40271031856536865,
        "val/perplexity": 25.915847015682843,
        "train/perplexity": 27.405317168600902,
        "lr": 0,
        "_runtime": 994.5111691951752,
        "parameters": 59845120,
        "val/acc": 0.4031689465045929,
        "val/loss": 3.254856824874878,
        "train/loss": 3.310739278793335,
        "iter_dt": 0.204440068,
        "_timestamp": 1715583099.9148972,
        "final-val/loss": 3.256636619567871,
        "optimized_parameters": 59845120
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 512,
        "n_head": 8,
        "compile": true,
        "dataset": "openwebtext2",
        "dropout": 0,
        "n_layer": 10,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 17500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/openwebtext2_llama_norm_nlayers10_nhead8_lr0.001_sched_wsd_warmup300_iter17500_bs50x2_ws2_seed0_data_seed1337/ckpts/14000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            7500,
            12500,
            17500
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-openwebtext",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_openwebtext2_llama_norm_nlayers10_nhead8_lr0.001_sched_wsd_warmup300_iter17500_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                17500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.256636619567871
            ],
            "final_val_perplexity": [
                25.96201294236125
            ]
        },
        "val": {
            "iter": [
                14000,
                14200,
                14400,
                14600,
                14800,
                15000,
                15200,
                15400,
                15600,
                15800,
                16000,
                16200,
                16400,
                16600,
                16800,
                17000,
                17200,
                17400
            ],
            "val_perplexity": [
                30.63372664503422,
                30.359526145241063,
                30.03628981805595,
                29.775486141956886,
                29.479187470534878,
                29.141295544115515,
                28.836082377385473,
                28.52340069586524,
                28.252289564070708,
                27.95804050428158,
                27.667641033113814,
                27.36103984600968,
                27.10259219072262,
                26.808995094679805,
                26.545298245052194,
                26.304331297557795,
                26.072040499195467,
                25.915847015682843
            ],
            "val_loss": [
                3.4221038818359375,
                3.4131126403808594,
                3.4024085998535156,
                3.3936877250671387,
                3.3836867809295654,
                3.3721585273742676,
                3.3616297245025635,
                3.350727081298828,
                3.341176748275757,
                3.33070707321167,
                3.320265769958496,
                3.309122323989868,
                3.2996315956115723,
                3.2887396812438965,
                3.2788548469543457,
                3.269735813140869,
                3.2608656883239746,
                3.254856824874878
            ],
            "val_acc": [
                0.3836095929145813,
                0.3843725323677063,
                0.38612058758735657,
                0.38649657368659973,
                0.3878539800643921,
                0.3893713355064392,
                0.39070311188697815,
                0.39171749353408813,
                0.3930627107620239,
                0.39435791969299316,
                0.3952404856681824,
                0.39683961868286133,
                0.39777952432632446,
                0.39894041419029236,
                0.40043944120407104,
                0.40092405676841736,
                0.4025366008281708,
                0.4031689465045929
            ]
        },
        "train": {
            "iter": [
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000,
                15050,
                15100,
                15150,
                15200,
                15250,
                15300,
                15350,
                15400,
                15450,
                15500,
                15550,
                15600,
                15650,
                15700,
                15750,
                15800,
                15850,
                15900,
                15950,
                16000,
                16050,
                16100,
                16150,
                16200,
                16250,
                16300,
                16350,
                16400,
                16450,
                16500,
                16550,
                16600,
                16650,
                16700,
                16750,
                16800,
                16850,
                16900,
                16950,
                17000,
                17050,
                17100,
                17150,
                17200,
                17250,
                17300,
                17350,
                17400,
                17450,
                17500
            ],
            "train_perplexity": [
                28.16733681828617,
                29.345061676744173,
                30.63463961422175,
                26.791896204879553,
                39.82888453533913,
                27.80465152631205,
                27.017308685249386,
                26.263642359035956,
                27.727456470986443,
                24.32504853182639,
                28.771933963695957,
                25.435957525608607,
                28.837539925491335,
                30.396710177266254,
                32.253172460269084,
                27.61085097258646,
                32.38745280306758,
                29.143060344238847,
                26.388628769220833,
                29.392066136794412,
                28.80312159946464,
                29.944980304896475,
                26.618294559246593,
                29.126604605725,
                31.061546828496887,
                23.03747938675322,
                27.63148301403051,
                29.246208457997533,
                28.043919850259012,
                29.67883395561452,
                26.288231176373547,
                24.7853676139469,
                31.03692541706171,
                29.321255581780857,
                28.084487516038152,
                24.01487127682952,
                23.444254157458776,
                23.093312892175973,
                26.132144327522987,
                34.520793199057415,
                26.59276298760503,
                25.839392134775352,
                24.69245907825594,
                21.19579010173736,
                27.316254423660347,
                25.196997443544955,
                24.626511284685794,
                27.337083456941485,
                26.772248516603785,
                25.312182022231344,
                23.744338154505744,
                27.835168939462584,
                29.503677489458422,
                25.43416252631902,
                26.463314115408917,
                32.08672814327269,
                30.056476873674626,
                27.093618296002333,
                25.710422825253126,
                24.27748666986568,
                28.10206294743702,
                29.523400998239733,
                25.847359001713965,
                23.473209082158213,
                25.335433057537028,
                23.803513524404323,
                23.435971919501096,
                24.361955774700103,
                26.679027942256006,
                27.405317168600906
            ],
            "train_lr": [
                0.0009857142857142857,
                0.0009714285714285714,
                0.0009571428571428573,
                0.0009428571428571429,
                0.0009285714285714287,
                0.0009142857142857143,
                0.0009000000000000001,
                0.0008857142857142857,
                0.0008714285714285715,
                0.0008571428571428572,
                0.0008428571428571429,
                0.0008285714285714285,
                0.0008142857142857143,
                0.0008,
                0.0007857142857142857,
                0.0007714285714285715,
                0.0007571428571428572,
                0.0007428571428571429,
                0.0007285714285714287,
                0.0007142857142857143,
                0.0007,
                0.0006857142857142857,
                0.0006714285714285715,
                0.0006571428571428571,
                0.0006428571428571428,
                0.0006285714285714285,
                0.0006142857142857143,
                0.0006,
                0.0005857142857142857,
                0.0005714285714285714,
                0.0005571428571428572,
                0.0005428571428571429,
                0.0005285714285714286,
                0.0005142857142857142,
                0.0005,
                0.00048571428571428577,
                0.0004714285714285714,
                0.0004571428571428572,
                0.00044285714285714284,
                0.0004285714285714286,
                0.00041428571428571426,
                0.0004,
                0.00038571428571428567,
                0.00037142857142857143,
                0.0003571428571428571,
                0.00034285714285714285,
                0.0003285714285714286,
                0.00031428571428571427,
                0.00030000000000000003,
                0.0002857142857142857,
                0.00027142857142857144,
                0.0002571428571428571,
                0.00024285714285714289,
                0.00022857142857142854,
                0.0002142857142857143,
                0.00019999999999999996,
                0.00018571428571428572,
                0.00017142857142857137,
                0.00015714285714285713,
                0.0001428571428571429,
                0.00012857142857142855,
                0.00011428571428571432,
                9.999999999999998e-05,
                8.571428571428574e-05,
                7.14285714285714e-05,
                5.714285714285716e-05,
                4.2857142857142816e-05,
                2.857142857142858e-05,
                1.4285714285714235e-05,
                0
            ],
            "train_loss": [
                3.338165283203125,
                3.37912654876709,
                3.422133684158325,
                3.2881016731262207,
                3.6845948696136475,
                3.3252055644989014,
                3.2964799404144287,
                3.2681877613067627,
                3.322425365447998,
                3.1915087699890137,
                3.359402656555176,
                3.236166000366211,
                3.361680269241333,
                3.414336681365967,
                3.473618745803833,
                3.318211078643799,
                3.477773427963257,
                3.3722190856933594,
                3.272935390472412,
                3.3807270526885986,
                3.3604860305786133,
                3.3993639945983887,
                3.2816009521484375,
                3.3716542720794678,
                3.4359729290008545,
                3.137124538421631,
                3.318958044052124,
                3.3757522106170654,
                3.3337740898132324,
                3.3904364109039307,
                3.2691235542297363,
                3.2102556228637695,
                3.4351799488067627,
                3.378314971923828,
                3.335219621658325,
                3.178675413131714,
                3.154627561569214,
                3.139545202255249,
                3.2631683349609375,
                3.5415642261505127,
                3.2806413173675537,
                3.2519023418426514,
                3.2065000534057617,
                3.053804636001587,
                3.3074841499328613,
                3.22672700881958,
                3.2038257122039795,
                3.308246374130249,
                3.287368059158325,
                3.231287956237793,
                3.167346239089966,
                3.3263025283813477,
                3.384517192840576,
                3.236095428466797,
                3.275761604309082,
                3.46844482421875,
                3.403080463409424,
                3.2993004322052,
                3.246898651123047,
                3.189551591873169,
                3.3358452320098877,
                3.385185480117798,
                3.2522106170654297,
                3.1558618545532227,
                3.232206106185913,
                3.169835329055786,
                3.1542742252349854,
                3.1930248737335205,
                3.2838799953460693,
                3.310739278793335
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}