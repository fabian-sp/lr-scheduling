{
    "summary": {
        "_wandb": {
            "runtime": 438
        },
        "parameters": 59845120,
        "final-val/perplexity": 29.386509627408245,
        "final-val/loss": 3.380537986755371,
        "val/perplexity": 29.399305889342727,
        "train/perplexity": 27.109739836499276,
        "lr": 0,
        "_step": 39,
        "val/acc": 0.3891662359237671,
        "_runtime": 438.66188287734985,
        "_timestamp": 1715582534.866323,
        "iter_dt": 0.209196788,
        "train/loss": 3.2998952865600586,
        "final-val/acc": 0.3891184329986572,
        "iter": 7500,
        "val/loss": 3.3809733390808105,
        "optimized_parameters": 59845120
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 512,
        "n_head": 8,
        "compile": true,
        "dataset": "openwebtext2",
        "dropout": 0,
        "n_layer": 10,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 7500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/openwebtext2_llama_norm_nlayers10_nhead8_lr0.001_sched_wsd_warmup300_iter17500_bs50x2_ws2_seed0_data_seed1337/ckpts/6000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            7500,
            12500,
            17500
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-openwebtext",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_openwebtext2_llama_norm_nlayers10_nhead8_lr0.001_sched_wsd_warmup300_iter7500_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                7500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.380537986755371
            ],
            "final_val_perplexity": [
                29.386509627408245
            ]
        },
        "val": {
            "iter": [
                6000,
                6200,
                6400,
                6600,
                6800,
                7000,
                7200,
                7400
            ],
            "val_perplexity": [
                34.67940222364292,
                33.900722337229894,
                33.001136793282306,
                32.148117381319004,
                31.4176363483683,
                30.63930713779202,
                29.94087541123349,
                29.399305889342727
            ],
            "val_loss": [
                3.5461483001708984,
                3.5234386920928955,
                3.496544361114502,
                3.4703562259674072,
                3.4473717212677,
                3.422286033630371,
                3.3992269039154053,
                3.3809733390808105
            ],
            "val_acc": [
                0.3702636659145355,
                0.37270382046699524,
                0.37565550208091736,
                0.37870725989341736,
                0.38118284940719604,
                0.38454100489616394,
                0.38709473609924316,
                0.3891662359237671
            ]
        },
        "train": {
            "iter": [
                6050,
                6100,
                6150,
                6200,
                6250,
                6300,
                6350,
                6400,
                6450,
                6500,
                6550,
                6600,
                6650,
                6700,
                6750,
                6800,
                6850,
                6900,
                6950,
                7000,
                7050,
                7100,
                7150,
                7200,
                7250,
                7300,
                7350,
                7400,
                7450,
                7500
            ],
            "train_perplexity": [
                41.64505341125918,
                37.224952844276935,
                37.19842570857495,
                30.08453775765541,
                30.592131439151,
                29.87300149616798,
                34.1600193812302,
                37.03685126915771,
                29.67340009996575,
                30.61210088643602,
                31.759781325773375,
                32.757906816658036,
                30.7428837386729,
                37.694372859809874,
                33.025450240869574,
                30.04770694772387,
                28.70189204051301,
                30.994028995255295,
                31.234526389354624,
                32.158995435322204,
                27.387191502967116,
                28.930831556442456,
                29.098819757600577,
                28.289644407890254,
                27.416865059431398,
                28.497359859106556,
                32.96083751491867,
                36.0714911790793,
                33.29112260575693,
                27.109739836499276
            ],
            "train_lr": [
                0.0009666666666666667,
                0.0009333333333333333,
                0.0009000000000000001,
                0.0008666666666666667,
                0.0008333333333333334,
                0.0008,
                0.0007666666666666666,
                0.0007333333333333334,
                0.0007,
                0.0006666666666666668,
                0.0006333333333333333,
                0.0006,
                0.0005666666666666667,
                0.0005333333333333334,
                0.0005,
                0.00046666666666666666,
                0.00043333333333333337,
                0.0004,
                0.0003666666666666667,
                0.0003333333333333334,
                0.00030000000000000003,
                0.00026666666666666673,
                0.00023333333333333328,
                0.00019999999999999996,
                0.00016666666666666663,
                0.0001333333333333333,
                9.999999999999998e-05,
                6.666666666666666e-05,
                3.333333333333333e-05,
                0
            ],
            "train_loss": [
                3.729185104370117,
                3.6169817447662354,
                3.6162688732147217,
                3.4040136337280273,
                3.4207451343536377,
                3.3969573974609375,
                3.5310583114624023,
                3.6119158267974854,
                3.3902533054351807,
                3.4213976860046387,
                3.458203077316284,
                3.4891467094421387,
                3.4256608486175537,
                3.6295132637023926,
                3.4972808361053467,
                3.4027886390686035,
                3.3569653034210205,
                3.4337968826293945,
                3.441526412963867,
                3.4706945419311523,
                3.310077667236328,
                3.364910125732422,
                3.370699882507324,
                3.3424980640411377,
                3.3111605644226074,
                3.34981369972229,
                3.4953224658966064,
                3.585505247116089,
                3.505293130874634,
                3.2998952865600586
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}