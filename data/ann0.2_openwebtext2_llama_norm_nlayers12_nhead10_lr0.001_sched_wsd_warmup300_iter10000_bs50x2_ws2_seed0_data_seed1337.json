{
    "summary": {
        "final-val/loss": 3.2396748065948486,
        "val/perplexity": 25.682724756463756,
        "optimized_parameters": 93159040,
        "iter_dt": 0.275930676,
        "val/acc": 0.404365211725235,
        "val/loss": 3.2458207607269287,
        "_timestamp": 1715582696.035329,
        "final-val/perplexity": 25.525364075066076,
        "lr": 0,
        "_wandb": {
            "runtime": 735
        },
        "_runtime": 735.0750961303711,
        "parameters": 93159040,
        "train/loss": 3.1321706771850586,
        "iter": 10000,
        "_step": 51,
        "final-val/acc": 0.40418559312820435,
        "train/perplexity": 22.92363719922116
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 640,
        "n_head": 10,
        "compile": true,
        "dataset": "openwebtext2",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 10000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/openwebtext2_llama_norm_nlayers12_nhead10_lr0.001_sched_wsd_warmup300_iter25000_bs50x2_ws2_seed0_data_seed1337/ckpts/8000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            10000,
            17500,
            25000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-openwebtext",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_openwebtext2_llama_norm_nlayers12_nhead10_lr0.001_sched_wsd_warmup300_iter10000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                10000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.2396748065948486
            ],
            "final_val_perplexity": [
                25.525364075066076
            ]
        },
        "val": {
            "iter": [
                8000,
                8200,
                8400,
                8600,
                8800,
                9000,
                9200,
                9400,
                9600,
                9800
            ],
            "val_perplexity": [
                30.168554019193465,
                29.718606364576136,
                29.212458507800548,
                28.623529842503526,
                28.06686285158687,
                27.564559122505205,
                27.03319146215444,
                26.519684942378642,
                26.0616866085623,
                25.682724756463756
            ],
            "val_loss": [
                3.4068024158477783,
                3.391775608062744,
                3.3745975494384766,
                3.354231357574463,
                3.334591865539551,
                3.316533088684082,
                3.297067642211914,
                3.2778894901275635,
                3.2604684829711914,
                3.2458207607269287
            ],
            "val_acc": [
                0.3853686451911926,
                0.3867468237876892,
                0.38863280415534973,
                0.3906957805156708,
                0.39326417446136475,
                0.39542722702026367,
                0.3980053663253784,
                0.40044188499450684,
                0.4023840129375458,
                0.404365211725235
            ]
        },
        "train": {
            "iter": [
                8050,
                8100,
                8150,
                8200,
                8250,
                8300,
                8350,
                8400,
                8450,
                8500,
                8550,
                8600,
                8650,
                8700,
                8750,
                8800,
                8850,
                8900,
                8950,
                9000,
                9050,
                9100,
                9150,
                9200,
                9250,
                9300,
                9350,
                9400,
                9450,
                9500,
                9550,
                9600,
                9650,
                9700,
                9750,
                9800,
                9850,
                9900,
                9950,
                10000
            ],
            "train_perplexity": [
                32.571419291964,
                30.085692585794696,
                27.40378827107195,
                27.631278791296108,
                33.828670279827534,
                28.83804870962906,
                34.27611886925371,
                30.64626226343078,
                26.527513701008083,
                29.669799303726197,
                26.272955211325627,
                32.88070010535492,
                29.90454844782274,
                29.17188199958874,
                24.630580510661712,
                28.265724074452738,
                31.049381736781452,
                29.24894193696259,
                27.955940883905754,
                24.682806060815135,
                27.364810617064972,
                30.366330881732488,
                25.832456244841122,
                27.90368121323859,
                25.82235756856591,
                24.789362614669272,
                27.853438351822792,
                23.705280503647753,
                24.34811262911067,
                30.302267584938694,
                26.360112076639375,
                26.863079107724257,
                24.0619989661264,
                26.76670864832124,
                25.858891585924745,
                25.96884740535303,
                26.63023461107849,
                25.183964695815547,
                25.17981605172482,
                22.92363719922116
            ],
            "train_lr": [
                0.000975,
                0.00095,
                0.000925,
                0.0009000000000000001,
                0.000875,
                0.00085,
                0.000825,
                0.0008,
                0.0007750000000000001,
                0.00075,
                0.000725,
                0.0007,
                0.000675,
                0.0006500000000000001,
                0.000625,
                0.0006,
                0.000575,
                0.00055,
                0.0005250000000000001,
                0.0005,
                0.000475,
                0.00045,
                0.00042500000000000003,
                0.0004,
                0.000375,
                0.00035,
                0.000325,
                0.00030000000000000003,
                0.000275,
                0.00025,
                0.000225,
                0.00019999999999999996,
                0.00017500000000000005,
                0.00015000000000000001,
                0.000125,
                9.999999999999998e-05,
                7.499999999999995e-05,
                5.000000000000004e-05,
                2.500000000000002e-05,
                0
            ],
            "train_loss": [
                3.4834375381469727,
                3.4040520191192627,
                3.310683488845825,
                3.318950653076172,
                3.521311044692993,
                3.3616979122161865,
                3.5344512462615967,
                3.422513008117676,
                3.278184652328491,
                3.390131950378418,
                3.2685422897338867,
                3.4928882122039795,
                3.39801287651062,
                3.3732075691223145,
                3.203990936279297,
                3.3416521549224854,
                3.4355812072753906,
                3.3758456707000732,
                3.330631971359253,
                3.206109046936035,
                3.309260129928589,
                3.413336753845215,
                3.251633882522583,
                3.328760862350464,
                3.2512428760528564,
                3.210416793823242,
                3.326958656311035,
                3.1656999588012695,
                3.1924564838409424,
                3.411224842071533,
                3.2718541622161865,
                3.290755033493042,
                3.180635929107666,
                3.287161111831665,
                3.2526566982269287,
                3.256899833679199,
                3.2820494174957275,
                3.2262096405029297,
                3.2260448932647705,
                3.1321706771850586
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}