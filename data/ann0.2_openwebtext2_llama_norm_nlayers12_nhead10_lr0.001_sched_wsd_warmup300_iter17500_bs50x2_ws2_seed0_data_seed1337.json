{
    "summary": {
        "_runtime": 1146.1635835170746,
        "val/loss": 3.156407594680786,
        "final-val/loss": 3.1570770740509033,
        "final-val/perplexity": 23.501751503449743,
        "iter": 17500,
        "_wandb": {
            "runtime": 1146
        },
        "parameters": 93159040,
        "val/perplexity": 23.486022841831208,
        "_step": 89,
        "iter_dt": 0.263384156,
        "train/loss": 3.2083511352539062,
        "final-val/acc": 0.4136994779109955,
        "train/perplexity": 24.738209140759395,
        "optimized_parameters": 93159040,
        "val/acc": 0.4149719178676605,
        "_timestamp": 1715583107.0846226,
        "lr": 0
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 640,
        "n_head": 10,
        "compile": true,
        "dataset": "openwebtext2",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 17500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/openwebtext2_llama_norm_nlayers12_nhead10_lr0.001_sched_wsd_warmup300_iter25000_bs50x2_ws2_seed0_data_seed1337/ckpts/14000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            10000,
            17500,
            25000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-openwebtext",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_openwebtext2_llama_norm_nlayers12_nhead10_lr0.001_sched_wsd_warmup300_iter17500_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                17500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1570770740509033
            ],
            "final_val_perplexity": [
                23.501751503449746
            ]
        },
        "val": {
            "iter": [
                14000,
                14200,
                14400,
                14600,
                14800,
                15000,
                15200,
                15400,
                15600,
                15800,
                16000,
                16200,
                16400,
                16600,
                16800,
                17000,
                17200,
                17400
            ],
            "val_perplexity": [
                27.92716865299306,
                27.669263813607508,
                27.409205134134293,
                27.124377062971988,
                26.86391813034915,
                26.569910035343824,
                26.2620268808131,
                25.962062460985056,
                25.68660105647746,
                25.41874045698374,
                25.13995549475651,
                24.84339965320739,
                24.605764580606156,
                24.34309178854436,
                24.070353231453367,
                23.843221903458378,
                23.635995106744087,
                23.486022841831208
            ],
            "val_loss": [
                3.3296022415161133,
                3.320324420928955,
                3.3108811378479004,
                3.3004350662231445,
                3.2907862663269043,
                3.2797815799713135,
                3.2681262493133545,
                3.256638526916504,
                3.2459716796875,
                3.2354888916015625,
                3.2244606018066406,
                3.2125942707061768,
                3.2029829025268555,
                3.1922502517700195,
                3.180983066558838,
                3.171502113342285,
                3.1627728939056396,
                3.156407594680786
            ],
            "val_acc": [
                0.3930627107620239,
                0.39411377906799316,
                0.39577147364616394,
                0.39660030603408813,
                0.39763426780700684,
                0.3991039991378784,
                0.40071046352386475,
                0.40162110328674316,
                0.40321165323257446,
                0.4049694538116455,
                0.4061364531517029,
                0.4074450731277466,
                0.40882566571235657,
                0.40999510884284973,
                0.41161131858825684,
                0.41276121139526367,
                0.4138452112674713,
                0.4149719178676605
            ]
        },
        "train": {
            "iter": [
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000,
                15050,
                15100,
                15150,
                15200,
                15250,
                15300,
                15350,
                15400,
                15450,
                15500,
                15550,
                15600,
                15650,
                15700,
                15750,
                15800,
                15850,
                15900,
                15950,
                16000,
                16050,
                16100,
                16150,
                16200,
                16250,
                16300,
                16350,
                16400,
                16450,
                16500,
                16550,
                16600,
                16650,
                16700,
                16750,
                16800,
                16850,
                16900,
                16950,
                17000,
                17050,
                17100,
                17150,
                17200,
                17250,
                17300,
                17350,
                17400,
                17450,
                17500
            ],
            "train_perplexity": [
                25.55645666743136,
                26.56789565931905,
                28.225742523807654,
                24.347996528617234,
                36.10329979446216,
                25.479689083555883,
                24.950280678999192,
                24.12615893826527,
                25.099368118038875,
                22.256519246497547,
                26.1356211133562,
                23.30892657421861,
                26.050454865828552,
                27.81429196828215,
                29.45590461435277,
                24.97428890094633,
                29.548892897108505,
                26.190919238564526,
                24.046182007091694,
                26.72243095043705,
                26.537097273237876,
                27.477107875883974,
                24.13828170116998,
                26.39983637264738,
                28.311566662676004,
                21.046849475000435,
                25.160702697439806,
                26.496623146442403,
                25.404181736807317,
                26.951750243364625,
                23.991396397344893,
                22.30327490612134,
                28.1283595371625,
                26.80208010425173,
                25.444491568807447,
                21.994800271158393,
                21.47326737154497,
                20.763320067575368,
                23.76844397127018,
                31.328445951324294,
                24.07594922701181,
                23.376968968239144,
                22.51176992214467,
                19.307635378105854,
                24.96494235150549,
                22.89574229880548,
                22.502341690458692,
                24.465820556633872,
                24.046067346311254,
                22.949443017909655,
                21.726335481396923,
                25.05946762261065,
                26.54541216528122,
                22.96751177949768,
                24.152114954784206,
                28.979680472769598,
                27.067262963730435,
                24.366236896639478,
                23.217788034624913,
                21.91890450517506,
                25.369409097826964,
                26.667326689208785,
                23.37481769624015,
                21.416759785659302,
                23.006335674818484,
                21.514971303982005,
                21.31045403864797,
                21.918716374642543,
                24.110978117804464,
                24.738209140759395
            ],
            "train_lr": [
                0.0009857142857142857,
                0.0009714285714285714,
                0.0009571428571428573,
                0.0009428571428571429,
                0.0009285714285714287,
                0.0009142857142857143,
                0.0009000000000000001,
                0.0008857142857142857,
                0.0008714285714285715,
                0.0008571428571428572,
                0.0008428571428571429,
                0.0008285714285714285,
                0.0008142857142857143,
                0.0008,
                0.0007857142857142857,
                0.0007714285714285715,
                0.0007571428571428572,
                0.0007428571428571429,
                0.0007285714285714287,
                0.0007142857142857143,
                0.0007,
                0.0006857142857142857,
                0.0006714285714285715,
                0.0006571428571428571,
                0.0006428571428571428,
                0.0006285714285714285,
                0.0006142857142857143,
                0.0006,
                0.0005857142857142857,
                0.0005714285714285714,
                0.0005571428571428572,
                0.0005428571428571429,
                0.0005285714285714286,
                0.0005142857142857142,
                0.0005,
                0.00048571428571428577,
                0.0004714285714285714,
                0.0004571428571428572,
                0.00044285714285714284,
                0.0004285714285714286,
                0.00041428571428571426,
                0.0004,
                0.00038571428571428567,
                0.00037142857142857143,
                0.0003571428571428571,
                0.00034285714285714285,
                0.0003285714285714286,
                0.00031428571428571427,
                0.00030000000000000003,
                0.0002857142857142857,
                0.00027142857142857144,
                0.0002571428571428571,
                0.00024285714285714289,
                0.00022857142857142854,
                0.0002142857142857143,
                0.00019999999999999996,
                0.00018571428571428572,
                0.00017142857142857137,
                0.00015714285714285713,
                0.0001428571428571429,
                0.00012857142857142855,
                0.00011428571428571432,
                9.999999999999998e-05,
                8.571428571428574e-05,
                7.14285714285714e-05,
                5.714285714285716e-05,
                4.2857142857142816e-05,
                2.857142857142858e-05,
                1.4285714285714235e-05,
                0
            ],
            "train_loss": [
                3.240892171859741,
                3.279705762863159,
                3.3402366638183594,
                3.1924517154693604,
                3.5863866806030273,
                3.2378838062286377,
                3.2168872356414795,
                3.1832988262176514,
                3.2228448390960693,
                3.1026370525360107,
                3.263301372528076,
                3.148838520050049,
                3.260037422180176,
                3.325552225112915,
                3.382896661758423,
                3.217849016189575,
                3.3860485553741455,
                3.2654149532318115,
                3.179978370666504,
                3.285505533218384,
                3.27854585647583,
                3.3133554458618164,
                3.1838011741638184,
                3.273360013961792,
                3.3432726860046387,
                3.0467529296875,
                3.225285530090332,
                3.277019500732422,
                3.2349159717559814,
                3.294050455093384,
                3.1776974201202393,
                3.1047356128692627,
                3.336780548095703,
                3.2884817123413086,
                3.236501455307007,
                3.090808153152466,
                3.0668108463287354,
                3.0331900119781494,
                3.168360948562622,
                3.444528818130493,
                3.181215524673462,
                3.1517534255981445,
                3.1140403747558594,
                2.9605026245117188,
                3.2174746990203857,
                3.130953073501587,
                3.113621473312378,
                3.197279214859009,
                3.179973602294922,
                3.133295774459839,
                3.0785272121429443,
                3.2212538719177246,
                3.2788591384887695,
                3.134082794189453,
                3.1843740940093994,
                3.3665971755981445,
                3.2983272075653076,
                3.1932005882263184,
                3.144920825958252,
                3.0873515605926514,
                3.233546257019043,
                3.2834413051605225,
                3.1516613960266113,
                3.064175844192505,
                3.1357717514038086,
                3.068751096725464,
                3.059199810028076,
                3.0873429775238037,
                3.1826694011688232,
                3.2083511352539062
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}