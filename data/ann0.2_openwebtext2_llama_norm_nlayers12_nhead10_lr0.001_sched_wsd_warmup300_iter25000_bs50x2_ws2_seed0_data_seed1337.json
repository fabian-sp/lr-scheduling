{
    "summary": {
        "_runtime": 1424.4315333366394,
        "val/loss": 3.1118898391723633,
        "_step": 126,
        "_wandb": {
            "runtime": 1424
        },
        "iter_dt": 0.254962757,
        "_timestamp": 1715583379.9173312,
        "parameters": 93159040,
        "train/perplexity": 19.12479825439121,
        "lr": 0,
        "iter": 25000,
        "optimized_parameters": 93159040,
        "final-val/acc": 0.41868528723716736,
        "final-val/loss": 3.1131904125213623,
        "val/perplexity": 22.463409611332015,
        "final-val/perplexity": 22.492643910089747,
        "val/acc": 0.4198828339576721,
        "train/loss": 2.9509878158569336
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 640,
        "n_head": 10,
        "compile": true,
        "dataset": "openwebtext2",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/openwebtext2_llama_norm_nlayers12_nhead10_lr0.001_sched_wsd_warmup300_iter25000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            10000,
            17500,
            25000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-openwebtext",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_openwebtext2_llama_norm_nlayers12_nhead10_lr0.001_sched_wsd_warmup300_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1131904125213623
            ],
            "final_val_perplexity": [
                22.492643910089747
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                26.748858672366985,
                26.69271983505144,
                26.483581167831876,
                26.27978381109818,
                26.09572198392624,
                25.91785520844652,
                25.69376119588107,
                25.521159191041153,
                25.351753523833086,
                25.149619403143664,
                24.930741213178386,
                24.73969549267582,
                24.557800220365323,
                24.34788623366125,
                24.1518788652668,
                23.975448645833684,
                23.80102791831716,
                23.6057024901841,
                23.407810750372388,
                23.22643617130898,
                23.043818672347985,
                22.878580912444463,
                22.718248800359174,
                22.576656341915214,
                22.463409611332015
            ],
            "val_loss": [
                3.286494016647339,
                3.284393072128296,
                3.276527166366577,
                3.2688021659851074,
                3.2617735862731934,
                3.254934310913086,
                3.2462503910064697,
                3.2395100593566895,
                3.2328500747680664,
                3.2248449325561523,
                3.2161037921905518,
                3.20841121673584,
                3.2010316848754883,
                3.1924471855163574,
                3.1843643188476562,
                3.177032470703125,
                3.1697309017181396,
                3.1614904403686523,
                3.153071880340576,
                3.1452932357788086,
                3.137399673461914,
                3.1302032470703125,
                3.1231706142425537,
                3.1169185638427734,
                3.1118898391723633
            ],
            "val_acc": [
                0.39815181493759155,
                0.3984973132610321,
                0.3991760015487671,
                0.4002624452114105,
                0.40074095129966736,
                0.4016955494880676,
                0.40241456031799316,
                0.40349364280700684,
                0.4045702815055847,
                0.4048705995082855,
                0.40641355514526367,
                0.407073974609375,
                0.40800535678863525,
                0.40937376022338867,
                0.41020143032073975,
                0.4114331007003784,
                0.4124084413051605,
                0.41377687454223633,
                0.4142785668373108,
                0.41524168848991394,
                0.4164038300514221,
                0.4172655940055847,
                0.4182421565055847,
                0.41898801922798157,
                0.4198828339576721
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                31.338934573781362,
                22.56423650920983,
                31.093496389433692,
                23.44800504016657,
                23.53143944994877,
                28.108220967452226,
                23.80933698778732,
                30.6653604448205,
                25.24796788977984,
                27.56359964200918,
                25.66175512002911,
                24.40959582390517,
                25.79557211422106,
                22.54727522009208,
                23.210216639334014,
                23.362733012221277,
                20.790242702431996,
                28.26773912797773,
                23.703432445102344,
                26.340617752050523,
                24.420026949524583,
                23.674368508734304,
                27.542998587846892,
                26.589846653458224,
                25.08200213621651,
                22.005122816782432,
                25.873821930947503,
                25.73846372641321,
                26.50634722886741,
                23.133242915699082,
                23.51084733861623,
                25.771782051289996,
                23.444891373906923,
                25.979697094290614,
                22.670644827077414,
                24.46503893341811,
                20.407853504217254,
                24.542031828992357,
                21.466218808521585,
                25.045675978534284,
                25.133177388698822,
                23.96408755564113,
                25.39947601979069,
                23.439442055719738,
                22.185929431130937,
                22.12377998411825,
                23.87904511236472,
                22.575149238823272,
                26.46124473231026,
                28.034153032147792,
                23.73254337848024,
                23.55065144313955,
                23.804262662071622,
                26.083729301393394,
                21.078139598711797,
                25.31774680279908,
                24.791762288507236,
                23.639235601392272,
                23.53052498415876,
                26.688246292616583,
                24.26203130934195,
                22.37096831711844,
                22.446454541153223,
                21.181130013371472,
                23.351400596153717,
                23.994039178638463,
                24.19757923429504,
                23.85651066330281,
                19.84263056890772,
                22.161431265245866,
                23.60864050688896,
                24.666675114948575,
                21.485926808427287,
                20.012471693061126,
                27.687714789303374,
                22.313268748691385,
                23.846115572636585,
                21.195512162887884,
                24.821120932742822,
                26.197876421301547,
                21.10285399952268,
                21.648738744650473,
                21.061818342025507,
                22.736704718079523,
                23.919632259609457,
                17.071171042830727,
                23.58738472150492,
                20.761146974166696,
                23.749235500219342,
                22.858276717510577,
                23.040291748818895,
                23.11430530264181,
                22.970813971201828,
                22.49544875644893,
                24.551460039397206,
                21.966569162339592,
                22.83433724091433,
                20.01678545095483,
                23.113660539128606,
                19.12479825439121
            ],
            "train_lr": [
                0.00099,
                0.00098,
                0.0009699999999999999,
                0.00096,
                0.00095,
                0.00094,
                0.0009299999999999999,
                0.00092,
                0.00091,
                0.0009000000000000001,
                0.0008900000000000001,
                0.00088,
                0.00087,
                0.00086,
                0.00085,
                0.00084,
                0.00083,
                0.0008200000000000001,
                0.0008100000000000001,
                0.0008,
                0.00079,
                0.0007800000000000001,
                0.0007700000000000001,
                0.00076,
                0.00075,
                0.00074,
                0.00073,
                0.0007199999999999999,
                0.00071,
                0.0007,
                0.00069,
                0.0006799999999999999,
                0.0006699999999999999,
                0.0006599999999999999,
                0.0006500000000000001,
                0.00064,
                0.00063,
                0.00062,
                0.00061,
                0.0006,
                0.0005900000000000001,
                0.0005800000000000001,
                0.0005700000000000001,
                0.0005600000000000001,
                0.00055,
                0.00054,
                0.0005300000000000001,
                0.0005200000000000001,
                0.00051,
                0.0005,
                0.00049,
                0.00048,
                0.00047,
                0.00045999999999999996,
                0.00045,
                0.00043999999999999996,
                0.00043000000000000004,
                0.00042000000000000007,
                0.00041000000000000005,
                0.0004,
                0.00039000000000000005,
                0.00038,
                0.00037,
                0.00035999999999999997,
                0.00035,
                0.00033999999999999997,
                0.00032999999999999994,
                0.00031999999999999997,
                0.00031000000000000005,
                0.00030000000000000003,
                0.00029000000000000006,
                0.00028000000000000003,
                0.00027,
                0.00026000000000000003,
                0.00025,
                0.00024,
                0.00022999999999999998,
                0.00021999999999999998,
                0.00020999999999999998,
                0.00019999999999999996,
                0.00018999999999999996,
                0.00018000000000000007,
                0.00017000000000000004,
                0.00016000000000000004,
                0.00015000000000000001,
                0.00014000000000000001,
                0.00013000000000000002,
                0.00012,
                0.00010999999999999999,
                9.999999999999998e-05,
                8.999999999999997e-05,
                7.999999999999997e-05,
                6.999999999999995e-05,
                6.0000000000000056e-05,
                5.000000000000004e-05,
                4.000000000000004e-05,
                3.0000000000000028e-05,
                2.000000000000002e-05,
                1.000000000000001e-05,
                0
            ],
            "train_loss": [
                3.4448635578155518,
                3.116368293762207,
                3.4370009899139404,
                3.154787540435791,
                3.158339500427246,
                3.336064338684082,
                3.1700799465179443,
                3.423135995864868,
                3.228747844696045,
                3.316498279571533,
                3.2450039386749268,
                3.1949784755706787,
                3.2502050399780273,
                3.1156163215637207,
                3.144594669342041,
                3.15114426612854,
                3.0344858169555664,
                3.3417234420776367,
                3.1656219959259033,
                3.2711143493652344,
                3.1954057216644287,
                3.1643950939178467,
                3.3157505989074707,
                3.280531644821167,
                3.2221527099609375,
                3.0912773609161377,
                3.2532339096069336,
                3.247988700866699,
                3.277386426925659,
                3.141272783279419,
                3.157464027404785,
                3.2492823600769043,
                3.1546547412872314,
                3.257317543029785,
                3.121073007583618,
                3.197247266769409,
                3.0159218311309814,
                3.2003893852233887,
                3.0664825439453125,
                3.220703363418579,
                3.2241909503936768,
                3.176558494567871,
                3.2347307205200195,
                3.1544222831726074,
                3.0994603633880615,
                3.0966551303863525,
                3.1730034351348877,
                3.116851806640625,
                3.2756834030151367,
                3.333425760269165,
                3.166849374771118,
                3.1591556072235107,
                3.1698668003082275,
                3.2613139152526855,
                3.048238515853882,
                3.2315077781677246,
                3.2105135917663574,
                3.162909984588623,
                3.1583006381988525,
                3.2842254638671875,
                3.1889147758483887,
                3.1077661514282227,
                3.1111347675323486,
                3.053112745285034,
                3.1506590843200684,
                3.177807569503784,
                3.1862547397613525,
                3.1720592975616455,
                2.9878346920013428,
                3.098355531692505,
                3.1616148948669434,
                3.2054553031921387,
                3.0674002170562744,
                2.9963576793670654,
                3.320991039276123,
                3.1051836013793945,
                3.171623468399048,
                3.0537915229797363,
                3.2116971015930176,
                3.2656805515289307,
                3.049410343170166,
                3.074949264526367,
                3.047463893890381,
                3.1239826679229736,
                3.174701690673828,
                2.837393045425415,
                3.1607141494750977,
                3.033085346221924,
                3.1675524711608887,
                3.1293153762817383,
                3.137246608734131,
                3.140453815460205,
                3.1342265605926514,
                3.1133151054382324,
                3.2007734775543213,
                3.0895237922668457,
                3.128267526626587,
                2.9965732097625732,
                3.14042592048645,
                2.9509878158569336
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}