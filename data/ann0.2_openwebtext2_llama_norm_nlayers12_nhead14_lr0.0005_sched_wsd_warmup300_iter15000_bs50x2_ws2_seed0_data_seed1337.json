{
    "summary": {
        "iter": 15000,
        "val/acc": 0.420989990234375,
        "val/loss": 3.1002392768859863,
        "train/perplexity": 22.540852190711195,
        "optimized_parameters": 166205312,
        "_timestamp": 1715582966.637983,
        "parameters": 166205312,
        "train/loss": 3.1153314113616943,
        "final-val/acc": 0.4197715222835541,
        "final-val/loss": 3.1004602909088135,
        "_step": 76,
        "_wandb": {
            "runtime": 1329
        },
        "lr": 0,
        "iter_dt": 0.374167065,
        "_runtime": 1328.9420511722565,
        "val/perplexity": 22.203217071314366,
        "final-val/perplexity": 22.208124832659845
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 896,
        "n_head": 14,
        "compile": true,
        "dataset": "openwebtext2",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 15000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/openwebtext2_llama_norm_nlayers12_nhead14_lr0.0005_sched_wsd_warmup300_iter30000_bs50x2_ws2_seed0_data_seed1337/ckpts/12000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            15000,
            25000,
            30000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-openwebtext",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_openwebtext2_llama_norm_nlayers12_nhead14_lr0.0005_sched_wsd_warmup300_iter15000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                15000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1004602909088135
            ],
            "final_val_perplexity": [
                22.208124832659845
            ]
        },
        "val": {
            "iter": [
                12000,
                12200,
                12400,
                12600,
                12800,
                13000,
                13200,
                13400,
                13600,
                13800,
                14000,
                14200,
                14400,
                14600,
                14800
            ],
            "val_perplexity": [
                25.906710158922913,
                25.619604544222238,
                25.299632562134253,
                25.030471565825604,
                24.71421574184347,
                24.46303832506907,
                24.120303989985107,
                23.863428069153688,
                23.612209394437713,
                23.306959381030154,
                23.072669601619253,
                22.810912299631706,
                22.579940022021002,
                22.364536858814493,
                22.203217071314366
            ],
            "val_loss": [
                3.2545042037963867,
                3.2433600425720215,
                3.2307920455932617,
                3.2200961112976074,
                3.207380771636963,
                3.1971654891967773,
                3.183056116104126,
                3.172349214553833,
                3.1617660522460938,
                3.148754119873047,
                3.138650894165039,
                3.1272411346435547,
                3.1170639991760254,
                3.107478618621826,
                3.1002392768859863
            ],
            "val_acc": [
                0.40106201171875,
                0.4027087092399597,
                0.40458860993385315,
                0.40589845180511475,
                0.40752074122428894,
                0.40862545371055603,
                0.4102831780910492,
                0.4115954637527466,
                0.4127856492996216,
                0.4145275950431824,
                0.4156872630119324,
                0.41709104180336,
                0.41865110397338867,
                0.41991209983825684,
                0.420989990234375
            ]
        },
        "train": {
            "iter": [
                12050,
                12100,
                12150,
                12200,
                12250,
                12300,
                12350,
                12400,
                12450,
                12500,
                12550,
                12600,
                12650,
                12700,
                12750,
                12800,
                12850,
                12900,
                12950,
                13000,
                13050,
                13100,
                13150,
                13200,
                13250,
                13300,
                13350,
                13400,
                13450,
                13500,
                13550,
                13600,
                13650,
                13700,
                13750,
                13800,
                13850,
                13900,
                13950,
                14000,
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000
            ],
            "train_perplexity": [
                25.13665311220764,
                22.542695601022213,
                25.14457116631677,
                23.218861955832914,
                24.622002451634806,
                26.87931981005166,
                21.93871950569513,
                26.082889771302458,
                24.792530706074594,
                23.224824782644767,
                21.195886117823267,
                24.803302880264877,
                21.29509522241523,
                25.19079854019713,
                24.807785767031916,
                24.05064273578142,
                23.03206985095579,
                23.575521768359803,
                27.353075963325665,
                20.594868227307384,
                24.73449365164183,
                26.937976862288682,
                22.929770217739698,
                22.807807103725825,
                26.776914894151,
                21.994705879981918,
                23.25864307090352,
                22.87512836365027,
                26.965003487427364,
                22.932257782861754,
                20.473913510456942,
                21.95421799937068,
                21.54147669317304,
                19.559438524910213,
                22.393743925044053,
                25.713144617541577,
                23.760959261182684,
                20.32376462009387,
                19.677270654060063,
                21.13686787496681,
                21.07805416680081,
                22.180370827133427,
                23.10151809751539,
                20.09222571544605,
                29.59704944766131,
                21.03153021351506,
                20.77751264181765,
                20.155779080894757,
                20.975865004480777,
                18.412584793163727,
                21.736257366872216,
                19.202598716664873,
                21.633244433496213,
                23.08389977149535,
                24.045981351084727,
                20.898322645856368,
                24.346411812233967,
                21.37656109684925,
                19.796983157351153,
                22.540852190711195
            ],
            "train_lr": [
                0.0004916666666666666,
                0.00048333333333333334,
                0.000475,
                0.00046666666666666666,
                0.0004583333333333333,
                0.00045000000000000004,
                0.00044166666666666665,
                0.00043333333333333337,
                0.000425,
                0.0004166666666666667,
                0.00040833333333333336,
                0.0004,
                0.0003916666666666667,
                0.0003833333333333333,
                0.000375,
                0.0003666666666666667,
                0.00035833333333333333,
                0.00035,
                0.00034166666666666666,
                0.0003333333333333334,
                0.00032500000000000004,
                0.00031666666666666665,
                0.00030833333333333337,
                0.0003,
                0.00029166666666666664,
                0.00028333333333333335,
                0.000275,
                0.0002666666666666667,
                0.0002583333333333333,
                0.00025,
                0.00024166666666666664,
                0.00023333333333333333,
                0.000225,
                0.00021666666666666668,
                0.00020833333333333332,
                0.0002,
                0.00019166666666666665,
                0.00018333333333333336,
                0.000175,
                0.0001666666666666667,
                0.00015833333333333332,
                0.00015000000000000001,
                0.00014166666666666668,
                0.00013333333333333337,
                0.000125,
                0.00011666666666666664,
                0.00010833333333333334,
                9.999999999999998e-05,
                9.166666666666668e-05,
                8.333333333333332e-05,
                7.500000000000001e-05,
                6.666666666666666e-05,
                5.8333333333333346e-05,
                4.999999999999999e-05,
                4.1666666666666686e-05,
                3.333333333333333e-05,
                2.500000000000002e-05,
                1.6666666666666664e-05,
                8.333333333333359e-06,
                0
            ],
            "train_loss": [
                3.2243292331695557,
                3.115413188934326,
                3.224644184112549,
                3.1449670791625977,
                3.2036426067352295,
                3.2913594245910645,
                3.0882551670074463,
                3.261281728744507,
                3.2105445861816406,
                3.14522385597229,
                3.05380916595459,
                3.2109789848327637,
                3.058478832244873,
                3.2264809608459473,
                3.2111597061157227,
                3.180163860321045,
                3.136889696121216,
                3.1602110862731934,
                3.308831214904785,
                3.0250439643859863,
                3.2082009315490723,
                3.29353928565979,
                3.1324381828308105,
                3.1271049976348877,
                3.2875423431396484,
                3.090803861618042,
                3.146678924560547,
                3.130052328109741,
                3.294542074203491,
                3.1325466632843018,
                3.019153594970703,
                3.088961362838745,
                3.0699822902679443,
                2.9734599590301514,
                3.108783721923828,
                3.247004508972168,
                3.168045997619629,
                3.0117928981781006,
                2.979466199874878,
                3.051020860671997,
                3.048234462738037,
                3.099209785461426,
                3.1399004459381104,
                3.0003349781036377,
                3.387676954269409,
                3.046024799346924,
                3.0338733196258545,
                3.003493070602417,
                3.043374538421631,
                2.913036346435547,
                3.078983783721924,
                2.955047607421875,
                3.074233293533325,
                3.1391375064849854,
                3.1799700260162354,
                3.039670944213867,
                3.1923866271972656,
                3.0622971057891846,
                2.9855315685272217,
                3.1153314113616943
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}