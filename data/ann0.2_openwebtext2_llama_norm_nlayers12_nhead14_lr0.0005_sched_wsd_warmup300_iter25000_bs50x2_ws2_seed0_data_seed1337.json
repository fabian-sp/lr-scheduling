{
    "summary": {
        "iter": 25000,
        "parameters": 166205312,
        "val/perplexity": 20.43042780543231,
        "train/perplexity": 17.590871818217803,
        "optimized_parameters": 166205312,
        "lr": 0,
        "_wandb": {
            "runtime": 1971
        },
        "iter_dt": 0.360518589,
        "_step": 126,
        "val/acc": 0.43070188164711,
        "val/loss": 3.0170273780822754,
        "_timestamp": 1715583606.579728,
        "train/loss": 2.867382049560547,
        "_runtime": 1971.7096531391144,
        "final-val/acc": 0.4289165735244751,
        "final-val/loss": 3.021263360977173,
        "final-val/perplexity": 20.51715424599255
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 896,
        "n_head": 14,
        "compile": true,
        "dataset": "openwebtext2",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/openwebtext2_llama_norm_nlayers12_nhead14_lr0.0005_sched_wsd_warmup300_iter30000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            15000,
            25000,
            30000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-openwebtext",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_openwebtext2_llama_norm_nlayers12_nhead14_lr0.0005_sched_wsd_warmup300_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.021263360977173
            ],
            "final_val_perplexity": [
                20.51715424599255
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                23.878242384068574,
                23.79402081472832,
                23.675570797634446,
                23.48498695709726,
                23.296659334875518,
                23.156336347032987,
                22.9823781212023,
                22.828414799369423,
                22.69602515439745,
                22.540857564866172,
                22.374659508023626,
                22.185712561288174,
                22.048359067174772,
                21.872026388484525,
                21.725128584577487,
                21.56875008455013,
                21.43378534739065,
                21.280615058955075,
                21.134701036036066,
                20.986795107377038,
                20.852652787391524,
                20.72513845342497,
                20.611894000079538,
                20.511681200201206,
                20.43042780543231
            ],
            "val_loss": [
                3.1729698181152344,
                3.169436454772949,
                3.1644458770751953,
                3.1563634872436523,
                3.1483120918273926,
                3.142270565032959,
                3.1347298622131348,
                3.1280081272125244,
                3.122191905975342,
                3.1153316497802734,
                3.107931137084961,
                3.0994505882263184,
                3.093240261077881,
                3.0852105617523193,
                3.0784716606140137,
                3.0712475776672363,
                3.0649704933166504,
                3.0577986240386963,
                3.0509183406829834,
                3.0438954830169678,
                3.0374832153320312,
                3.0313494205474854,
                3.0258703231811523,
                3.020996570587158,
                3.0170273780822754
            ],
            "val_acc": [
                0.4106518626213074,
                0.4111071527004242,
                0.41151732206344604,
                0.41278076171875,
                0.41377928853034973,
                0.41435423493385315,
                0.41533201932907104,
                0.4163464307785034,
                0.4168761968612671,
                0.4170287847518921,
                0.41840821504592896,
                0.41978394985198975,
                0.42023801803588867,
                0.42155516147613525,
                0.42242431640625,
                0.42310547828674316,
                0.4239599406719208,
                0.4252636730670929,
                0.4260351359844208,
                0.42701292037963867,
                0.4279504418373108,
                0.4289025664329529,
                0.42961180210113525,
                0.4299975335597992,
                0.43070188164711
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                27.95742726552083,
                20.575668495999274,
                27.775922423095622,
                20.723043467308297,
                21.215598834961963,
                25.11355456512807,
                21.51220151694912,
                27.694779039798195,
                22.396990321592334,
                24.706509783360104,
                23.327028094594343,
                21.811848323509015,
                23.04485158080882,
                20.052562439707952,
                20.656036812912692,
                20.925634859340782,
                18.485918846789517,
                25.333832393123096,
                21.29589234877398,
                23.25462862822429,
                22.005390386165043,
                21.22301037690584,
                24.575904794231377,
                23.502535971602203,
                22.34850892754375,
                19.746576847545168,
                23.137644616589412,
                23.158169357413595,
                23.660210930220085,
                20.945500729225568,
                20.95831872298968,
                23.156557183969834,
                20.909197387564824,
                23.152334042554656,
                20.324748292542164,
                21.811692313675344,
                18.322033846596106,
                22.037327941050563,
                19.13600016715554,
                22.535618372108825,
                22.47419856228129,
                21.61938480562817,
                22.836863455376488,
                21.30421064435757,
                19.974651648473678,
                19.83417361429906,
                21.46011397203207,
                20.437516325734688,
                23.877587696572775,
                25.155346361631022,
                21.30319480533442,
                21.157342864483848,
                21.56019998961319,
                23.396651704655852,
                18.916842776846682,
                22.71648852264802,
                22.26828656543631,
                21.314453007151677,
                21.123356474552853,
                24.034678522802952,
                22.060247748886052,
                20.096844150008696,
                20.29410722598267,
                19.252580346417986,
                20.992184717978933,
                21.669601081005542,
                21.934012475390283,
                21.480149246655724,
                17.85481829281307,
                20.09333231831262,
                21.207299969497903,
                22.309566409482315,
                19.55799294590669,
                18.31753503935922,
                24.926515424401526,
                20.39530895786462,
                21.721632588102064,
                19.108736605272586,
                22.423096055698636,
                23.893157040572994,
                19.225297366413045,
                19.68921864486611,
                19.1394861390578,
                20.74932517386626,
                21.43026981179207,
                15.50953355645542,
                21.33670238553762,
                18.98339821734859,
                21.44305215934565,
                20.889380891008738,
                21.101228949262115,
                20.861161026951386,
                21.040001078716347,
                20.33212008229849,
                22.009745404067054,
                20.190894655782515,
                20.881294265673855,
                18.435764870803652,
                21.10374456002078,
                17.590871818217803
            ],
            "train_lr": [
                0.000495,
                0.00049,
                0.00048499999999999997,
                0.00048,
                0.000475,
                0.00047,
                0.00046499999999999997,
                0.00046,
                0.000455,
                0.00045000000000000004,
                0.00044500000000000003,
                0.00044,
                0.000435,
                0.00043,
                0.000425,
                0.00042,
                0.000415,
                0.00041000000000000005,
                0.00040500000000000003,
                0.0004,
                0.000395,
                0.00039000000000000005,
                0.00038500000000000003,
                0.00038,
                0.000375,
                0.00037,
                0.000365,
                0.00035999999999999997,
                0.000355,
                0.00035,
                0.000345,
                0.00033999999999999997,
                0.00033499999999999996,
                0.00032999999999999994,
                0.00032500000000000004,
                0.00032,
                0.000315,
                0.00031,
                0.000305,
                0.0003,
                0.00029500000000000007,
                0.00029000000000000006,
                0.00028500000000000004,
                0.00028000000000000003,
                0.000275,
                0.00027,
                0.00026500000000000004,
                0.00026000000000000003,
                0.000255,
                0.00025,
                0.000245,
                0.00024,
                0.000235,
                0.00022999999999999998,
                0.000225,
                0.00021999999999999998,
                0.00021500000000000002,
                0.00021000000000000004,
                0.00020500000000000002,
                0.0002,
                0.00019500000000000002,
                0.00019,
                0.000185,
                0.00017999999999999998,
                0.000175,
                0.00016999999999999999,
                0.00016499999999999997,
                0.00015999999999999999,
                0.00015500000000000003,
                0.00015000000000000001,
                0.00014500000000000003,
                0.00014000000000000001,
                0.000135,
                0.00013000000000000002,
                0.000125,
                0.00012,
                0.00011499999999999999,
                0.00010999999999999999,
                0.00010499999999999999,
                9.999999999999998e-05,
                9.499999999999998e-05,
                9.000000000000003e-05,
                8.500000000000002e-05,
                8.000000000000002e-05,
                7.500000000000001e-05,
                7.000000000000001e-05,
                6.500000000000001e-05,
                6e-05,
                5.4999999999999995e-05,
                4.999999999999999e-05,
                4.499999999999998e-05,
                3.999999999999998e-05,
                3.4999999999999977e-05,
                3.0000000000000028e-05,
                2.500000000000002e-05,
                2.000000000000002e-05,
                1.5000000000000014e-05,
                1.000000000000001e-05,
                5.000000000000005e-06,
                0
            ],
            "train_loss": [
                3.3306851387023926,
                3.024111270904541,
                3.324171781539917,
                3.0312483310699463,
                3.054738759994507,
                3.22340989112854,
                3.068622350692749,
                3.3212461471557617,
                3.108928680419922,
                3.207068920135498,
                3.1496148109436035,
                3.0824553966522217,
                3.137444496154785,
                2.998358964920044,
                3.0280096530914307,
                3.0409770011901855,
                2.917011260986328,
                3.232142925262451,
                3.058516263961792,
                3.1465063095092773,
                3.091289520263672,
                3.0550880432128906,
                3.201768636703491,
                3.1571104526519775,
                3.1067616939544678,
                2.9829821586608887,
                3.141463041305542,
                3.1423497200012207,
                3.163796901702881,
                3.0419259071350098,
                3.0425376892089844,
                3.142280101776123,
                3.040191173553467,
                3.1420977115631104,
                3.011841297149658,
                3.0824482440948486,
                2.9081063270568848,
                3.0927398204803467,
                2.951573371887207,
                3.1150991916656494,
                3.112370014190674,
                3.0735924243927,
                3.12837815284729,
                3.0589067935943604,
                2.9944660663604736,
                2.987408399581909,
                3.0661981105804443,
                3.017374277114868,
                3.1729423999786377,
                3.2250726222991943,
                3.05885910987854,
                3.0519890785217285,
                3.0708510875701904,
                3.152595043182373,
                2.9400546550750732,
                3.1230931282043457,
                3.103165626525879,
                3.059387445449829,
                3.0503814220428467,
                3.179499864578247,
                3.0937793254852295,
                3.0005648136138916,
                3.0103325843811035,
                2.9576470851898193,
                3.04415225982666,
                3.0759124755859375,
                3.088040590286255,
                3.067131280899048,
                2.882275342941284,
                3.00039005279541,
                3.054347515106201,
                3.10501766204834,
                2.97338604927063,
                2.90786075592041,
                3.2159342765808105,
                3.0153069496154785,
                3.07831072807312,
                2.9501476287841797,
                3.110093593597412,
                3.1735942363739014,
                2.9562289714813232,
                2.9800732135772705,
                2.9517555236816406,
                3.03251576423645,
                3.0648064613342285,
                2.7414567470550537,
                3.0604307651519775,
                2.9435667991638184,
                3.0654027462005615,
                3.03924298286438,
                3.049333333969116,
                3.037891149520874,
                3.0464274883270264,
                3.0122039318084717,
                3.091487407684326,
                3.0052337646484375,
                3.038855791091919,
                2.914294481277466,
                3.049452543258667,
                2.867382049560547
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}