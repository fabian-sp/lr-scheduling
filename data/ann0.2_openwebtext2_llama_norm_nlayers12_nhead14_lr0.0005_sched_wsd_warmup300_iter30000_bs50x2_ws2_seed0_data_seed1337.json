{
    "summary": {
        "final-val/acc": 0.4315988421440125,
        "final-val/loss": 2.9969024658203125,
        "val/perplexity": 19.94675915507554,
        "train/perplexity": 18.765992993755244,
        "optimized_parameters": 166205312,
        "iter": 30000,
        "_wandb": {
            "runtime": 2346
        },
        "iter_dt": 0.356880658,
        "final-val/perplexity": 20.02337717951081,
        "_step": 151,
        "val/acc": 0.433197021484375,
        "_runtime": 2345.8792040348053,
        "_timestamp": 1715583980.858879,
        "train/loss": 2.9320483207702637,
        "lr": 0,
        "val/loss": 2.9930686950683594,
        "parameters": 166205312
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 896,
        "n_head": 14,
        "compile": true,
        "dataset": "openwebtext2",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 30000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/openwebtext2_llama_norm_nlayers12_nhead14_lr0.0005_sched_wsd_warmup300_iter30000_bs50x2_ws2_seed0_data_seed1337/ckpts/24000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            15000,
            25000,
            30000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-openwebtext",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_openwebtext2_llama_norm_nlayers12_nhead14_lr0.0005_sched_wsd_warmup300_iter30000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000,
                30000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.130176544189453,
                2.9969024658203125
            ],
            "final_val_perplexity": [
                22.8779699969917,
                20.023377179510806
            ]
        },
        "val": {
            "iter": [
                24000,
                24200,
                24400,
                24600,
                24800,
                25200,
                25400,
                25600,
                25800,
                26000,
                26200,
                26400,
                26600,
                26800,
                27000,
                27200,
                27400,
                27600,
                27800,
                28000,
                28200,
                28400,
                28600,
                28800,
                29000,
                29200,
                29400,
                29600,
                29800
            ],
            "val_perplexity": [
                23.38476201988048,
                23.246901113926278,
                23.16379075770388,
                23.033832615974497,
                22.932438210168606,
                22.68530278784921,
                22.54401241497162,
                22.401390794363337,
                22.244333865051072,
                22.090969227175123,
                21.98459263970607,
                21.837188718903437,
                21.72180866928373,
                21.608691947278242,
                21.458625126126815,
                21.343901793796704,
                21.22045019331205,
                21.098250853826297,
                20.98304771674362,
                20.863240130890674,
                20.728370285979864,
                20.618598134179805,
                20.493721874896305,
                20.389474651734584,
                20.277663029457287,
                20.187221998507454,
                20.096139818054166,
                20.010129101328477,
                19.94675915507554
            ],
            "val_loss": [
                3.1520867347717285,
                3.1461739540100098,
                3.142592430114746,
                3.1369662284851074,
                3.132554531097412,
                3.1217193603515625,
                3.115471601486206,
                3.1091251373291016,
                3.1020894050598145,
                3.0951709747314453,
                3.090343952178955,
                3.0836164951324463,
                3.0783188343048096,
                3.0730977058410645,
                3.066128730773926,
                3.0607681274414062,
                3.0549674034118652,
                3.049192190170288,
                3.0437169075012207,
                3.0379908084869385,
                3.0315053462982178,
                3.026195526123047,
                3.020120620727539,
                3.0150208473205566,
                3.009521961212158,
                3.005051851272583,
                3.0005297660827637,
                2.9962406158447266,
                2.9930686950683594
            ],
            "val_acc": [
                0.41277217864990234,
                0.4135205149650574,
                0.41381222009658813,
                0.4144970774650574,
                0.4151867628097534,
                0.4166613817214966,
                0.41734862327575684,
                0.41835325956344604,
                0.41923460364341736,
                0.4201452434062958,
                0.4204040467739105,
                0.42124509811401367,
                0.42241454124450684,
                0.4226928651332855,
                0.42373043298721313,
                0.42420411109924316,
                0.42478880286216736,
                0.4256823658943176,
                0.4265466332435608,
                0.426849365234375,
                0.4278576672077179,
                0.42866697907447815,
                0.42946532368659973,
                0.4302087128162384,
                0.4307019114494324,
                0.43120115995407104,
                0.43226683139801025,
                0.43281495571136475,
                0.433197021484375
            ]
        },
        "train": {
            "iter": [
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000,
                25050,
                25100,
                25150,
                25200,
                25250,
                25300,
                25350,
                25400,
                25450,
                25500,
                25550,
                25600,
                25650,
                25700,
                25750,
                25800,
                25850,
                25900,
                25950,
                26000,
                26050,
                26100,
                26150,
                26200,
                26250,
                26300,
                26350,
                26400,
                26450,
                26500,
                26550,
                26600,
                26650,
                26700,
                26750,
                26800,
                26850,
                26900,
                26950,
                27000,
                27050,
                27100,
                27150,
                27200,
                27250,
                27300,
                27350,
                27400,
                27450,
                27500,
                27550,
                27600,
                27650,
                27700,
                27750,
                27800,
                27850,
                27900,
                27950,
                28000,
                28050,
                28100,
                28150,
                28200,
                28250,
                28300,
                28350,
                28400,
                28450,
                28500,
                28550,
                28600,
                28650,
                28700,
                28750,
                28800,
                28850,
                28900,
                28950,
                29000,
                29050,
                29100,
                29150,
                29200,
                29250,
                29300,
                29350,
                29400,
                29450,
                29500,
                29550,
                29600,
                29650,
                29700,
                29750,
                29800,
                29850,
                29900,
                29950,
                30000
            ],
            "train_perplexity": [
                21.37659167626649,
                22.283954125085412,
                21.443139070637788,
                23.216747374865456,
                24.094565986490796,
                17.46394377491908,
                24.095571310419757,
                21.426295089767873,
                24.143145175316096,
                23.360215460026275,
                23.48007132708023,
                23.628405634876138,
                23.45657115287484,
                23.014131370964776,
                24.812062415316767,
                22.485207129534437,
                23.251612707319012,
                20.46771024426649,
                23.537650903347206,
                19.566924602434874,
                23.655315022728065,
                20.037632468149138,
                23.186549826801294,
                26.362764368756885,
                22.14437150519815,
                20.286923341692507,
                22.87614825669709,
                23.19359922639302,
                24.66593412137942,
                25.42130409142227,
                24.882351004964036,
                20.226804407344467,
                21.343550670912105,
                23.491701421653875,
                21.897139116216753,
                23.800857680822766,
                24.02800936735862,
                21.362988156166434,
                21.681466456241598,
                21.367954730013,
                21.419629634223508,
                19.564848736283295,
                21.98906412101223,
                20.823906614932714,
                22.018526270688564,
                20.402827949873593,
                23.030268784926463,
                26.438441768353655,
                19.472135873917974,
                24.900665161212416,
                23.2002691014405,
                20.672092906770168,
                21.942255672744913,
                22.139963456246797,
                22.903811777638143,
                22.57933708102852,
                19.69007302097489,
                23.037704582789562,
                21.89321873556032,
                19.705124566737283,
                20.434875503629335,
                21.191202050557074,
                23.767503295303758,
                23.479052498356083,
                20.18746746328271,
                20.195497250697514,
                21.97115745904989,
                20.862837226142666,
                20.78581677193238,
                23.21856302432221,
                21.261500908378775,
                20.794153967186027,
                20.12954847386211,
                20.24365621585647,
                16.738195197980982,
                18.43616046337965,
                19.883589894688637,
                20.292563806699725,
                19.74745725337744,
                20.99194948789304,
                18.592619845476467,
                20.24012355504032,
                20.29639112127406,
                18.489537662840743,
                21.18554414837171,
                23.078308763774576,
                21.76942360718137,
                21.595234198456204,
                20.834211129628414,
                19.432311370605003,
                21.224083114810064,
                19.01037417308723,
                21.141882691289066,
                19.759909546308005,
                19.394034035855185,
                22.524456237683165,
                19.615693746461464,
                23.71835666553404,
                20.500441337290606,
                16.870878135429276,
                21.765614310542926,
                18.657176041948485,
                20.841613661313737,
                19.01036964066442,
                19.229487292727065,
                20.908210353582337,
                21.054287400605148,
                20.245437258126234,
                20.25443657157566,
                21.877940650892363,
                20.567031515355946,
                20.56489367469112,
                21.75705361097995,
                17.16355864850462,
                20.936124484927166,
                18.540536337075324,
                21.83204541335126,
                17.85191956729474,
                19.657018823605085,
                18.765992993755244
            ],
            "train_lr": [
                0.0004958333333333334,
                0.0004916666666666666,
                0.0004875,
                0.00048333333333333334,
                0.0004791666666666667,
                0.000475,
                0.00047083333333333336,
                0.00046666666666666666,
                0.0004625,
                0.0004583333333333333,
                0.0004541666666666667,
                0.00045000000000000004,
                0.0004458333333333333,
                0.00044166666666666665,
                0.0004375,
                0.00043333333333333337,
                0.0004291666666666667,
                0.000425,
                0.00042083333333333333,
                0.0004166666666666667,
                0.0004125,
                0.00040833333333333336,
                0.00040416666666666666,
                0.0004,
                0.0003958333333333333,
                0.0003916666666666667,
                0.00038750000000000004,
                0.0003833333333333333,
                0.00037916666666666665,
                0.000375,
                0.00037083333333333337,
                0.0003666666666666667,
                0.0003625,
                0.00035833333333333333,
                0.00035416666666666664,
                0.00035,
                0.00034583333333333335,
                0.00034166666666666666,
                0.0003375,
                0.0003333333333333334,
                0.0003291666666666667,
                0.00032500000000000004,
                0.0003208333333333333,
                0.00031666666666666665,
                0.0003125,
                0.00030833333333333337,
                0.0003041666666666667,
                0.0003,
                0.00029583333333333333,
                0.00029166666666666664,
                0.0002875,
                0.00028333333333333335,
                0.00027916666666666666,
                0.000275,
                0.0002708333333333334,
                0.0002666666666666667,
                0.00026250000000000004,
                0.0002583333333333333,
                0.00025416666666666665,
                0.00025,
                0.00024583333333333336,
                0.00024166666666666664,
                0.0002375,
                0.00023333333333333333,
                0.0002291666666666667,
                0.000225,
                0.00022083333333333333,
                0.00021666666666666668,
                0.00021250000000000002,
                0.00020833333333333332,
                0.00020416666666666668,
                0.0002,
                0.00019583333333333337,
                0.00019166666666666665,
                0.0001875,
                0.00018333333333333336,
                0.00017916666666666664,
                0.000175,
                0.00017083333333333333,
                0.0001666666666666667,
                0.0001625,
                0.00015833333333333332,
                0.00015416666666666668,
                0.00015000000000000001,
                0.00014583333333333332,
                0.00014166666666666668,
                0.0001375,
                0.00013333333333333337,
                0.00012916666666666664,
                0.000125,
                0.00012083333333333335,
                0.00011666666666666664,
                0.0001125,
                0.00010833333333333334,
                0.00010416666666666669,
                9.999999999999998e-05,
                9.583333333333332e-05,
                9.166666666666668e-05,
                8.750000000000003e-05,
                8.333333333333332e-05,
                7.916666666666666e-05,
                7.500000000000001e-05,
                7.083333333333337e-05,
                6.666666666666666e-05,
                6.25e-05,
                5.8333333333333346e-05,
                5.4166666666666644e-05,
                4.999999999999999e-05,
                4.583333333333334e-05,
                4.1666666666666686e-05,
                3.7499999999999976e-05,
                3.333333333333333e-05,
                2.9166666666666673e-05,
                2.500000000000002e-05,
                2.0833333333333316e-05,
                1.6666666666666664e-05,
                1.250000000000001e-05,
                8.333333333333359e-06,
                4.166666666666652e-06,
                0
            ],
            "train_loss": [
                3.062298536300659,
                3.1038689613342285,
                3.0654067993164062,
                3.144876003265381,
                3.181988477706909,
                2.860140323638916,
                3.182030200958252,
                3.0646209716796875,
                3.184002637863159,
                3.151036500930786,
                3.156154155731201,
                3.16245174407959,
                3.1551527976989746,
                3.136110544204712,
                3.211332082748413,
                3.1128597259521484,
                3.146376609802246,
                3.018850564956665,
                3.1586034297943115,
                2.9738426208496094,
                3.1635899543762207,
                2.9976141452789307,
                3.1435744762420654,
                3.2719547748565674,
                3.097585439682007,
                3.0099785327911377,
                3.130096912384033,
                3.14387845993042,
                3.205425262451172,
                3.2355897426605225,
                3.214160919189453,
                3.0070106983184814,
                3.0607516765594482,
                3.156649351119995,
                3.086358070373535,
                3.1697237491607666,
                3.179222345352173,
                3.061661958694458,
                3.0764598846435547,
                3.061894416809082,
                3.06430983543396,
                2.973736524581909,
                3.0905473232269287,
                3.0361037254333496,
                3.091886281967163,
                3.0156755447387695,
                3.1368114948272705,
                3.2748212814331055,
                2.9689865112304688,
                3.2148966789245605,
                3.1441659927368164,
                3.0287866592407227,
                3.088416337966919,
                3.097386360168457,
                3.131305456161499,
                3.117037296295166,
                2.980116605758667,
                3.137134313583374,
                3.08617901802063,
                2.9808807373046875,
                3.017245054244995,
                3.0535881519317627,
                3.168321371078491,
                3.1561107635498047,
                3.005064010620117,
                3.0054616928100586,
                3.0897326469421387,
                3.0379714965820312,
                3.0342729091644287,
                3.144954204559326,
                3.0569000244140625,
                3.0346739292144775,
                3.0021908283233643,
                3.007843494415283,
                2.817695140838623,
                2.914315938949585,
                2.989896774291992,
                3.01025652885437,
                2.9830267429351807,
                3.0441410541534424,
                2.92276668548584,
                3.007668972015381,
                3.0104451179504395,
                2.9172070026397705,
                3.053321123123169,
                3.138895273208618,
                3.0805084705352783,
                3.072474718093872,
                3.0365984439849854,
                2.9669392108917236,
                3.05513858795166,
                2.9449868202209473,
                3.051258087158203,
                2.983657121658325,
                2.9649674892425537,
                3.1146037578582764,
                2.976331949234009,
                3.1662514209747314,
                3.0204484462738037,
                2.8255908489227295,
                3.0803334712982178,
                2.9262328147888184,
                3.0369536876678467,
                2.944986581802368,
                2.956446886062622,
                3.0401439666748047,
                3.0471062660217285,
                3.0079314708709717,
                3.008375883102417,
                3.0854809284210205,
                3.023691415786743,
                3.023587465286255,
                3.0799400806427,
                2.842790365219116,
                3.041478157043457,
                2.919961452484131,
                3.083380937576294,
                2.882112979888916,
                2.9784364700317383,
                2.9320483207702637
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}