{
    "summary": {
        "iter_dt": 0.186461141,
        "_runtime": 565.3387217521667,
        "lr": 0,
        "final-val/acc": 0.4198248684406281,
        "final-val/loss": 3.266383409500122,
        "val/perplexity": 25.26190104235114,
        "final-val/perplexity": 26.216296267692016,
        "iter": 12500,
        "_step": 64,
        "_wandb": {
            "runtime": 565
        },
        "val/acc": 0.42543089389801025,
        "_timestamp": 1715257875.420442,
        "optimized_parameters": 59845120,
        "val/loss": 3.229299545288086,
        "parameters": 59845120,
        "train/loss": 3.3047304153442383,
        "train/perplexity": 27.241136234796965
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 512,
        "n_head": 8,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 10,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 12500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl_slimpajama_llama_norm_nlayers10_nhead8_lr0.001_sched_wsd_warmup300_iter17500_bs50x2_ws2_seed0_data_seed1337/ckpts/10000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            7500,
            12500,
            17500
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers10_nhead8_lr0.001_sched_wsd_warmup300_iter12500_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                12500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.266383409500122
            ],
            "final_val_perplexity": [
                26.216296267692016
            ]
        },
        "val": {
            "iter": [
                10000,
                10200,
                10400,
                10600,
                10800,
                11000,
                11200,
                11400,
                11600,
                11800,
                12000,
                12200,
                12400
            ],
            "val_perplexity": [
                29.443076697638528,
                29.143095085471376,
                28.771193119262136,
                28.410227406617352,
                27.93338824566361,
                27.60066246880285,
                27.201430083593706,
                26.81508073911993,
                26.478612379427123,
                26.123535354485984,
                25.780545551623366,
                25.492248845878525,
                25.26190104235114
            ],
            "val_loss": [
                3.3824610710144043,
                3.372220277786255,
                3.359376907348633,
                3.3467514514923096,
                3.329824924468994,
                3.3178420066833496,
                3.303271770477295,
                3.288966655731201,
                3.276339530944824,
                3.262838840484619,
                3.249622344970703,
                3.2383766174316406,
                3.229299545288086
            ],
            "val_acc": [
                0.4080883860588074,
                0.4086377024650574,
                0.4104601740837097,
                0.4119933843612671,
                0.4137353301048279,
                0.41533446311950684,
                0.41658324003219604,
                0.41846799850463867,
                0.42006099224090576,
                0.42119503021240234,
                0.4229748249053955,
                0.42451903223991394,
                0.42543089389801025
            ]
        },
        "train": {
            "iter": [
                10050,
                10100,
                10150,
                10200,
                10250,
                10300,
                10350,
                10400,
                10450,
                10500,
                10550,
                10600,
                10650,
                10700,
                10750,
                10800,
                10850,
                10900,
                10950,
                11000,
                11050,
                11100,
                11150,
                11200,
                11250,
                11300,
                11350,
                11400,
                11450,
                11500,
                11550,
                11600,
                11650,
                11700,
                11750,
                11800,
                11850,
                11900,
                11950,
                12000,
                12050,
                12100,
                12150,
                12200,
                12250,
                12300,
                12350,
                12400,
                12450,
                12500
            ],
            "train_perplexity": [
                44.57283945573304,
                29.957576916670842,
                39.43919092975297,
                29.997079193267034,
                42.96119013911691,
                31.40197752612578,
                31.148997065407578,
                31.86046041770829,
                30.38701505633952,
                32.919213923579356,
                32.69899368912228,
                32.35224526031603,
                30.47624264970834,
                25.022237459360063,
                27.855324395129603,
                35.96161189374376,
                29.630049827122864,
                36.59185166081589,
                34.441428357458044,
                35.0826541291841,
                33.66610119766508,
                29.014627986896226,
                27.79145603861897,
                31.94143143448569,
                33.98830470475345,
                32.33595872123547,
                30.264578532921703,
                27.93099746748343,
                41.15145524115997,
                30.57180328351136,
                34.7335598907148,
                35.20012693191116,
                35.356006645986376,
                30.807004498268263,
                30.601373987930764,
                22.75717763548973,
                33.73397036369258,
                34.173069166473184,
                31.406185395150715,
                26.046641647272462,
                22.424159950678643,
                19.499755199770235,
                26.96972918229181,
                27.463118398506023,
                25.494412642216293,
                28.630744117690565,
                22.662662900900475,
                20.445104497344726,
                29.25164080074008,
                27.241136234796965
            ],
            "train_lr": [
                0.00098,
                0.00096,
                0.00094,
                0.00092,
                0.0009000000000000001,
                0.00088,
                0.00086,
                0.00084,
                0.0008200000000000001,
                0.0008,
                0.0007800000000000001,
                0.00076,
                0.00074,
                0.0007199999999999999,
                0.0007,
                0.0006799999999999999,
                0.0006599999999999999,
                0.00064,
                0.00062,
                0.0006,
                0.0005800000000000001,
                0.0005600000000000001,
                0.00054,
                0.0005200000000000001,
                0.0005,
                0.00048,
                0.00045999999999999996,
                0.00043999999999999996,
                0.00042000000000000007,
                0.0004,
                0.00038,
                0.00035999999999999997,
                0.00033999999999999997,
                0.00031999999999999997,
                0.00030000000000000003,
                0.00028000000000000003,
                0.00026000000000000003,
                0.00024,
                0.00021999999999999998,
                0.00019999999999999996,
                0.00018000000000000007,
                0.00016000000000000004,
                0.00014000000000000001,
                0.00012,
                9.999999999999998e-05,
                7.999999999999997e-05,
                6.0000000000000056e-05,
                4.000000000000004e-05,
                2.000000000000002e-05,
                0
            ],
            "train_loss": [
                3.7971272468566895,
                3.399784564971924,
                3.674762487411499,
                3.401102304458618,
                3.7602996826171875,
                3.446873188018799,
                3.43878436088562,
                3.4613680839538574,
                3.414017677307129,
                3.494058847427368,
                3.487346649169922,
                3.4766857624053955,
                3.41694974899292,
                3.2197670936584473,
                3.3270263671875,
                3.5824544429779053,
                3.38879132270813,
                3.599828004837036,
                3.539262533187866,
                3.557709217071533,
                3.516493797302246,
                3.367802381515503,
                3.32473087310791,
                3.4639062881469727,
                3.5260188579559326,
                3.476182222366333,
                3.409980297088623,
                3.3297393321990967,
                3.717261791229248,
                3.4200804233551025,
                3.547708749771118,
                3.561052083969116,
                3.5654706954956055,
                3.4277443885803223,
                3.4210472106933594,
                3.124882698059082,
                3.518507719039917,
                3.531440258026123,
                3.447007179260254,
                3.2598910331726074,
                3.1101410388946533,
                2.9704039096832275,
                3.294717311859131,
                3.3128461837768555,
                3.238461494445801,
                3.3544833660125732,
                3.120720863342285,
                3.0177454948425293,
                3.3759379386901855,
                3.3047304153442383
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}