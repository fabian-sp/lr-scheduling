{
    "summary": {
        "val/loss": 3.3071019649505615,
        "val/perplexity": 27.305816563191815,
        "final-val/perplexity": 28.28609688011674,
        "optimized_parameters": 59845120,
        "_step": 39,
        "iter_dt": 0.193518524,
        "val/acc": 0.41740477085113525,
        "_runtime": 580.9014594554901,
        "_wandb": {
            "runtime": 581
        },
        "_timestamp": 1715257627.6844485,
        "train/loss": 3.463754415512085,
        "final-val/loss": 3.3423726558685303,
        "lr": 0,
        "train/perplexity": 31.93658077674487,
        "iter": 7500,
        "parameters": 59845120,
        "final-val/acc": 0.4119994640350342
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 512,
        "n_head": 8,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 10,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 7500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl_slimpajama_llama_norm_nlayers10_nhead8_lr0.001_sched_wsd_warmup300_iter17500_bs50x2_ws2_seed0_data_seed1337/ckpts/6000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            7500,
            12500,
            17500
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers10_nhead8_lr0.001_sched_wsd_warmup300_iter7500_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                7500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.3423726558685303
            ],
            "final_val_perplexity": [
                28.28609688011674
            ]
        },
        "val": {
            "iter": [
                6000,
                6200,
                6400,
                6600,
                6800,
                7000,
                7200,
                7400
            ],
            "val_perplexity": [
                31.80743050478625,
                31.152569414155593,
                30.42832411693978,
                29.7137319657277,
                29.034550656585488,
                28.361587791851306,
                27.758981147709274,
                27.305816563191815
            ],
            "val_loss": [
                3.459702253341675,
                3.438899040222168,
                3.4153761863708496,
                3.3916115760803223,
                3.3684887886047363,
                3.3450379371643066,
                3.323561668395996,
                3.3071019649505615
            ],
            "val_acc": [
                0.3998425006866455,
                0.40280881524086,
                0.4053429961204529,
                0.4073827862739563,
                0.4102221727371216,
                0.4127209186553955,
                0.41514769196510315,
                0.41740477085113525
            ]
        },
        "train": {
            "iter": [
                6050,
                6100,
                6150,
                6200,
                6250,
                6300,
                6350,
                6400,
                6450,
                6500,
                6550,
                6600,
                6650,
                6700,
                6750,
                6800,
                6850,
                6900,
                6950,
                7000,
                7050,
                7100,
                7150,
                7200,
                7250,
                7300,
                7350,
                7400,
                7450,
                7500
            ],
            "train_perplexity": [
                32.84343721819203,
                34.59053382720221,
                32.50709032784672,
                30.5210274180678,
                37.16905500904057,
                32.6934121992007,
                34.003485833243424,
                46.751586562769596,
                34.320718264690264,
                39.61668579885771,
                29.5193257433543,
                36.09107033637228,
                35.61679536465746,
                43.20533064586242,
                41.667290260039834,
                27.330045285769085,
                37.37208160561783,
                30.27625567919564,
                30.705473895159486,
                34.63846570035036,
                24.328134082576355,
                37.00779343335409,
                35.14099374408231,
                31.914271149987165,
                25.45870312794716,
                41.62527964322153,
                36.42458273831459,
                27.695756292962738,
                26.02275032456131,
                31.93658077674487
            ],
            "train_lr": [
                0.0009666666666666667,
                0.0009333333333333333,
                0.0009000000000000001,
                0.0008666666666666667,
                0.0008333333333333334,
                0.0008,
                0.0007666666666666666,
                0.0007333333333333334,
                0.0007,
                0.0006666666666666668,
                0.0006333333333333333,
                0.0006,
                0.0005666666666666667,
                0.0005333333333333334,
                0.0005,
                0.00046666666666666666,
                0.00043333333333333337,
                0.0004,
                0.0003666666666666667,
                0.0003333333333333334,
                0.00030000000000000003,
                0.00026666666666666673,
                0.00023333333333333328,
                0.00019999999999999996,
                0.00016666666666666663,
                0.0001333333333333333,
                9.999999999999998e-05,
                6.666666666666666e-05,
                3.333333333333333e-05,
                0
            ],
            "train_loss": [
                3.4917542934417725,
                3.5435824394226074,
                3.4814605712890625,
                3.4184181690216064,
                3.615478992462158,
                3.487175941467285,
                3.52646541595459,
                3.844850778579712,
                3.5357515811920166,
                3.679252862930298,
                3.385047435760498,
                3.586047887802124,
                3.572819709777832,
                3.7659664154052734,
                3.7297189235687256,
                3.3079888820648193,
                3.6209263801574707,
                3.4103660583496094,
                3.424443244934082,
                3.5449671745300293,
                3.1916356086730957,
                3.611130952835083,
                3.559370756149292,
                3.4630556106567383,
                3.2370598316192627,
                3.728710174560547,
                3.5952463150024414,
                3.3212814331054688,
                3.2589733600616455,
                3.463754415512085
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}