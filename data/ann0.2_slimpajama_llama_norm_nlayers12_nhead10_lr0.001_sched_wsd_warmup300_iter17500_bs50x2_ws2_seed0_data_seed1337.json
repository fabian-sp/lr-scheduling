{
    "summary": {
        "val/loss": 3.098339319229126,
        "final-val/perplexity": 22.957454794417448,
        "optimized_parameters": 93159040,
        "_timestamp": 1715383091.806907,
        "train/loss": 3.241971254348755,
        "val/perplexity": 22.16107197700721,
        "lr": 0,
        "iter": 17500,
        "_step": 89,
        "_wandb": {
            "runtime": 1702
        },
        "_runtime": 1702.481106042862,
        "parameters": 93159040,
        "train/perplexity": 25.584049058297797,
        "iter_dt": 0.397940695,
        "val/acc": 0.4390734732151031,
        "final-val/acc": 0.43401286005973816,
        "final-val/loss": 3.1336448192596436
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 640,
        "n_head": 10,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 17500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl93_slimpajama_llama_norm_nlayers12_nhead10_lr0.001_sched_wsd_warmup300_iter25000_bs50x2_ws2_seed0_data_seed1337/ckpts/14000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            10000,
            17500,
            25000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers12_nhead10_lr0.001_sched_wsd_warmup300_iter17500_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                17500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1336448192596436
            ],
            "final_val_perplexity": [
                22.957454794417448
            ]
        },
        "val": {
            "iter": [
                14000,
                14200,
                14400,
                14600,
                14800,
                15000,
                15200,
                15400,
                15600,
                15800,
                16000,
                16200,
                16400,
                16600,
                16800,
                17000,
                17200,
                17400
            ],
            "val_perplexity": [
                26.042785523293947,
                25.78688957878367,
                25.573236560557916,
                25.357278638850634,
                25.073978244788837,
                24.821381317854364,
                24.584654358482027,
                24.30211636945916,
                24.10162137373081,
                23.831503008659205,
                23.598691000996112,
                23.347125221311636,
                23.147968179432418,
                22.88515474018662,
                22.668947689427494,
                22.47136957754585,
                22.293003839568048,
                22.16107197700721
            ],
            "val_loss": [
                3.2597429752349854,
                3.249868392944336,
                3.241548538208008,
                3.2330679893493652,
                3.221832752227783,
                3.211707592010498,
                3.20212459564209,
                3.190565586090088,
                3.182281255722046,
                3.1710104942321777,
                3.161193370819092,
                3.1504759788513184,
                3.141909122467041,
                3.13049054145813,
                3.1209981441497803,
                3.112244129180908,
                3.1042749881744385,
                3.098339319229126
            ],
            "val_acc": [
                0.41988158226013184,
                0.4214856028556824,
                0.4223352074623108,
                0.4237328767776489,
                0.4243200421333313,
                0.425300270318985,
                0.4270373582839966,
                0.4284716844558716,
                0.42891111969947815,
                0.43019530177116394,
                0.431488037109375,
                0.4328674077987671,
                0.4343286156654358,
                0.4353967308998108,
                0.43635618686676025,
                0.4375365972518921,
                0.4382934272289276,
                0.43907347321510315
            ]
        },
        "train": {
            "iter": [
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000,
                15050,
                15100,
                15150,
                15200,
                15250,
                15300,
                15350,
                15400,
                15450,
                15500,
                15550,
                15600,
                15650,
                15700,
                15750,
                15800,
                15850,
                15900,
                15950,
                16000,
                16050,
                16100,
                16150,
                16200,
                16250,
                16300,
                16350,
                16400,
                16450,
                16500,
                16550,
                16600,
                16650,
                16700,
                16750,
                16800,
                16850,
                16900,
                16950,
                17000,
                17050,
                17100,
                17150,
                17200,
                17250,
                17300,
                17350,
                17400,
                17450,
                17500
            ],
            "train_perplexity": [
                31.520041303560557,
                26.96949127037433,
                33.82153317322274,
                27.266978258799362,
                25.34972875582275,
                29.36318095626117,
                29.923526852338217,
                21.4831453945766,
                30.283077851771797,
                26.00493146553328,
                24.135542471392522,
                27.1813394938451,
                29.02675019175899,
                27.863108995337786,
                32.70999575539541,
                29.49532201930163,
                29.58837124765891,
                24.89313253049645,
                28.61577840030622,
                29.62206112482525,
                30.815202561214353,
                23.30667598552466,
                25.517228768213123,
                25.568237402138845,
                28.79536271466506,
                25.563385495323466,
                28.34228906513997,
                27.07040591986597,
                23.75962801164826,
                26.07723763882263,
                36.737643057773816,
                26.598672714764085,
                25.03561030485636,
                25.336103554570652,
                27.66734419332106,
                27.888869468087165,
                19.76467306916567,
                24.37562081901233,
                28.967039230736898,
                24.1296334693148,
                28.310851171827835,
                28.008799261131,
                23.239674831118823,
                23.008902860831547,
                24.34126364713645,
                24.222722699622203,
                23.733714670404357,
                24.63494407849705,
                23.787310681542433,
                24.735785163150116,
                25.17313522973981,
                29.81098110623889,
                25.246727886631408,
                26.364599760273933,
                20.453412314900586,
                26.470936897611782,
                25.11053104249587,
                27.033359038153634,
                22.093581761045233,
                23.585692058484593,
                24.043281257406587,
                23.148122709203378,
                23.731196747126347,
                21.18105931388812,
                25.109627049989577,
                24.341623460942312,
                21.939666263784297,
                20.91210392488608,
                19.741088143565623,
                25.584049058297797
            ],
            "train_lr": [
                0.0009857142857142857,
                0.0009714285714285714,
                0.0009571428571428573,
                0.0009428571428571429,
                0.0009285714285714287,
                0.0009142857142857143,
                0.0009000000000000001,
                0.0008857142857142857,
                0.0008714285714285715,
                0.0008571428571428572,
                0.0008428571428571429,
                0.0008285714285714285,
                0.0008142857142857143,
                0.0008,
                0.0007857142857142857,
                0.0007714285714285715,
                0.0007571428571428572,
                0.0007428571428571429,
                0.0007285714285714287,
                0.0007142857142857143,
                0.0007,
                0.0006857142857142857,
                0.0006714285714285715,
                0.0006571428571428571,
                0.0006428571428571428,
                0.0006285714285714285,
                0.0006142857142857143,
                0.0006,
                0.0005857142857142857,
                0.0005714285714285714,
                0.0005571428571428572,
                0.0005428571428571429,
                0.0005285714285714286,
                0.0005142857142857142,
                0.0005,
                0.00048571428571428577,
                0.0004714285714285714,
                0.0004571428571428572,
                0.00044285714285714284,
                0.0004285714285714286,
                0.00041428571428571426,
                0.0004,
                0.00038571428571428567,
                0.00037142857142857143,
                0.0003571428571428571,
                0.00034285714285714285,
                0.0003285714285714286,
                0.00031428571428571427,
                0.00030000000000000003,
                0.0002857142857142857,
                0.00027142857142857144,
                0.0002571428571428571,
                0.00024285714285714289,
                0.00022857142857142854,
                0.0002142857142857143,
                0.00019999999999999996,
                0.00018571428571428572,
                0.00017142857142857137,
                0.00015714285714285713,
                0.0001428571428571429,
                0.00012857142857142855,
                0.00011428571428571432,
                9.999999999999998e-05,
                8.571428571428574e-05,
                7.14285714285714e-05,
                5.714285714285716e-05,
                4.2857142857142816e-05,
                2.857142857142858e-05,
                1.4285714285714235e-05,
                0
            ],
            "train_loss": [
                3.4506258964538574,
                3.294708490371704,
                3.5211000442504883,
                3.305678606033325,
                3.2327702045440674,
                3.379743814468384,
                3.3986473083496094,
                3.0672707557678223,
                3.4105913639068604,
                3.2582883834838867,
                3.183687686920166,
                3.302532911300659,
                3.368220090866089,
                3.327305793762207,
                3.487683057785034,
                3.3842339515686035,
                3.3873836994171143,
                3.2145941257476807,
                3.3539605140686035,
                3.388521671295166,
                3.4280104637145996,
                3.1487419605255127,
                3.23935604095459,
                3.2413530349731445,
                3.3602166175842285,
                3.2411632537841797,
                3.3443572521209717,
                3.29844331741333,
                3.16798996925354,
                3.2610650062561035,
                3.603804349899292,
                3.2808635234832764,
                3.220301389694214,
                3.2322325706481934,
                3.3202550411224365,
                3.3282299041748047,
                2.983898162841797,
                3.1935856342315674,
                3.3661608695983887,
                3.1834428310394287,
                3.343247413635254,
                3.3325209617614746,
                3.1458630561828613,
                3.135883331298828,
                3.1921751499176025,
                3.187293291091919,
                3.166898727416992,
                3.2041680812835693,
                3.169154405593872,
                3.2082531452178955,
                3.2257795333862305,
                3.394879102706909,
                3.22869873046875,
                3.272024393081665,
                3.0181517601013184,
                3.2760496139526367,
                3.2232894897460938,
                3.2970738410949707,
                3.0952892303466797,
                3.160642385482788,
                3.1798577308654785,
                3.141915798187256,
                3.166792631149292,
                3.0531094074249268,
                3.2232534885406494,
                3.192189931869507,
                3.0882983207702637,
                3.040330171585083,
                2.9827041625976562,
                3.241971254348755
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}