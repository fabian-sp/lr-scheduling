{
    "summary": {
        "val/loss": 3.088505744934082,
        "iter": 15000,
        "val/acc": 0.439948707818985,
        "final-val/loss": 3.1226985454559326,
        "val/perplexity": 21.944217549659093,
        "train/perplexity": 26.02048585250408,
        "_wandb": {
            "runtime": 1101
        },
        "_timestamp": 1715263406.044892,
        "iter_dt": 0.313103615,
        "_runtime": 1101.342127084732,
        "parameters": 123587328,
        "final-val/perplexity": 22.707526762394885,
        "optimized_parameters": 123587328,
        "lr": 0,
        "_step": 76,
        "train/loss": 3.2588863372802734,
        "final-val/acc": 0.43471527099609375
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 15000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_iter30000_bs50x2_ws2_seed0_data_seed1337/ckpts/12000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            15000,
            25000,
            30000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_iter15000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                15000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1226985454559326
            ],
            "final_val_perplexity": [
                22.707526762394885
            ]
        },
        "val": {
            "iter": [
                12000,
                12200,
                12400,
                12600,
                12800,
                13000,
                13200,
                13400,
                13600,
                13800,
                14000,
                14200,
                14400,
                14600,
                14800
            ],
            "val_perplexity": [
                25.23584736470853,
                25.07590326631523,
                24.746644782623438,
                24.506902550196404,
                24.25716123643994,
                23.98400158912652,
                23.734218287117802,
                23.477149310381716,
                23.190751563877534,
                22.950816423052277,
                22.72190519761254,
                22.485829001087122,
                22.266757577065356,
                22.096874204362315,
                21.944217549659093
            ],
            "val_loss": [
                3.2282676696777344,
                3.221909523010254,
                3.2086920738220215,
                3.1989569664001465,
                3.188714027404785,
                3.177389144897461,
                3.1669199466705322,
                3.15602970123291,
                3.1437556743621826,
                3.1333556175231934,
                3.1233315467834473,
                3.112887382507324,
                3.1030969619750977,
                3.095438241958618,
                3.088505744934082
            ],
            "val_acc": [
                0.42387327551841736,
                0.4243078827857971,
                0.42594724893569946,
                0.4270641803741455,
                0.4281579554080963,
                0.42952024936676025,
                0.4311169385910034,
                0.432159423828125,
                0.4333813190460205,
                0.4344860911369324,
                0.4358239769935608,
                0.4370153546333313,
                0.4384423494338989,
                0.4391760230064392,
                0.439948707818985
            ]
        },
        "train": {
            "iter": [
                12050,
                12100,
                12150,
                12200,
                12250,
                12300,
                12350,
                12400,
                12450,
                12500,
                12550,
                12600,
                12650,
                12700,
                12750,
                12800,
                12850,
                12900,
                12950,
                13000,
                13050,
                13100,
                13150,
                13200,
                13250,
                13300,
                13350,
                13400,
                13450,
                13500,
                13550,
                13600,
                13650,
                13700,
                13750,
                13800,
                13850,
                13900,
                13950,
                14000,
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000
            ],
            "train_perplexity": [
                21.81993115905597,
                19.352486667601287,
                26.291101893222347,
                26.931722063968756,
                25.136940779825867,
                27.867653231477707,
                22.191558209449735,
                19.864120249896324,
                28.84871461614359,
                26.528626862387974,
                33.03421502729846,
                33.42488667026528,
                33.796964015654865,
                25.0222195620796,
                27.229811677982415,
                26.05441772668568,
                20.735552292622543,
                25.22205486312771,
                35.86629366722814,
                23.380480536942606,
                24.01652030268275,
                24.123150766710584,
                22.833923491042967,
                28.15463374587871,
                30.62546003485821,
                23.09245399225042,
                25.41374120454202,
                24.604808364986884,
                26.19942548905262,
                29.468457085744493,
                27.913542333080215,
                27.27490406834565,
                31.05449005065336,
                28.375493717456774,
                20.932006854801923,
                24.924720721015387,
                34.86143160379156,
                29.785319914157217,
                30.32697139610434,
                25.062000997442556,
                27.399391532647694,
                23.57254291210155,
                29.351205161745575,
                23.728266107717392,
                22.212837727807333,
                25.620404729032295,
                26.02303572406357,
                18.548167526768026,
                26.61068009851746,
                22.678883695101597,
                20.993471022722684,
                23.56576039306794,
                25.31711904399743,
                24.3179567288722,
                28.070008106625043,
                25.651209450214957,
                25.61725300069177,
                22.006964389568896,
                25.083120423256144,
                26.02048585250408
            ],
            "train_lr": [
                0.0004916666666666666,
                0.00048333333333333334,
                0.000475,
                0.00046666666666666666,
                0.0004583333333333333,
                0.00045000000000000004,
                0.00044166666666666665,
                0.00043333333333333337,
                0.000425,
                0.0004166666666666667,
                0.00040833333333333336,
                0.0004,
                0.0003916666666666667,
                0.0003833333333333333,
                0.000375,
                0.0003666666666666667,
                0.00035833333333333333,
                0.00035,
                0.00034166666666666666,
                0.0003333333333333334,
                0.00032500000000000004,
                0.00031666666666666665,
                0.00030833333333333337,
                0.0003,
                0.00029166666666666664,
                0.00028333333333333335,
                0.000275,
                0.0002666666666666667,
                0.0002583333333333333,
                0.00025,
                0.00024166666666666664,
                0.00023333333333333333,
                0.000225,
                0.00021666666666666668,
                0.00020833333333333332,
                0.0002,
                0.00019166666666666665,
                0.00018333333333333336,
                0.000175,
                0.0001666666666666667,
                0.00015833333333333332,
                0.00015000000000000001,
                0.00014166666666666668,
                0.00013333333333333337,
                0.000125,
                0.00011666666666666664,
                0.00010833333333333334,
                9.999999999999998e-05,
                9.166666666666668e-05,
                8.333333333333332e-05,
                7.500000000000001e-05,
                6.666666666666666e-05,
                5.8333333333333346e-05,
                4.999999999999999e-05,
                4.1666666666666686e-05,
                3.333333333333333e-05,
                2.500000000000002e-05,
                1.6666666666666664e-05,
                8.333333333333359e-06,
                0
            ],
            "train_loss": [
                3.0828258991241455,
                2.962822914123535,
                3.269232749938965,
                3.293307065963745,
                3.2243406772613525,
                3.3274688720703125,
                3.0997140407562256,
                2.988917112350464,
                3.362067699432373,
                3.278226613998413,
                3.4975461959838867,
                3.509303092956543,
                3.5203733444213867,
                3.21976637840271,
                3.304314613342285,
                3.2601895332336426,
                3.0318517684936523,
                3.2277209758758545,
                3.5798003673553467,
                3.1519036293029785,
                3.178744077682495,
                3.1831741333007812,
                3.128249406814575,
                3.337714195251465,
                3.4218339920043945,
                3.139508008956909,
                3.2352921962738037,
                3.202944040298462,
                3.265739679336548,
                3.3833227157592773,
                3.3291141986846924,
                3.30596923828125,
                3.4357457160949707,
                3.3455281257629395,
                3.0412814617156982,
                3.215862274169922,
                3.5513834953308105,
                3.3940179347991943,
                3.4120397567749023,
                3.2213549613952637,
                3.31052303314209,
                3.1600847244262695,
                3.379335880279541,
                3.1666691303253174,
                3.100672483444214,
                3.243391275405884,
                3.258984327316284,
                2.92037296295166,
                3.2813148498535156,
                3.121436357498169,
                3.0442135334014893,
                3.159796953201294,
                3.231482982635498,
                3.1912171840667725,
                3.3347039222717285,
                3.2445929050445557,
                3.2432682514190674,
                3.0913610458374023,
                3.2221972942352295,
                3.2588863372802734
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}