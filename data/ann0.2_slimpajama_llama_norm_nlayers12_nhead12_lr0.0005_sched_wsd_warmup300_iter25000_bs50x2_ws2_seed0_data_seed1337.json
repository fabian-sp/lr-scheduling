{
    "summary": {
        "_step": 126,
        "iter_dt": 0.309037647,
        "final-val/loss": 3.049663782119751,
        "val/perplexity": 20.384905611018272,
        "_runtime": 1740.6962387561798,
        "_timestamp": 1715264045.4453866,
        "parameters": 123587328,
        "val/loss": 3.014796733856201,
        "train/loss": 3.110633373260498,
        "optimized_parameters": 123587328,
        "lr": 0,
        "iter": 25000,
        "_wandb": {
            "runtime": 1740
        },
        "val/acc": 0.4484912157058716,
        "final-val/acc": 0.4429991841316223,
        "train/perplexity": 22.435202845994898,
        "final-val/perplexity": 21.108202958864258
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_iter30000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            15000,
            25000,
            30000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.049663782119751
            ],
            "final_val_perplexity": [
                21.108202958864258
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                23.478739021488853,
                23.37601034589897,
                23.29234955588982,
                23.196928393615288,
                22.993383435235714,
                22.87577738123711,
                22.69893112820063,
                22.559180130018895,
                22.4073627211045,
                22.287344016355995,
                22.1464253749683,
                21.994260149343738,
                21.85611172064544,
                21.708120027445688,
                21.581769394550605,
                21.441768980674954,
                21.295100299558765,
                21.16807985887415,
                21.026200683558272,
                20.886756378157173,
                20.775263764795312,
                20.655435998535328,
                20.551811598516636,
                20.47059445601692,
                20.384905611018272
            ],
            "val_loss": [
                3.156097412109375,
                3.151712417602539,
                3.1481270790100098,
                3.144021987915039,
                3.1352086067199707,
                3.1300806999206543,
                3.1223199367523193,
                3.1161441802978516,
                3.109391689300537,
                3.1040210723876953,
                3.0976781845092773,
                3.0907835960388184,
                3.0844826698303223,
                3.077688455581665,
                3.0718510150909424,
                3.065342903137207,
                3.058479070663452,
                3.0524964332580566,
                3.045771360397339,
                3.0391173362731934,
                3.0337650775909424,
                3.0279805660247803,
                3.022951126098633,
                3.018991470336914,
                3.014796733856201
            ],
            "val_acc": [
                0.43104612827301025,
                0.4316967725753784,
                0.4322460889816284,
                0.43254271149635315,
                0.4336511194705963,
                0.4344775080680847,
                0.43523070216178894,
                0.4357922077178955,
                0.4369470179080963,
                0.43698975443840027,
                0.4383227527141571,
                0.43886473774909973,
                0.4399072229862213,
                0.4406518340110779,
                0.44126951694488525,
                0.44203367829322815,
                0.4430297613143921,
                0.4435998201370239,
                0.4443310499191284,
                0.4451647996902466,
                0.44596678018569946,
                0.4467785358428955,
                0.4474121034145355,
                0.44777587056159973,
                0.4484912157058716
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                22.813147649765,
                21.597813852016312,
                24.480115831854654,
                25.09252916458565,
                19.949979006749203,
                29.476587084165878,
                26.593124381717235,
                19.04664091506425,
                25.700016466295164,
                25.036541478469793,
                24.43176729417448,
                28.92495536135415,
                22.355916486576053,
                27.722009759292078,
                25.374714217109002,
                23.90919256354151,
                26.416420521353412,
                25.020716236219734,
                25.570681990426547,
                28.05703452858606,
                33.56666208634635,
                25.009676717677106,
                24.7348474837045,
                23.611668960402362,
                26.274051426570725,
                20.09224966724375,
                19.989148661232772,
                25.55745596028558,
                22.29063344762267,
                25.10176189284418,
                23.605398578290398,
                26.869305151679963,
                26.824026330524145,
                23.15710928552607,
                21.187711148460274,
                27.00236871379407,
                27.61061398792806,
                24.748013633453716,
                20.49534411791312,
                26.326974654321283,
                30.413499178081953,
                25.854847507341407,
                23.250553901394802,
                24.145960106777025,
                24.799530313203782,
                26.633479218458536,
                27.65773490114667,
                32.431999387159564,
                23.24915147353753,
                25.043514442946428,
                20.086142883418667,
                31.63831513327286,
                20.515050936796918,
                24.15915263360582,
                20.43730680155473,
                21.948811643645634,
                28.450768737378034,
                19.60830588461391,
                26.586410861471506,
                23.716304028166935,
                25.98819670491691,
                26.671389749112386,
                24.897934393442185,
                23.04918150939007,
                27.392056495132678,
                20.708295622364286,
                25.56647573653821,
                19.923284701221633,
                22.857028739549847,
                28.54074044919025,
                25.735530635162807,
                22.985107035484965,
                22.04593058939899,
                25.0079475748584,
                22.574401107157552,
                19.23909914981581,
                22.803696496407692,
                23.516543134193697,
                18.382709452051376,
                24.901656622744813,
                21.58750223317679,
                22.31260377181889,
                25.5001147604139,
                18.713120427096307,
                23.134323957631857,
                23.197852018025447,
                22.373496610500002,
                22.52222232644757,
                26.791653474081052,
                29.50886216519466,
                17.323354089709444,
                22.963958209714463,
                26.516163387001967,
                23.631447892149698,
                24.279923624359906,
                20.59912580719153,
                28.210901068687765,
                22.765388246249323,
                22.05639282138154,
                22.435202845994894
            ],
            "train_lr": [
                0.000495,
                0.00049,
                0.00048499999999999997,
                0.00048,
                0.000475,
                0.00047,
                0.00046499999999999997,
                0.00046,
                0.000455,
                0.00045000000000000004,
                0.00044500000000000003,
                0.00044,
                0.000435,
                0.00043,
                0.000425,
                0.00042,
                0.000415,
                0.00041000000000000005,
                0.00040500000000000003,
                0.0004,
                0.000395,
                0.00039000000000000005,
                0.00038500000000000003,
                0.00038,
                0.000375,
                0.00037,
                0.000365,
                0.00035999999999999997,
                0.000355,
                0.00035,
                0.000345,
                0.00033999999999999997,
                0.00033499999999999996,
                0.00032999999999999994,
                0.00032500000000000004,
                0.00032,
                0.000315,
                0.00031,
                0.000305,
                0.0003,
                0.00029500000000000007,
                0.00029000000000000006,
                0.00028500000000000004,
                0.00028000000000000003,
                0.000275,
                0.00027,
                0.00026500000000000004,
                0.00026000000000000003,
                0.000255,
                0.00025,
                0.000245,
                0.00024,
                0.000235,
                0.00022999999999999998,
                0.000225,
                0.00021999999999999998,
                0.00021500000000000002,
                0.00021000000000000004,
                0.00020500000000000002,
                0.0002,
                0.00019500000000000002,
                0.00019,
                0.000185,
                0.00017999999999999998,
                0.000175,
                0.00016999999999999999,
                0.00016499999999999997,
                0.00015999999999999999,
                0.00015500000000000003,
                0.00015000000000000001,
                0.00014500000000000003,
                0.00014000000000000001,
                0.000135,
                0.00013000000000000002,
                0.000125,
                0.00012,
                0.00011499999999999999,
                0.00010999999999999999,
                0.00010499999999999999,
                9.999999999999998e-05,
                9.499999999999998e-05,
                9.000000000000003e-05,
                8.500000000000002e-05,
                8.000000000000002e-05,
                7.500000000000001e-05,
                7.000000000000001e-05,
                6.500000000000001e-05,
                6e-05,
                5.4999999999999995e-05,
                4.999999999999999e-05,
                4.499999999999998e-05,
                3.999999999999998e-05,
                3.4999999999999977e-05,
                3.0000000000000028e-05,
                2.500000000000002e-05,
                2.000000000000002e-05,
                1.5000000000000014e-05,
                1.000000000000001e-05,
                5.000000000000005e-06,
                0
            ],
            "train_loss": [
                3.1273391246795654,
                3.072594165802002,
                3.1978633403778076,
                3.2225723266601562,
                2.993230104446411,
                3.383598566055298,
                3.2806549072265625,
                2.946892738342285,
                3.2464938163757324,
                3.2203385829925537,
                3.1958863735198975,
                3.3647069931030273,
                3.107093095779419,
                3.3222289085388184,
                3.233755350112915,
                3.174265146255493,
                3.2739880084991455,
                3.2197062969207764,
                3.2414486408233643,
                3.3342416286468506,
                3.513535737991333,
                3.2192649841308594,
                3.2082152366638184,
                3.1617431640625,
                3.2685840129852295,
                3.000336170196533,
                2.9951915740966797,
                3.240931272506714,
                3.104168653488159,
                3.22294020652771,
                3.161477565765381,
                3.2909867763519287,
                3.2893002033233643,
                3.142303943634033,
                3.0534234046936035,
                3.295926809310913,
                3.318202495574951,
                3.208747386932373,
                3.020199775695801,
                3.2705962657928467,
                3.414888858795166,
                3.252500295639038,
                3.1463310718536377,
                3.18411922454834,
                3.210826873779297,
                3.2821712493896484,
                3.3199076652526855,
                3.4791479110717773,
                3.146270751953125,
                3.2206170558929443,
                3.0000321865081787,
                3.454371213912964,
                3.021160840988159,
                3.1846654415130615,
                3.017364025115967,
                3.088715076446533,
                3.348177433013916,
                2.9759552478790283,
                3.280402421951294,
                3.1661648750305176,
                3.2576446533203125,
                3.2835936546325684,
                3.214787006378174,
                3.137632369995117,
                3.310255289077759,
                3.030536413192749,
                3.241284132003784,
                2.9918911457061768,
                3.129260778427124,
                3.351334810256958,
                3.2478747367858887,
                3.1348485946655273,
                3.093130111694336,
                3.21919584274292,
                3.11681866645813,
                2.956946611404419,
                3.126924753189087,
                3.1577062606811523,
                2.911412477493286,
                3.2149364948272705,
                3.0721166133880615,
                3.105153799057007,
                3.238685131072998,
                2.929226875305176,
                3.141319513320923,
                3.144061803817749,
                3.107879161834717,
                3.11450457572937,
                3.288092613220215,
                3.384692907333374,
                2.852057456970215,
                3.133928060531616,
                3.277756690979004,
                3.1625804901123047,
                3.1896519660949707,
                3.0252506732940674,
                3.3397107124328613,
                3.1252434253692627,
                3.093604564666748,
                3.110633373260498
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}