{
    "summary": {
        "final-val/loss": 3.0100998878479004,
        "val/perplexity": 19.592963926132946,
        "_step": 126,
        "_wandb": {
            "runtime": 1972
        },
        "iter_dt": 0.355728933,
        "parameters": 151905024,
        "_runtime": 1972.4846909046173,
        "optimized_parameters": 151905024,
        "final-val/perplexity": 20.28938541015927,
        "iter": 25000,
        "_timestamp": 1715423679.249197,
        "train/loss": 3.072432279586792,
        "final-val/acc": 0.4475542604923248,
        "lr": 0,
        "val/acc": 0.4529187083244324,
        "val/loss": 2.975172519683838,
        "train/perplexity": 21.59431774901974
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 16,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl166_slimpajama_llama_norm_nlayers16_nhead12_lr0.0005_sched_wsd_warmup300_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            25000,
            37500,
            50000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers16_nhead12_lr0.0005_sched_wsd_warmup300_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.0100998878479004
            ],
            "final_val_perplexity": [
                20.28938541015927
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                22.702281306387786,
                22.577679076313707,
                22.50632821827836,
                22.36497409672465,
                22.184765764122705,
                22.03525266734395,
                21.87674097986193,
                21.733997990993625,
                21.595774818890018,
                21.475156595331967,
                21.319560786038934,
                21.184205669312323,
                21.044290472731237,
                20.88619864941174,
                20.76684007040842,
                20.614980383380455,
                20.48152007901727,
                20.36208547026066,
                20.221399171405185,
                20.095095344004385,
                19.971861121046604,
                19.850826090705052,
                19.760305284887362,
                19.675872659444728,
                19.592963926132942
            ],
            "val_loss": [
                3.122467517852783,
                3.1169638633728027,
                3.1137986183166504,
                3.1074981689453125,
                3.099407911300659,
                3.0926456451416016,
                3.085426092147827,
                3.0788798332214355,
                3.0724997520446777,
                3.066898822784424,
                3.059627056121826,
                3.053257942199707,
                3.046631336212158,
                3.039090633392334,
                3.0333595275878906,
                3.026020050048828,
                3.0195250511169434,
                3.013676643371582,
                3.0067434310913086,
                3.0004777908325195,
                2.99432635307312,
                2.9882476329803467,
                2.9836771488189697,
                2.9793951511383057,
                2.975172519683838
            ],
            "val_acc": [
                0.43486571311950684,
                0.43552857637405396,
                0.43629151582717896,
                0.43677613139152527,
                0.4377831816673279,
                0.43840205669403076,
                0.43947386741638184,
                0.4400878846645355,
                0.4414404034614563,
                0.44130492210388184,
                0.4424182176589966,
                0.44346556067466736,
                0.4440014660358429,
                0.4445556402206421,
                0.44548583030700684,
                0.44627684354782104,
                0.44703733921051025,
                0.4481188654899597,
                0.44853881001472473,
                0.44965577125549316,
                0.4504675269126892,
                0.4510485827922821,
                0.4516284167766571,
                0.45218625664711,
                0.4529187083244324
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                21.678421975313967,
                20.958198798951766,
                23.453115255704805,
                23.935868166374163,
                19.410664064018576,
                28.219578941068114,
                25.259612443074882,
                18.459357017881693,
                24.740804416554987,
                24.038833356665933,
                23.760137843082745,
                28.090628290090173,
                21.471465340059243,
                26.744305581616562,
                24.368897728641894,
                23.084362080782757,
                25.30094755015634,
                24.12802844991063,
                24.651424544128634,
                27.26481352843637,
                32.435479147529534,
                24.134972796686437,
                23.854724751047062,
                22.79286891982932,
                25.13941006228573,
                19.327352148276475,
                19.23693422858936,
                24.334433997066483,
                21.345576067855283,
                24.365034388861222,
                22.996936075547133,
                25.83594859611015,
                25.93751899849255,
                21.99413429762238,
                20.16872928058438,
                26.010524516198565,
                26.267105327372093,
                23.77713281683036,
                19.913112631691696,
                25.15514244752884,
                29.244625667335228,
                24.62389277331729,
                22.214156458412937,
                23.173617679277033,
                23.684225692269465,
                25.726058665613586,
                26.527159523091793,
                30.77126998726122,
                22.221736705305865,
                24.166146269855933,
                19.41273745595262,
                30.379379971121573,
                19.819774820080088,
                23.3248202466034,
                19.60731013888439,
                20.974304740352288,
                27.26200548567784,
                18.933095220229422,
                25.330341483456507,
                22.77785362911108,
                24.929213665368263,
                25.472291018276945,
                23.91172367150441,
                22.20003051914468,
                26.29265020469761,
                19.835535564762605,
                24.638744477203023,
                19.127953829973787,
                22.058533195898693,
                27.544095258293645,
                24.553971328024357,
                22.04736556666212,
                21.003468847263065,
                23.970304628047277,
                21.619431195813796,
                18.613998333928656,
                21.838271674460454,
                22.593224957952074,
                17.784861296886255,
                23.977146413943355,
                20.695418371017674,
                21.52709588217856,
                24.544904971917816,
                18.139852279718678,
                22.1635659801864,
                22.240446769338817,
                21.493683886373365,
                21.6958365924641,
                25.696603754893644,
                28.21069256350716,
                16.6030085988032,
                22.010296401476907,
                25.54370083766595,
                22.648143762300116,
                23.541860136802256,
                19.893277328344784,
                27.224332906419896,
                21.90153537111245,
                21.412425103029317,
                21.59431774901974
            ],
            "train_lr": [
                0.000495,
                0.00049,
                0.00048499999999999997,
                0.00048,
                0.000475,
                0.00047,
                0.00046499999999999997,
                0.00046,
                0.000455,
                0.00045000000000000004,
                0.00044500000000000003,
                0.00044,
                0.000435,
                0.00043,
                0.000425,
                0.00042,
                0.000415,
                0.00041000000000000005,
                0.00040500000000000003,
                0.0004,
                0.000395,
                0.00039000000000000005,
                0.00038500000000000003,
                0.00038,
                0.000375,
                0.00037,
                0.000365,
                0.00035999999999999997,
                0.000355,
                0.00035,
                0.000345,
                0.00033999999999999997,
                0.00033499999999999996,
                0.00032999999999999994,
                0.00032500000000000004,
                0.00032,
                0.000315,
                0.00031,
                0.000305,
                0.0003,
                0.00029500000000000007,
                0.00029000000000000006,
                0.00028500000000000004,
                0.00028000000000000003,
                0.000275,
                0.00027,
                0.00026500000000000004,
                0.00026000000000000003,
                0.000255,
                0.00025,
                0.000245,
                0.00024,
                0.000235,
                0.00022999999999999998,
                0.000225,
                0.00021999999999999998,
                0.00021500000000000002,
                0.00021000000000000004,
                0.00020500000000000002,
                0.0002,
                0.00019500000000000002,
                0.00019,
                0.000185,
                0.00017999999999999998,
                0.000175,
                0.00016999999999999999,
                0.00016499999999999997,
                0.00015999999999999999,
                0.00015500000000000003,
                0.00015000000000000001,
                0.00014500000000000003,
                0.00014000000000000001,
                0.000135,
                0.00013000000000000002,
                0.000125,
                0.00012,
                0.00011499999999999999,
                0.00010999999999999999,
                0.00010499999999999999,
                9.999999999999998e-05,
                9.499999999999998e-05,
                9.000000000000003e-05,
                8.500000000000002e-05,
                8.000000000000002e-05,
                7.500000000000001e-05,
                7.000000000000001e-05,
                6.500000000000001e-05,
                6e-05,
                5.4999999999999995e-05,
                4.999999999999999e-05,
                4.499999999999998e-05,
                3.999999999999998e-05,
                3.4999999999999977e-05,
                3.0000000000000028e-05,
                2.500000000000002e-05,
                2.000000000000002e-05,
                1.5000000000000014e-05,
                1.000000000000001e-05,
                5.000000000000005e-06,
                0
            ],
            "train_loss": [
                3.076319456100464,
                3.042531967163086,
                3.15500545501709,
                3.175380229949951,
                2.965824604034424,
                3.3400182723999023,
                3.2292089462280273,
                2.9155733585357666,
                3.208456039428711,
                3.1796727180480957,
                3.168011426925659,
                3.3354382514953613,
                3.0667269229888916,
                3.2863237857818604,
                3.193309783935547,
                3.13915753364563,
                3.230844020843506,
                3.1833763122558594,
                3.204836845397949,
                3.3055992126464844,
                3.479255199432373,
                3.183664083480835,
                3.1719844341278076,
                3.1264498233795166,
                3.2244389057159424,
                2.9615232944488525,
                2.956834077835083,
                3.19189453125,
                3.0608465671539307,
                3.1931512355804443,
                3.1353631019592285,
                3.2517690658569336,
                3.255692720413208,
                3.09077787399292,
                3.0041353702545166,
                3.2585034370422363,
                3.268319606781006,
                3.1687264442443848,
                2.991380453109741,
                3.225064516067505,
                3.3756980895996094,
                3.2037193775177,
                3.10073184967041,
                3.1430165767669678,
                3.164811372756958,
                3.247506618499756,
                3.2781713008880615,
                3.426583766937256,
                3.1010730266571045,
                3.184954881668091,
                2.9659314155578613,
                3.413766384124756,
                2.986682176589966,
                3.1495201587677,
                2.9759044647216797,
                3.043300151824951,
                3.3054962158203125,
                2.940913438796997,
                3.2320051193237305,
                3.12579083442688,
                3.2160425186157227,
                3.237593412399292,
                3.1743710041046143,
                3.100095748901367,
                3.269291639328003,
                2.9874770641326904,
                3.204322338104248,
                2.951152801513672,
                3.0937016010284424,
                3.3157904148101807,
                3.200875759124756,
                3.0931951999664307,
                3.044689655303955,
                3.1768178939819336,
                3.073594570159912,
                2.9239158630371094,
                3.0836660861968994,
                3.117652177810669,
                2.878349542617798,
                3.177103281021118,
                3.029914379119873,
                3.069314479827881,
                3.2005064487457275,
                2.898113250732422,
                3.098451852798462,
                3.101914644241333,
                3.067761182785034,
                3.077122449874878,
                3.246361017227173,
                3.339703321456909,
                2.8095858097076416,
                3.091512441635132,
                3.2403929233551025,
                3.12007999420166,
                3.1587822437286377,
                2.9903838634490967,
                3.3041133880615234,
                3.0865588188171387,
                3.0639734268188477,
                3.072432279586792
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}