{
    "summary": {
        "val/acc": 0.4589098989963531,
        "_runtime": 2872.3680276870728,
        "final-val/loss": 2.960441827774048,
        "val/loss": 2.925220489501953,
        "parameters": 151905024,
        "optimized_parameters": 151905024,
        "iter_dt": 0.355795402,
        "train/loss": 3.0200984477996826,
        "final-val/acc": 0.4533034563064575,
        "val/perplexity": 18.638298480286437,
        "final-val/perplexity": 19.3064615733344,
        "lr": 0,
        "iter": 37500,
        "_step": 189,
        "_wandb": {
            "runtime": 2872
        },
        "_timestamp": 1715424579.4734588,
        "train/perplexity": 20.49326747442303
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 16,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 37500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl166_slimpajama_llama_norm_nlayers16_nhead12_lr0.0005_sched_wsd_warmup300_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/30000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            25000,
            37500,
            50000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers16_nhead12_lr0.0005_sched_wsd_warmup300_iter37500_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                37500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                2.960441827774048
            ],
            "final_val_perplexity": [
                19.3064615733344
            ]
        },
        "val": {
            "iter": [
                30000,
                30200,
                30400,
                30600,
                30800,
                31000,
                31200,
                31400,
                31600,
                31800,
                32000,
                32200,
                32400,
                32600,
                32800,
                33000,
                33200,
                33400,
                33600,
                33800,
                34000,
                34200,
                34400,
                34600,
                34800,
                35000,
                35200,
                35400,
                35600,
                35800,
                36000,
                36200,
                36400,
                36600,
                36800,
                37000,
                37200,
                37400
            ],
            "val_perplexity": [
                21.744198137532305,
                21.630681176691315,
                21.609377162194075,
                21.448037346870294,
                21.40365120578238,
                21.285745178403292,
                21.180412929553622,
                21.12225357614876,
                21.03008614349084,
                20.897380966060656,
                20.816321777796205,
                20.772693210164817,
                20.64186323732062,
                20.54555533980564,
                20.439928444828492,
                20.36224082113231,
                20.284790435526897,
                20.222792532918287,
                20.088446479493733,
                20.020799416813254,
                19.922947448535663,
                19.864461242817118,
                19.763664670801543,
                19.711054416366864,
                19.592366005851407,
                19.497110040840145,
                19.4109417375946,
                19.331799376703767,
                19.24625613142259,
                19.151952312751384,
                19.085488462323234,
                18.990731740191254,
                18.916017442206904,
                18.854610945489426,
                18.78883403901711,
                18.724719595594333,
                18.679964806045582,
                18.638298480286437
            ],
            "val_loss": [
                3.0793490409851074,
                3.0741147994995117,
                3.073129415512085,
                3.0656352043151855,
                3.063563585281372,
                3.058039665222168,
                3.0530788898468018,
                3.0503292083740234,
                3.0459561347961426,
                3.039625883102417,
                3.0357394218444824,
                3.0336413383483887,
                3.0273232460021973,
                3.02264666557312,
                3.0174922943115234,
                3.0136842727661133,
                3.009873390197754,
                3.006812334060669,
                3.0001468658447266,
                2.9967737197875977,
                2.9918742179870605,
                2.988934278488159,
                2.983847141265869,
                2.9811816215515137,
                2.975142002105713,
                2.9702682495117188,
                2.96583890914917,
                2.9617533683776855,
                2.9573185443878174,
                2.952406644821167,
                2.948930263519287,
                2.943953037261963,
                2.9400110244750977,
                2.9367594718933105,
                2.93326473236084,
                2.9298465251922607,
                2.9274535179138184,
                2.925220489501953
            ],
            "val_acc": [
                0.4397033452987671,
                0.4400659203529358,
                0.4403308033943176,
                0.44161131978034973,
                0.44162964820861816,
                0.44230347871780396,
                0.44267332553863525,
                0.4430480897426605,
                0.4434130787849426,
                0.4444237947463989,
                0.44514036178588867,
                0.4450134336948395,
                0.44618895649909973,
                0.44652464985847473,
                0.4474218487739563,
                0.44740965962409973,
                0.44822511076927185,
                0.4482995271682739,
                0.44932985305786133,
                0.4501672089099884,
                0.4500805735588074,
                0.45090818405151367,
                0.4510485529899597,
                0.4517223834991455,
                0.45228272676467896,
                0.4526757597923279,
                0.4534008800983429,
                0.4541040062904358,
                0.4545385539531708,
                0.45505982637405396,
                0.4555993676185608,
                0.45636963844299316,
                0.4570910632610321,
                0.4570239186286926,
                0.45784056186676025,
                0.45845335721969604,
                0.4586462378501892,
                0.45890989899635315
            ]
        },
        "train": {
            "iter": [
                30050,
                30100,
                30150,
                30200,
                30250,
                30300,
                30350,
                30400,
                30450,
                30500,
                30550,
                30600,
                30650,
                30700,
                30750,
                30800,
                30850,
                30900,
                30950,
                31000,
                31050,
                31100,
                31150,
                31200,
                31250,
                31300,
                31350,
                31400,
                31450,
                31500,
                31550,
                31600,
                31650,
                31700,
                31750,
                31800,
                31850,
                31900,
                31950,
                32000,
                32050,
                32100,
                32150,
                32200,
                32250,
                32300,
                32350,
                32400,
                32450,
                32500,
                32550,
                32600,
                32650,
                32700,
                32750,
                32800,
                32850,
                32900,
                32950,
                33000,
                33050,
                33100,
                33150,
                33200,
                33250,
                33300,
                33350,
                33400,
                33450,
                33500,
                33550,
                33600,
                33650,
                33700,
                33750,
                33800,
                33850,
                33900,
                33950,
                34000,
                34050,
                34100,
                34150,
                34200,
                34250,
                34300,
                34350,
                34400,
                34450,
                34500,
                34550,
                34600,
                34650,
                34700,
                34750,
                34800,
                34850,
                34900,
                34950,
                35000,
                35050,
                35100,
                35150,
                35200,
                35250,
                35300,
                35350,
                35400,
                35450,
                35500,
                35550,
                35600,
                35650,
                35700,
                35750,
                35800,
                35850,
                35900,
                35950,
                36000,
                36050,
                36100,
                36150,
                36200,
                36250,
                36300,
                36350,
                36400,
                36450,
                36500,
                36550,
                36600,
                36650,
                36700,
                36750,
                36800,
                36850,
                36900,
                36950,
                37000,
                37050,
                37100,
                37150,
                37200,
                37250,
                37300,
                37350,
                37400,
                37450,
                37500
            ],
            "train_perplexity": [
                24.698729675279576,
                28.697362292463048,
                22.797945064935043,
                23.146930649114644,
                26.823099021971537,
                30.323414194527583,
                25.657564471211618,
                24.12831607994454,
                22.084981580359994,
                25.746792336460633,
                21.09221546330861,
                26.390264619059813,
                22.297532732976148,
                24.445401558073176,
                23.06991379055954,
                21.820248500046098,
                25.28353251843715,
                21.9276386745868,
                29.5797096968978,
                23.741632308841144,
                19.22818987659867,
                18.96958086945916,
                23.45937315199772,
                27.922714571140027,
                21.184771355804596,
                23.802072068252926,
                26.114860728597254,
                28.03818368851424,
                20.742855478852753,
                26.153872476160004,
                17.6772655342379,
                25.133477001105177,
                23.49486611748449,
                19.17177521150226,
                23.437575606201637,
                27.09441284062118,
                20.918267319779076,
                21.701087505144155,
                20.958333713542668,
                21.620348711049346,
                20.168988946469238,
                21.82997385726381,
                25.232466210992857,
                27.796432606385633,
                25.30630472140821,
                27.194550027240105,
                23.337258106918878,
                24.086094208425585,
                25.29327573997727,
                23.757702080509844,
                21.35555828023252,
                18.882331258516494,
                24.224946231819555,
                21.681730090152758,
                22.481138584032465,
                24.4483216776967,
                24.74730559770903,
                22.57889565229646,
                26.606632630496865,
                23.289567506147804,
                21.032307445023637,
                21.603993915990717,
                20.5591333984937,
                18.53273154442415,
                24.839478854502737,
                21.265470410356627,
                26.865705143737365,
                25.628774571536518,
                22.92661604519591,
                19.996427334023245,
                22.964346940177503,
                23.440475931541858,
                21.18300363566988,
                27.93438057859353,
                25.376868037041753,
                17.271325689114843,
                17.710026326639028,
                24.363082618520703,
                21.80975788444134,
                18.132527420928493,
                23.147316958160513,
                20.304289960523594,
                21.612087322806765,
                20.715006417422664,
                24.414583814005407,
                21.95062233666306,
                20.64404845475405,
                20.566139086956287,
                24.6390381954786,
                22.323011601504156,
                25.203300023925955,
                18.778421845606342,
                26.035230169411474,
                24.061235980665383,
                23.224093880314033,
                23.759458070267815,
                18.44950129628324,
                18.938508278241144,
                23.367284231957253,
                18.641458228498202,
                25.135915978962363,
                19.225535718470436,
                21.03808493028836,
                16.559475176342758,
                20.513549403786154,
                20.12685147317758,
                22.509451402252882,
                18.80352840395319,
                28.577931593746506,
                21.88478003208126,
                22.578642642157927,
                21.01676326002814,
                17.789186866103446,
                23.187251906199695,
                23.2640780889496,
                14.653603609936265,
                17.933005515558502,
                21.10089691104634,
                18.806595099537866,
                19.39263766985848,
                22.969537943666236,
                21.367180377919507,
                20.37634870628331,
                18.86768327300089,
                21.793010407621736,
                21.359570805192458,
                23.291788676802796,
                19.880390237668433,
                22.939415821462504,
                20.80777725535401,
                23.790946283795048,
                20.1102311483785,
                19.669123338150744,
                20.492031360680773,
                19.320878997102174,
                20.02423173335006,
                16.884020174985288,
                20.079635813824396,
                20.91573891138682,
                21.97668983048452,
                20.110149639502,
                17.97767651719127,
                22.112927280012237,
                19.436662264286085,
                21.766807887637977,
                19.455926316634052,
                19.10595316853259,
                24.112030116487613,
                19.01858416408368,
                20.49326747442303
            ],
            "train_lr": [
                0.0004966666666666666,
                0.0004933333333333334,
                0.00049,
                0.0004866666666666667,
                0.00048333333333333334,
                0.00048,
                0.0004766666666666667,
                0.00047333333333333336,
                0.00047,
                0.00046666666666666666,
                0.00046333333333333334,
                0.00046,
                0.0004566666666666667,
                0.0004533333333333333,
                0.00045000000000000004,
                0.00044666666666666666,
                0.00044333333333333334,
                0.00044,
                0.00043666666666666664,
                0.00043333333333333337,
                0.00043,
                0.00042666666666666667,
                0.00042333333333333334,
                0.00042,
                0.0004166666666666667,
                0.0004133333333333333,
                0.00041000000000000005,
                0.00040666666666666667,
                0.00040333333333333334,
                0.0004,
                0.0003966666666666667,
                0.0003933333333333333,
                0.00039000000000000005,
                0.00038666666666666667,
                0.0003833333333333333,
                0.00038,
                0.00037666666666666664,
                0.0003733333333333333,
                0.00037,
                0.0003666666666666667,
                0.00036333333333333335,
                0.00035999999999999997,
                0.0003566666666666667,
                0.0003533333333333333,
                0.00035,
                0.00034666666666666667,
                0.00034333333333333335,
                0.00033999999999999997,
                0.0003366666666666667,
                0.0003333333333333334,
                0.00032999999999999994,
                0.0003266666666666667,
                0.00032333333333333335,
                0.00032,
                0.00031666666666666665,
                0.0003133333333333334,
                0.00031,
                0.0003066666666666667,
                0.00030333333333333335,
                0.0003,
                0.00029666666666666665,
                0.0002933333333333333,
                0.00029000000000000006,
                0.0002866666666666666,
                0.00028333333333333335,
                0.00028000000000000003,
                0.00027666666666666665,
                0.00027333333333333333,
                0.00027,
                0.0002666666666666667,
                0.0002633333333333333,
                0.00026000000000000003,
                0.00025666666666666665,
                0.00025333333333333333,
                0.00025,
                0.0002466666666666666,
                0.00024333333333333336,
                0.00024,
                0.0002366666666666667,
                0.00023333333333333333,
                0.00022999999999999998,
                0.00022666666666666668,
                0.00022333333333333333,
                0.00021999999999999998,
                0.00021666666666666668,
                0.00021333333333333333,
                0.00021000000000000004,
                0.00020666666666666666,
                0.0002033333333333333,
                0.0002,
                0.00019666666666666666,
                0.00019333333333333336,
                0.00019,
                0.00018666666666666666,
                0.00018333333333333336,
                0.00017999999999999998,
                0.0001766666666666667,
                0.00017333333333333334,
                0.00016999999999999999,
                0.0001666666666666667,
                0.00016333333333333334,
                0.00015999999999999999,
                0.0001566666666666667,
                0.00015333333333333334,
                0.00015000000000000001,
                0.00014666666666666666,
                0.0001433333333333333,
                0.00014000000000000001,
                0.00013666666666666666,
                0.00013333333333333337,
                0.00013000000000000002,
                0.00012666666666666666,
                0.00012333333333333334,
                0.00012,
                0.00011666666666666664,
                0.00011333333333333334,
                0.00010999999999999999,
                0.0001066666666666667,
                0.00010333333333333333,
                9.999999999999998e-05,
                9.666666666666668e-05,
                9.333333333333333e-05,
                9.000000000000003e-05,
                8.666666666666667e-05,
                8.333333333333332e-05,
                8.000000000000002e-05,
                7.666666666666667e-05,
                7.33333333333333e-05,
                7.000000000000001e-05,
                6.666666666666666e-05,
                6.333333333333336e-05,
                6e-05,
                5.6666666666666644e-05,
                5.333333333333335e-05,
                4.999999999999999e-05,
                4.666666666666669e-05,
                4.3333333333333334e-05,
                3.999999999999998e-05,
                3.666666666666668e-05,
                3.333333333333333e-05,
                3.0000000000000028e-05,
                2.6666666666666673e-05,
                2.333333333333332e-05,
                2.000000000000002e-05,
                1.6666666666666664e-05,
                1.3333333333333308e-05,
                1.000000000000001e-05,
                6.666666666666654e-06,
                3.333333333333355e-06,
                0
            ],
            "train_loss": [
                3.206753969192505,
                3.3568074703216553,
                3.1266725063323975,
                3.14186429977417,
                3.2892656326293945,
                3.4119224548339844,
                3.244840621948242,
                3.1833882331848145,
                3.094899892807007,
                3.24831223487854,
                3.048906087875366,
                3.2729973793029785,
                3.104478120803833,
                3.196444272994995,
                3.138531446456909,
                3.0828404426574707,
                3.2301554679870605,
                3.08774995803833,
                3.3870909214019775,
                3.1672322750091553,
                2.9563794136047363,
                2.942838668823242,
                3.1552722454071045,
                3.3294427394866943,
                3.0532846450805664,
                3.1697747707366943,
                3.2625067234039307,
                3.3335695266723633,
                3.0322039127349854,
                3.2639994621276855,
                2.872281312942505,
                3.224202871322632,
                3.1567840576171875,
                2.9534411430358887,
                3.1543426513671875,
                3.2993297576904297,
                3.0406248569488525,
                3.077364444732666,
                3.0425384044647217,
                3.073637008666992,
                3.004148244857788,
                3.0832860469818115,
                3.2281336784362793,
                3.3249099254608154,
                3.231055736541748,
                3.303018808364868,
                3.1500532627105713,
                3.1816368103027344,
                3.2305407524108887,
                3.1679089069366455,
                3.061314105987549,
                2.9382286071777344,
                3.187385082244873,
                3.076472043991089,
                3.1126787662506104,
                3.196563720703125,
                3.208718776702881,
                3.1170177459716797,
                3.281162738800049,
                3.14800763130188,
                3.0460617542266846,
                3.072880268096924,
                3.0233073234558105,
                2.9195404052734375,
                3.2124364376068115,
                3.057086706161499,
                3.2908527851104736,
                3.243717908859253,
                3.132300615310669,
                2.9955556392669678,
                3.1339449882507324,
                3.154466390609741,
                3.053201198577881,
                3.3298604488372803,
                3.233840227127075,
                2.8490495681762695,
                2.8741328716278076,
                3.193071126937866,
                3.082359552383423,
                2.897709369659424,
                3.141880989074707,
                3.010834217071533,
                3.0732548236846924,
                3.030860424041748,
                3.1951828002929688,
                3.0887975692749023,
                3.0274291038513184,
                3.0236480236053467,
                3.204334259033203,
                3.1056201457977295,
                3.2269771099090576,
                2.9327104091644287,
                3.2594528198242188,
                3.1806042194366455,
                3.1451923847198486,
                3.167982816696167,
                2.915039300918579,
                2.94119930267334,
                3.151339054107666,
                2.9253900051116943,
                3.224299907684326,
                2.9562413692474365,
                3.0463364124298096,
                2.806960344314575,
                3.021087646484375,
                3.002056837081909,
                3.1139373779296875,
                2.934046506881714,
                3.3526370525360107,
                3.0857934951782227,
                3.117006540298462,
                3.0453224182128906,
                2.8785927295684814,
                3.1436047554016113,
                3.1469125747680664,
                2.684688091278076,
                2.8866448402404785,
                3.0493175983428955,
                2.9342095851898193,
                2.964895486831665,
                3.1341710090637207,
                3.0618581771850586,
                3.0143768787384033,
                2.937452554702759,
                3.0815913677215576,
                3.061501979827881,
                3.1481029987335205,
                2.9897358417510986,
                3.1328587532043457,
                3.0353288650512695,
                3.169307231903076,
                3.0012307167053223,
                2.9790520668029785,
                3.02003812789917,
                2.961188316345215,
                2.9969451427459717,
                2.826369524002075,
                2.9997081756591797,
                3.040503978729248,
                3.08998441696167,
                3.0012266635894775,
                2.8891327381134033,
                3.0961644649505615,
                2.9671630859375,
                3.080388307571411,
                2.968153715133667,
                2.9500019550323486,
                3.182713031768799,
                2.9454185962677,
                3.0200984477996826
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}