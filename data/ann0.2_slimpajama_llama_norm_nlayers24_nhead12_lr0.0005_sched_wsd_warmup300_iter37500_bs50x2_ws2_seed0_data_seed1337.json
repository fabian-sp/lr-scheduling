{
    "summary": {
        "final-val/acc": 0.46087127923965454,
        "val/perplexity": 17.474922805924603,
        "train/perplexity": 19.179839982522505,
        "lr": 0,
        "iter_dt": 0.490516285,
        "val/loss": 2.8607687950134277,
        "parameters": 208540416,
        "train/loss": 2.953861713409424,
        "iter": 37500,
        "_wandb": {
            "runtime": 3969
        },
        "val/acc": 0.4664709270000458,
        "final-val/loss": 2.8958678245544434,
        "_step": 189,
        "final-val/perplexity": 18.099166303685188,
        "optimized_parameters": 208540416,
        "_runtime": 3969.725138425827,
        "_timestamp": 1715425776.6077795
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 24,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 37500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl_slimpajama_llama_norm_nlayers24_nhead12_lr0.0005_sched_wsd_warmup300_iter62500_bs50x2_ws2_seed0_data_seed1337/ckpts/30000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            37500,
            50000,
            62500
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers24_nhead12_lr0.0005_sched_wsd_warmup300_iter37500_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                37500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                2.8958678245544434
            ],
            "final_val_perplexity": [
                18.099166303685188
            ]
        },
        "val": {
            "iter": [
                30000,
                30200,
                30400,
                30600,
                30800,
                31000,
                31200,
                31400,
                31600,
                31800,
                32000,
                32200,
                32400,
                32600,
                32800,
                33000,
                33200,
                33400,
                33600,
                33800,
                34000,
                34200,
                34400,
                34600,
                34800,
                35000,
                35200,
                35400,
                35600,
                35800,
                36000,
                36200,
                36400,
                36600,
                36800,
                37000,
                37200,
                37400
            ],
            "val_perplexity": [
                20.524326683893964,
                20.41549880634492,
                20.36831014205901,
                20.24318322825275,
                20.18510919964284,
                20.06750832000065,
                19.96443907326391,
                19.912329284383635,
                19.846335169144012,
                19.735704482759616,
                19.618556121807348,
                19.551377288278715,
                19.445635871971724,
                19.386595615753542,
                19.273113937565654,
                19.195622726193964,
                19.112322415114626,
                19.0175095462039,
                18.90655347377565,
                18.821774532201154,
                18.728528046130897,
                18.647441441060224,
                18.5895880417456,
                18.513136828343054,
                18.386163404392015,
                18.30277972191728,
                18.241763394658257,
                18.1506027781947,
                18.061331616340095,
                17.967653868732818,
                17.903246691737344,
                17.815098671568798,
                17.741443455690064,
                17.680237066881677,
                17.610989290660022,
                17.556832836866086,
                17.510777593598476,
                17.474922805924603
            ],
            "val_loss": [
                3.0216128826141357,
                3.01629638671875,
                3.0139822959899902,
                3.0078201293945312,
                3.0049471855163574,
                2.9991040229797363,
                2.993954658508301,
                2.9913411140441895,
                2.9880213737487793,
                2.982431411743164,
                2.976477861404419,
                2.9730477333068848,
                2.9676246643066406,
                2.9645838737487793,
                2.9587130546569824,
                2.954684257507324,
                2.9503352642059326,
                2.945362091064453,
                2.9395105838775635,
                2.935016393661499,
                2.9300498962402344,
                2.925710916519165,
                2.9226036071777344,
                2.918482542037964,
                2.911600351333618,
                2.907054901123047,
                2.9037156105041504,
                2.8987057209014893,
                2.893775224685669,
                2.8885750770568848,
                2.884984016418457,
                2.8800482749938965,
                2.8759052753448486,
                2.8724493980407715,
                2.8685250282287598,
                2.865445137023926,
                2.862818479537964,
                2.8607687950134277
            ],
            "val_acc": [
                0.44663697481155396,
                0.44724851846694946,
                0.4473901391029358,
                0.4479430913925171,
                0.4482458233833313,
                0.44872069358825684,
                0.44997066259384155,
                0.4498828053474426,
                0.45067137479782104,
                0.4513598680496216,
                0.452117919921875,
                0.45204100012779236,
                0.4529687464237213,
                0.4528186023235321,
                0.45393431186676025,
                0.4543493390083313,
                0.45476317405700684,
                0.45542967319488525,
                0.4564587473869324,
                0.4573119878768921,
                0.45744505524635315,
                0.4581286311149597,
                0.45845213532447815,
                0.45912474393844604,
                0.4596582055091858,
                0.4605126976966858,
                0.4610680937767029,
                0.4618517756462097,
                0.46226316690444946,
                0.46282958984375,
                0.4635668992996216,
                0.4639623761177063,
                0.4645092487335205,
                0.46485838294029236,
                0.46550413966178894,
                0.46592772006988525,
                0.4661828279495239,
                0.4664709270000458
            ]
        },
        "train": {
            "iter": [
                30050,
                30100,
                30150,
                30200,
                30250,
                30300,
                30350,
                30400,
                30450,
                30500,
                30550,
                30600,
                30650,
                30700,
                30750,
                30800,
                30850,
                30900,
                30950,
                31000,
                31050,
                31100,
                31150,
                31200,
                31250,
                31300,
                31350,
                31400,
                31450,
                31500,
                31550,
                31600,
                31650,
                31700,
                31750,
                31800,
                31850,
                31900,
                31950,
                32000,
                32050,
                32100,
                32150,
                32200,
                32250,
                32300,
                32350,
                32400,
                32450,
                32500,
                32550,
                32600,
                32650,
                32700,
                32750,
                32800,
                32850,
                32900,
                32950,
                33000,
                33050,
                33100,
                33150,
                33200,
                33250,
                33300,
                33350,
                33400,
                33450,
                33500,
                33550,
                33600,
                33650,
                33700,
                33750,
                33800,
                33850,
                33900,
                33950,
                34000,
                34050,
                34100,
                34150,
                34200,
                34250,
                34300,
                34350,
                34400,
                34450,
                34500,
                34550,
                34600,
                34650,
                34700,
                34750,
                34800,
                34850,
                34900,
                34950,
                35000,
                35050,
                35100,
                35150,
                35200,
                35250,
                35300,
                35350,
                35400,
                35450,
                35500,
                35550,
                35600,
                35650,
                35700,
                35750,
                35800,
                35850,
                35900,
                35950,
                36000,
                36050,
                36100,
                36150,
                36200,
                36250,
                36300,
                36350,
                36400,
                36450,
                36500,
                36550,
                36600,
                36650,
                36700,
                36750,
                36800,
                36850,
                36900,
                36950,
                37000,
                37050,
                37100,
                37150,
                37200,
                37250,
                37300,
                37350,
                37400,
                37450,
                37500
            ],
            "train_perplexity": [
                23.558979825566016,
                26.73673156826751,
                21.53134084190284,
                21.714000323108138,
                25.348580451805162,
                28.430426451326845,
                23.945366085356273,
                22.651362232798085,
                20.75107154587212,
                24.239534197674473,
                19.997566802951408,
                24.502456508963537,
                20.962631447524483,
                22.970759204615675,
                21.822907062403946,
                20.51979591647604,
                23.846536292482355,
                20.58153154510509,
                27.931010786015104,
                22.18324251046931,
                18.083215820550762,
                18.03991689882005,
                22.020836225623448,
                26.363443197304655,
                19.741803565659765,
                22.257760970340343,
                24.697434210198544,
                26.3402095494654,
                19.631966203305822,
                24.576912622813634,
                16.72562524330868,
                23.63676151406403,
                22.140533549694908,
                17.956292488823177,
                21.985672421775757,
                25.3640325205579,
                19.77020132560213,
                20.471102041252916,
                19.691082359199964,
                20.432264251304215,
                19.126380537185312,
                20.641499056904184,
                23.440012078911316,
                26.032492903537484,
                23.812487700621343,
                25.398137744705245,
                21.79310912909187,
                22.402501729976798,
                23.636158529749824,
                22.267569839065274,
                20.065269315951312,
                17.836905661282696,
                22.977096565120437,
                20.35019493763958,
                21.159976153062836,
                22.844100646570404,
                23.1822548905106,
                20.97897087562277,
                24.94631922161425,
                22.03017826436089,
                19.93179390759885,
                20.326764242962742,
                19.246526864381988,
                17.494732489773362,
                23.239303602726665,
                19.882727121648397,
                25.03257229333301,
                24.095847063742116,
                21.55604698782598,
                18.891179555810268,
                21.497107318383414,
                21.779193814763296,
                20.052715429098864,
                26.10819947603557,
                23.761843025469812,
                16.258040750116614,
                16.695843753152143,
                22.74411080400752,
                20.29592657937654,
                17.215451215124315,
                21.6380107323526,
                18.980556107282847,
                20.315993828097294,
                19.402511487534593,
                23.047857168230546,
                20.5170026048613,
                19.405125306180846,
                19.15462828009798,
                23.20248175553562,
                20.917160168431323,
                23.73832118093255,
                17.756508245398233,
                24.228746923017024,
                22.589153024362407,
                21.852808259978932,
                22.27223162791516,
                17.2181727008884,
                17.93028646630573,
                21.684847416484082,
                17.426007694476993,
                23.58399389407288,
                18.00869253424746,
                19.71940245733582,
                15.507792010003428,
                19.243723356693426,
                18.84972070803701,
                21.03126947131417,
                17.506494678363314,
                26.63246325191659,
                20.383710052386345,
                21.177994213200275,
                19.803979382040126,
                16.649133225659913,
                21.624637837980643,
                21.71201761588527,
                13.693853502449619,
                16.7620685758084,
                19.731804128550188,
                17.67773335944051,
                18.236032085994378,
                21.60021871675895,
                19.91562904667524,
                19.142739981506754,
                17.700798572831804,
                20.241252781210914,
                19.987161429253305,
                21.89237837248796,
                18.579233108680153,
                21.46481653823212,
                19.37365337547227,
                22.121744037180203,
                18.905106566886833,
                18.411395168871636,
                19.233334210526408,
                17.91564233124497,
                18.775118020501218,
                15.938109134649135,
                18.721657323852675,
                19.40703616098426,
                20.4753437983326,
                18.843178404040888,
                16.867519825772312,
                20.561324564456886,
                18.26391411987473,
                20.36408570334146,
                18.128939579266667,
                17.98203612047393,
                22.359343979323743,
                17.740233749282186,
                19.179839982522505
            ],
            "train_lr": [
                0.0004966666666666666,
                0.0004933333333333334,
                0.00049,
                0.0004866666666666667,
                0.00048333333333333334,
                0.00048,
                0.0004766666666666667,
                0.00047333333333333336,
                0.00047,
                0.00046666666666666666,
                0.00046333333333333334,
                0.00046,
                0.0004566666666666667,
                0.0004533333333333333,
                0.00045000000000000004,
                0.00044666666666666666,
                0.00044333333333333334,
                0.00044,
                0.00043666666666666664,
                0.00043333333333333337,
                0.00043,
                0.00042666666666666667,
                0.00042333333333333334,
                0.00042,
                0.0004166666666666667,
                0.0004133333333333333,
                0.00041000000000000005,
                0.00040666666666666667,
                0.00040333333333333334,
                0.0004,
                0.0003966666666666667,
                0.0003933333333333333,
                0.00039000000000000005,
                0.00038666666666666667,
                0.0003833333333333333,
                0.00038,
                0.00037666666666666664,
                0.0003733333333333333,
                0.00037,
                0.0003666666666666667,
                0.00036333333333333335,
                0.00035999999999999997,
                0.0003566666666666667,
                0.0003533333333333333,
                0.00035,
                0.00034666666666666667,
                0.00034333333333333335,
                0.00033999999999999997,
                0.0003366666666666667,
                0.0003333333333333334,
                0.00032999999999999994,
                0.0003266666666666667,
                0.00032333333333333335,
                0.00032,
                0.00031666666666666665,
                0.0003133333333333334,
                0.00031,
                0.0003066666666666667,
                0.00030333333333333335,
                0.0003,
                0.00029666666666666665,
                0.0002933333333333333,
                0.00029000000000000006,
                0.0002866666666666666,
                0.00028333333333333335,
                0.00028000000000000003,
                0.00027666666666666665,
                0.00027333333333333333,
                0.00027,
                0.0002666666666666667,
                0.0002633333333333333,
                0.00026000000000000003,
                0.00025666666666666665,
                0.00025333333333333333,
                0.00025,
                0.0002466666666666666,
                0.00024333333333333336,
                0.00024,
                0.0002366666666666667,
                0.00023333333333333333,
                0.00022999999999999998,
                0.00022666666666666668,
                0.00022333333333333333,
                0.00021999999999999998,
                0.00021666666666666668,
                0.00021333333333333333,
                0.00021000000000000004,
                0.00020666666666666666,
                0.0002033333333333333,
                0.0002,
                0.00019666666666666666,
                0.00019333333333333336,
                0.00019,
                0.00018666666666666666,
                0.00018333333333333336,
                0.00017999999999999998,
                0.0001766666666666667,
                0.00017333333333333334,
                0.00016999999999999999,
                0.0001666666666666667,
                0.00016333333333333334,
                0.00015999999999999999,
                0.0001566666666666667,
                0.00015333333333333334,
                0.00015000000000000001,
                0.00014666666666666666,
                0.0001433333333333333,
                0.00014000000000000001,
                0.00013666666666666666,
                0.00013333333333333337,
                0.00013000000000000002,
                0.00012666666666666666,
                0.00012333333333333334,
                0.00012,
                0.00011666666666666664,
                0.00011333333333333334,
                0.00010999999999999999,
                0.0001066666666666667,
                0.00010333333333333333,
                9.999999999999998e-05,
                9.666666666666668e-05,
                9.333333333333333e-05,
                9.000000000000003e-05,
                8.666666666666667e-05,
                8.333333333333332e-05,
                8.000000000000002e-05,
                7.666666666666667e-05,
                7.33333333333333e-05,
                7.000000000000001e-05,
                6.666666666666666e-05,
                6.333333333333336e-05,
                6e-05,
                5.6666666666666644e-05,
                5.333333333333335e-05,
                4.999999999999999e-05,
                4.666666666666669e-05,
                4.3333333333333334e-05,
                3.999999999999998e-05,
                3.666666666666668e-05,
                3.333333333333333e-05,
                3.0000000000000028e-05,
                2.6666666666666673e-05,
                2.333333333333332e-05,
                2.000000000000002e-05,
                1.6666666666666664e-05,
                1.3333333333333308e-05,
                1.000000000000001e-05,
                6.666666666666654e-06,
                3.333333333333355e-06,
                0
            ],
            "train_loss": [
                3.1595091819763184,
                3.2860405445098877,
                3.069511651992798,
                3.0779592990875244,
                3.232724905014038,
                3.3474621772766113,
                3.175776958465576,
                3.1202220916748047,
                3.032599925994873,
                3.1879870891571045,
                2.995612621307373,
                3.19877552986145,
                3.042743444442749,
                3.1342241764068604,
                3.0829622745513916,
                3.0213921070098877,
                3.1716411113739014,
                3.0243961811065674,
                3.329739809036255,
                3.099339246749878,
                2.894986152648926,
                2.8925888538360596,
                3.0919911861419678,
                3.2719805240631104,
                2.9827404022216797,
                3.1026928424835205,
                3.2067015171051025,
                3.2710988521575928,
                2.977161169052124,
                3.2018096446990967,
                2.816943883895874,
                3.1628053188323975,
                3.097412109375,
                2.8879425525665283,
                3.09039306640625,
                3.2333343029022217,
                2.984177827835083,
                3.0190162658691406,
                2.980167865753174,
                3.0171172618865967,
                2.951070547103882,
                3.0273056030273438,
                3.154446601867676,
                3.259347677230835,
                3.1702122688293457,
                3.234678030014038,
                3.0815958976745605,
                3.1091747283935547,
                3.1627798080444336,
                3.1031334400177,
                2.998992443084717,
                2.8812716007232666,
                3.134500026702881,
                3.013092517852783,
                3.0521135330200195,
                3.128695011138916,
                3.1433892250061035,
                3.043522596359253,
                3.216728448867798,
                3.0924153327941895,
                2.9923181533813477,
                3.0119404792785645,
                2.9573326110839844,
                2.8619017601013184,
                3.1458470821380615,
                2.9898533821105957,
                3.220180034637451,
                3.182041645050049,
                3.0706584453582764,
                2.938697099685669,
                3.067920446395874,
                3.0809571743011475,
                2.998366594314575,
                3.262251615524292,
                3.1680831909179688,
                2.7885894775390625,
                2.81516170501709,
                3.1243083477020264,
                3.0104222297668457,
                2.8458092212677,
                3.074453592300415,
                2.9434170722961426,
                3.0114104747772217,
                2.965404510498047,
                3.1375749111175537,
                3.0212559700012207,
                2.9655392169952393,
                2.9525463581085205,
                3.144261360168457,
                3.040571928024292,
                3.167092800140381,
                2.87675404548645,
                3.187541961669922,
                3.117471933364868,
                3.084331512451172,
                3.1033427715301514,
                2.8459672927856445,
                2.88649320602417,
                3.076615810394287,
                2.8579657077789307,
                3.1605703830718994,
                2.8908565044403076,
                2.981605052947998,
                2.741344451904297,
                2.9571869373321533,
                2.936500072479248,
                3.0460124015808105,
                2.8625738620758057,
                3.282133102416992,
                3.014738082885742,
                3.052964687347412,
                2.98588490486145,
                2.8123600482940674,
                3.0738353729248047,
                3.0778679847717285,
                2.6169488430023193,
                2.819120407104492,
                2.982233762741089,
                2.872307777404785,
                2.9034013748168945,
                3.0727055072784424,
                2.991506814956665,
                2.95192551612854,
                2.8736116886138916,
                3.0077247619628906,
                2.9950921535491943,
                3.0861406326293945,
                2.922046422958374,
                3.0664172172546387,
                2.963916063308716,
                3.0965631008148193,
                2.939434051513672,
                2.9129717350006104,
                2.9566469192504883,
                2.885676145553589,
                2.9325344562530518,
                2.7687149047851562,
                2.929682970046997,
                2.965637683868408,
                3.01922345161438,
                2.936152935028076,
                2.8253917694091797,
                3.023413896560669,
                2.9049291610717773,
                3.013774871826172,
                2.8975114822387695,
                2.8893752098083496,
                3.1072463989257812,
                2.8758370876312256,
                2.953861713409424
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}