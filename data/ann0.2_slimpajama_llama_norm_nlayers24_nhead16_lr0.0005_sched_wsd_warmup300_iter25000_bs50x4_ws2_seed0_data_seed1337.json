{
    "summary": {
        "_runtime": 7847.366733551025,
        "parameters": 359842816,
        "_wandb": {
            "runtime": 7847
        },
        "final-val/acc": 0.47299355268478394,
        "final-val/loss": 2.781151056289673,
        "val/perplexity": 15.621277387124584,
        "optimized_parameters": 359842816,
        "iter": 25000,
        "_step": 126,
        "iter_dt": 1.506003562,
        "val/acc": 0.47838133573532104,
        "_timestamp": 1715456368.7507436,
        "train/perplexity": 16.592292540561346,
        "final-val/perplexity": 16.137555341522525,
        "lr": 0,
        "train/loss": 2.8089401721954346,
        "val/loss": 2.748635768890381
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 1024,
        "n_head": 16,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 24,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 4,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl_slimpajama_llama_norm_nlayers24_nhead16_lr0.0005_sched_wsd_warmup300_iter50000_bs50x4_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            25000,
            37500,
            50000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers24_nhead16_lr0.0005_sched_wsd_warmup300_iter25000_bs50x4_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                2.781151056289673
            ],
            "final_val_perplexity": [
                16.137555341522525
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                17.873230434265075,
                17.788423453920043,
                17.686443068831856,
                17.5686409659101,
                17.48260723235053,
                17.399765733462612,
                17.280494349501094,
                17.15004773468084,
                17.08382961750288,
                16.993021748077926,
                16.873895151229,
                16.774477948810453,
                16.66878172935754,
                16.56113740307989,
                16.46271114913054,
                16.35459994625821,
                16.273242621005565,
                16.18541585207733,
                16.079727537308905,
                15.993486627189634,
                15.904962584614704,
                15.815209019137175,
                15.7408164163188,
                15.674163808047595,
                15.621277387124584
            ],
            "val_loss": [
                2.8833060264587402,
                2.878549814224243,
                2.872800350189209,
                2.866117477416992,
                2.861208438873291,
                2.8564586639404297,
                2.8495802879333496,
                2.8420028686523438,
                2.838134288787842,
                2.8328046798706055,
                2.8257696628570557,
                2.8198604583740234,
                2.813539505004883,
                2.807060718536377,
                2.8010997772216797,
                2.794511079788208,
                2.7895240783691406,
                2.7841124534606934,
                2.7775611877441406,
                2.772183418273926,
                2.7666330337524414,
                2.7609739303588867,
                2.756258964538574,
                2.7520155906677246,
                2.748635768890381
            ],
            "val_acc": [
                0.4607226550579071,
                0.4608776867389679,
                0.46208858489990234,
                0.4627428948879242,
                0.4635375738143921,
                0.4639208912849426,
                0.46501588821411133,
                0.4658837914466858,
                0.46672970056533813,
                0.4674707055091858,
                0.4680529534816742,
                0.468963623046875,
                0.46959227323532104,
                0.47046995162963867,
                0.47126585245132446,
                0.4722924828529358,
                0.4724975824356079,
                0.4735449254512787,
                0.47437620162963867,
                0.4752856492996216,
                0.47590452432632446,
                0.47663694620132446,
                0.4772350788116455,
                0.47810304164886475,
                0.47838133573532104
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                18.547672244206314,
                20.022632458419938,
                22.84331092433985,
                17.53355808435372,
                23.696064249852736,
                12.732738817169958,
                25.681487892853728,
                20.276923353990004,
                21.23531469675676,
                17.54653442665941,
                25.004823495824194,
                19.087199463838157,
                20.187299006743093,
                21.35541062554832,
                17.57365135059538,
                16.17077794499112,
                20.883111491826032,
                22.90403566704648,
                16.242117303811423,
                17.953368728163564,
                15.773406519780535,
                20.655770876524365,
                23.610559983460934,
                21.8796150843545,
                20.703867392424844,
                15.942285814532289,
                18.83733448882807,
                17.518845342716453,
                18.974561012990915,
                19.435735474726147,
                15.744937640543665,
                15.027629149920052,
                23.14767016064447,
                26.01679487526992,
                17.297963683400454,
                20.039777608916616,
                18.880265001515696,
                14.184080395032652,
                19.06804591455846,
                21.574093686766044,
                19.834060122648324,
                17.60774392952385,
                23.70143195697602,
                21.1624230846396,
                17.60159072158365,
                17.061755471519934,
                20.145003205837696,
                17.115388595460264,
                15.35614494333004,
                18.831011986255135,
                23.29935890667663,
                18.163542100360747,
                17.231946811797656,
                17.866422162172523,
                19.86018031186043,
                17.437661315495653,
                17.172035497846093,
                14.86171579267041,
                15.513549842079948,
                18.993480277391402,
                18.186681820198324,
                16.644465795037895,
                22.083502033867607,
                16.78004195959379,
                16.11759153006246,
                20.76972681898085,
                14.301395448192913,
                18.25187802357544,
                18.227920884546855,
                13.87099185828354,
                18.869122816941925,
                17.393880114564087,
                14.295269500769836,
                11.924137903372884,
                17.205143846601437,
                18.28891271246423,
                18.537367177320487,
                21.073727744623746,
                16.549434296323174,
                18.402955872603066,
                16.835474601853317,
                19.937340387792684,
                18.54438690993613,
                12.394084232550899,
                20.559437304656523,
                15.410249877453833,
                14.049855488705223,
                18.637516403092516,
                15.453661466700023,
                20.625447055451986,
                19.447726909578755,
                17.409857627695565,
                15.95176816425874,
                14.848519294015318,
                19.283179758316603,
                19.278132402184323,
                19.24151203975466,
                17.564984622164356,
                14.92448655886736,
                16.592292540561346
            ],
            "train_lr": [
                0.000495,
                0.00049,
                0.00048499999999999997,
                0.00048,
                0.000475,
                0.00047,
                0.00046499999999999997,
                0.00046,
                0.000455,
                0.00045000000000000004,
                0.00044500000000000003,
                0.00044,
                0.000435,
                0.00043,
                0.000425,
                0.00042,
                0.000415,
                0.00041000000000000005,
                0.00040500000000000003,
                0.0004,
                0.000395,
                0.00039000000000000005,
                0.00038500000000000003,
                0.00038,
                0.000375,
                0.00037,
                0.000365,
                0.00035999999999999997,
                0.000355,
                0.00035,
                0.000345,
                0.00033999999999999997,
                0.00033499999999999996,
                0.00032999999999999994,
                0.00032500000000000004,
                0.00032,
                0.000315,
                0.00031,
                0.000305,
                0.0003,
                0.00029500000000000007,
                0.00029000000000000006,
                0.00028500000000000004,
                0.00028000000000000003,
                0.000275,
                0.00027,
                0.00026500000000000004,
                0.00026000000000000003,
                0.000255,
                0.00025,
                0.000245,
                0.00024,
                0.000235,
                0.00022999999999999998,
                0.000225,
                0.00021999999999999998,
                0.00021500000000000002,
                0.00021000000000000004,
                0.00020500000000000002,
                0.0002,
                0.00019500000000000002,
                0.00019,
                0.000185,
                0.00017999999999999998,
                0.000175,
                0.00016999999999999999,
                0.00016499999999999997,
                0.00015999999999999999,
                0.00015500000000000003,
                0.00015000000000000001,
                0.00014500000000000003,
                0.00014000000000000001,
                0.000135,
                0.00013000000000000002,
                0.000125,
                0.00012,
                0.00011499999999999999,
                0.00010999999999999999,
                0.00010499999999999999,
                9.999999999999998e-05,
                9.499999999999998e-05,
                9.000000000000003e-05,
                8.500000000000002e-05,
                8.000000000000002e-05,
                7.500000000000001e-05,
                7.000000000000001e-05,
                6.500000000000001e-05,
                6e-05,
                5.4999999999999995e-05,
                4.999999999999999e-05,
                4.499999999999998e-05,
                3.999999999999998e-05,
                3.4999999999999977e-05,
                3.0000000000000028e-05,
                2.500000000000002e-05,
                2.000000000000002e-05,
                1.5000000000000014e-05,
                1.000000000000001e-05,
                5.000000000000005e-06,
                0
            ],
            "train_loss": [
                2.920346260070801,
                2.9968652725219727,
                3.1286604404449463,
                2.8641185760498047,
                3.165311098098755,
                2.5441782474517822,
                3.24577260017395,
                3.0094854831695557,
                3.0556676387786865,
                2.864858388900757,
                3.2190709114074707,
                2.9490199089050293,
                3.0050556659698486,
                3.061307191848755,
                2.8664026260375977,
                2.783207654953003,
                3.038942813873291,
                3.131315231323242,
                2.787609577178955,
                2.887779712677002,
                2.7583272457122803,
                3.027996778488159,
                3.161696195602417,
                3.085557460784912,
                3.030322551727295,
                2.768976926803589,
                2.935842752456665,
                2.863279104232788,
                2.943101167678833,
                2.9671154022216797,
                2.7565207481384277,
                2.7098922729492188,
                3.1418962478637695,
                3.258744478225708,
                2.850590705871582,
                2.9977211952209473,
                2.9381191730499268,
                2.6521220207214355,
                2.9480159282684326,
                3.071495294570923,
                2.9874026775360107,
                2.8683407306671143,
                3.1655375957489014,
                3.052229166030884,
                2.8679912090301514,
                2.836841344833374,
                3.002958297729492,
                2.839979887008667,
                2.7315175533294678,
                2.93550705909729,
                3.148427963256836,
                2.899418354034424,
                2.846766948699951,
                2.882925033569336,
                2.9887187480926514,
                2.8586342334747314,
                2.8432841300964355,
                2.6987903118133545,
                2.741715669631958,
                2.9440977573394775,
                2.900691509246826,
                2.812079668045044,
                3.0948328971862793,
                2.8201920986175537,
                2.7799131870269775,
                3.033498525619507,
                2.6603589057922363,
                2.9042699337005615,
                2.902956485748291,
                2.6298015117645264,
                2.9375288486480713,
                2.8561203479766846,
                2.659930467605591,
                2.4785664081573486,
                2.845210313796997,
                2.906296968460083,
                2.919790506362915,
                3.0480291843414307,
                2.806353807449341,
                2.912513256072998,
                2.8234901428222656,
                2.992596387863159,
                2.9201691150665283,
                2.517220973968506,
                3.023322105407715,
                2.735034704208374,
                2.6426138877868652,
                2.9251785278320312,
                2.7378478050231934,
                3.0265276432037354,
                2.9677321910858154,
                2.8570384979248047,
                2.769571542739868,
                2.697901964187622,
                2.959235191345215,
                2.9589734077453613,
                2.9570720195770264,
                2.8659093379974365,
                2.703005075454712,
                2.8089401721954346
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}