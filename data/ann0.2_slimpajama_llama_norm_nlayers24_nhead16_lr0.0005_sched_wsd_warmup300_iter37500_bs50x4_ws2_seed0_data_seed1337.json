{
    "summary": {
        "final-val/loss": 2.735850095748902,
        "final-val/perplexity": 15.422820380630236,
        "lr": 0,
        "parameters": 359842816,
        "train/loss": 2.8460097312927246,
        "val/loss": 2.7023651599884033,
        "_timestamp": 1715459897.097462,
        "final-val/acc": 0.4785003662109375,
        "val/perplexity": 14.91493921058739,
        "train/perplexity": 17.21890342944635,
        "iter": 37500,
        "_wandb": {
            "runtime": 11374
        },
        "val/acc": 0.48396116495132446,
        "optimized_parameters": 359842816,
        "_step": 189,
        "iter_dt": 1.465267933,
        "_runtime": 11373.754055976868
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 1024,
        "n_head": 16,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 24,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 4,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 37500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl_slimpajama_llama_norm_nlayers24_nhead16_lr0.0005_sched_wsd_warmup300_iter50000_bs50x4_ws2_seed0_data_seed1337/ckpts/30000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            25000,
            37500,
            50000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers24_nhead16_lr0.0005_sched_wsd_warmup300_iter37500_bs50x4_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                37500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                2.7358500957489014
            ],
            "final_val_perplexity": [
                15.422820380630235
            ]
        },
        "val": {
            "iter": [
                30000,
                30200,
                30400,
                30600,
                30800,
                31000,
                31200,
                31400,
                31600,
                31800,
                32000,
                32200,
                32400,
                32600,
                32800,
                33000,
                33200,
                33400,
                33600,
                33800,
                34000,
                34200,
                34400,
                34600,
                34800,
                35000,
                35200,
                35400,
                35600,
                35800,
                36000,
                36200,
                36400,
                36600,
                36800,
                37000,
                37200,
                37400
            ],
            "val_perplexity": [
                17.129190746974203,
                17.09391758951259,
                17.014443097079205,
                16.989760644288037,
                16.882776353232728,
                16.833062428449864,
                16.786828469725,
                16.713323736016623,
                16.644969782764377,
                16.55514469465186,
                16.526852750127976,
                16.42464726469557,
                16.37943353115787,
                16.32795478749597,
                16.268765900632335,
                16.18323957809299,
                16.149567827858775,
                16.045865638101,
                15.994905178842028,
                15.92287866191842,
                15.852106200492626,
                15.782442237704029,
                15.733436191601983,
                15.674145123011982,
                15.586641675008822,
                15.530006754882926,
                15.459963139371604,
                15.418956249028863,
                15.358865446816365,
                15.286254965582945,
                15.226394534526897,
                15.172265887032761,
                15.121188292077468,
                15.060512768958313,
                15.013136294068167,
                14.975417419786725,
                14.937971383394478,
                14.91493921058739
            ],
            "val_loss": [
                2.8407859802246094,
                2.8387246131896973,
                2.834064483642578,
                2.8326127529144287,
                2.826295852661133,
                2.8233468532562256,
                2.82059645652771,
                2.8162081241607666,
                2.81210994720459,
                2.806698799133301,
                2.804988384246826,
                2.7987849712371826,
                2.7960283756256104,
                2.7928805351257324,
                2.7892489433288574,
                2.78397798538208,
                2.781895160675049,
                2.7754530906677246,
                2.7722721099853516,
                2.767758846282959,
                2.7633042335510254,
                2.7588999271392822,
                2.7557899951934814,
                2.752014398574829,
                2.7464160919189453,
                2.7427759170532227,
                2.738255500793457,
                2.7355995178222656,
                2.7316946983337402,
                2.7269558906555176,
                2.723032236099243,
                2.719470977783203,
                2.7160987854003906,
                2.712078094482422,
                2.7089273929595947,
                2.706411838531494,
                2.7039082050323486,
                2.7023651599884033
            ],
            "val_acc": [
                0.46586668491363525,
                0.4667675495147705,
                0.4669238030910492,
                0.4668847322463989,
                0.4678124785423279,
                0.4679040312767029,
                0.4680725038051605,
                0.4690502882003784,
                0.4698132276535034,
                0.470458984375,
                0.47041624784469604,
                0.4716442823410034,
                0.4714636206626892,
                0.4724157452583313,
                0.47239622473716736,
                0.47304201126098633,
                0.4731457531452179,
                0.4744213819503784,
                0.475128173828125,
                0.4754015803337097,
                0.47575804591178894,
                0.4763476252555847,
                0.4769311547279358,
                0.4774414002895355,
                0.47792965173721313,
                0.47871214151382446,
                0.4792150855064392,
                0.47960567474365234,
                0.480010986328125,
                0.48044553399086,
                0.4811694324016571,
                0.48189085721969604,
                0.48222166299819946,
                0.48253294825553894,
                0.4830273389816284,
                0.48362672328948975,
                0.48380979895591736,
                0.48396116495132446
            ]
        },
        "train": {
            "iter": [
                30050,
                30100,
                30150,
                30200,
                30250,
                30300,
                30350,
                30400,
                30450,
                30500,
                30550,
                30600,
                30650,
                30700,
                30750,
                30800,
                30850,
                30900,
                30950,
                31000,
                31050,
                31100,
                31150,
                31200,
                31250,
                31300,
                31350,
                31400,
                31450,
                31500,
                31550,
                31600,
                31650,
                31700,
                31750,
                31800,
                31850,
                31900,
                31950,
                32000,
                32050,
                32100,
                32150,
                32200,
                32250,
                32300,
                32350,
                32400,
                32450,
                32500,
                32550,
                32600,
                32650,
                32700,
                32750,
                32800,
                32850,
                32900,
                32950,
                33000,
                33050,
                33100,
                33150,
                33200,
                33250,
                33300,
                33350,
                33400,
                33450,
                33500,
                33550,
                33600,
                33650,
                33700,
                33750,
                33800,
                33850,
                33900,
                33950,
                34000,
                34050,
                34100,
                34150,
                34200,
                34250,
                34300,
                34350,
                34400,
                34450,
                34500,
                34550,
                34600,
                34650,
                34700,
                34750,
                34800,
                34850,
                34900,
                34950,
                35000,
                35050,
                35100,
                35150,
                35200,
                35250,
                35300,
                35350,
                35400,
                35450,
                35500,
                35550,
                35600,
                35650,
                35700,
                35750,
                35800,
                35850,
                35900,
                35950,
                36000,
                36050,
                36100,
                36150,
                36200,
                36250,
                36300,
                36350,
                36400,
                36450,
                36500,
                36550,
                36600,
                36650,
                36700,
                36750,
                36800,
                36850,
                36900,
                36950,
                37000,
                37050,
                37100,
                37150,
                37200,
                37250,
                37300,
                37350,
                37400,
                37450,
                37500
            ],
            "train_perplexity": [
                17.542924509187355,
                19.17712391554314,
                20.538708463466815,
                19.406976010144117,
                16.086388058864948,
                20.975614954342902,
                14.109873395336098,
                16.62573780356132,
                19.66552214623339,
                17.9191495095775,
                17.680974758749752,
                16.207179238285956,
                22.30900260138286,
                15.040002285968479,
                16.734691735326464,
                16.172505261503723,
                21.51547913695357,
                17.724696782517622,
                17.505735050362656,
                15.936703219313687,
                18.25887671196387,
                19.19176962416454,
                17.153527730764175,
                17.023418566860407,
                19.45686798561278,
                14.799293715423248,
                15.440292744338517,
                15.6125758881254,
                19.780333404739057,
                17.359340735451426,
                17.903874166906654,
                19.89840034550604,
                17.660583651111473,
                14.68220637125369,
                21.38607850344548,
                18.00933658636354,
                20.03248793279762,
                15.890824577626713,
                17.810286963293933,
                19.461210457780858,
                15.142545966265246,
                15.171412217006255,
                16.743795078237817,
                16.203203577328047,
                23.893122861185123,
                17.67382676682583,
                16.852152531009775,
                18.75740904766724,
                19.958770849082452,
                14.443811084984034,
                18.14924401352,
                21.26331573559551,
                13.046716086232998,
                17.66362397206646,
                13.962249216411161,
                16.720079276294065,
                13.610556664296764,
                18.543683932839492,
                18.125036986763618,
                20.08552991274955,
                20.82244701403994,
                14.589203130742652,
                17.745889623848523,
                17.72070376235956,
                16.83651824488068,
                19.975685099701945,
                19.532186371562883,
                20.27118090957722,
                19.07059648838003,
                17.67702108995765,
                19.722472755427873,
                20.584760615049163,
                17.16855993362728,
                20.636130602041135,
                19.520212668700502,
                16.952886943940534,
                19.713272694996643,
                17.999545188070286,
                21.07301932108812,
                16.854374556036344,
                16.396777706763412,
                16.23033780355463,
                16.547544418750707,
                19.575668981694832,
                16.537636944567115,
                15.7493903754495,
                19.31799096667733,
                15.580618971969646,
                16.10648986350462,
                12.624685087771724,
                15.041171306620045,
                17.112777195412903,
                18.581053776379036,
                16.528657508855524,
                16.10460449269311,
                16.29670151144948,
                14.688417586639725,
                15.940400662450209,
                18.424309555893398,
                14.913339098125677,
                16.42710274161859,
                20.198299762629233,
                17.086131073808282,
                14.642466470122125,
                19.646940541502325,
                16.206043235626947,
                18.955755501117654,
                16.074778988077167,
                14.509365032006693,
                15.389637348561847,
                13.20829197199974,
                16.526033186780996,
                21.13532586912043,
                12.963853275558199,
                16.526762123336173,
                16.82623716860729,
                17.430906752129754,
                15.172775941623392,
                18.293971491806605,
                20.021424732459746,
                15.07591757928614,
                19.481673936720806,
                15.92819058202316,
                16.10635162107949,
                16.706841781914033,
                16.46216558128583,
                15.221969899233777,
                15.789630869957533,
                15.64703420385607,
                13.758781903505627,
                18.525446796562278,
                15.493035543637685,
                17.470469552285778,
                17.944814219705833,
                12.220276321472442,
                19.214744083474237,
                17.811624598165988,
                13.744696747246458,
                15.060329644186034,
                17.26276278401369,
                16.084861685386077,
                12.290126254095041,
                17.645444585087866,
                14.660606635551357,
                15.971602739413607,
                14.341980812700271,
                13.945651420185028,
                13.76624015301725,
                16.54791922073582,
                17.21890342944635
            ],
            "train_lr": [
                0.0004966666666666666,
                0.0004933333333333334,
                0.00049,
                0.0004866666666666667,
                0.00048333333333333334,
                0.00048,
                0.0004766666666666667,
                0.00047333333333333336,
                0.00047,
                0.00046666666666666666,
                0.00046333333333333334,
                0.00046,
                0.0004566666666666667,
                0.0004533333333333333,
                0.00045000000000000004,
                0.00044666666666666666,
                0.00044333333333333334,
                0.00044,
                0.00043666666666666664,
                0.00043333333333333337,
                0.00043,
                0.00042666666666666667,
                0.00042333333333333334,
                0.00042,
                0.0004166666666666667,
                0.0004133333333333333,
                0.00041000000000000005,
                0.00040666666666666667,
                0.00040333333333333334,
                0.0004,
                0.0003966666666666667,
                0.0003933333333333333,
                0.00039000000000000005,
                0.00038666666666666667,
                0.0003833333333333333,
                0.00038,
                0.00037666666666666664,
                0.0003733333333333333,
                0.00037,
                0.0003666666666666667,
                0.00036333333333333335,
                0.00035999999999999997,
                0.0003566666666666667,
                0.0003533333333333333,
                0.00035,
                0.00034666666666666667,
                0.00034333333333333335,
                0.00033999999999999997,
                0.0003366666666666667,
                0.0003333333333333334,
                0.00032999999999999994,
                0.0003266666666666667,
                0.00032333333333333335,
                0.00032,
                0.00031666666666666665,
                0.0003133333333333334,
                0.00031,
                0.0003066666666666667,
                0.00030333333333333335,
                0.0003,
                0.00029666666666666665,
                0.0002933333333333333,
                0.00029000000000000006,
                0.0002866666666666666,
                0.00028333333333333335,
                0.00028000000000000003,
                0.00027666666666666665,
                0.00027333333333333333,
                0.00027,
                0.0002666666666666667,
                0.0002633333333333333,
                0.00026000000000000003,
                0.00025666666666666665,
                0.00025333333333333333,
                0.00025,
                0.0002466666666666666,
                0.00024333333333333336,
                0.00024,
                0.0002366666666666667,
                0.00023333333333333333,
                0.00022999999999999998,
                0.00022666666666666668,
                0.00022333333333333333,
                0.00021999999999999998,
                0.00021666666666666668,
                0.00021333333333333333,
                0.00021000000000000004,
                0.00020666666666666666,
                0.0002033333333333333,
                0.0002,
                0.00019666666666666666,
                0.00019333333333333336,
                0.00019,
                0.00018666666666666666,
                0.00018333333333333336,
                0.00017999999999999998,
                0.0001766666666666667,
                0.00017333333333333334,
                0.00016999999999999999,
                0.0001666666666666667,
                0.00016333333333333334,
                0.00015999999999999999,
                0.0001566666666666667,
                0.00015333333333333334,
                0.00015000000000000001,
                0.00014666666666666666,
                0.0001433333333333333,
                0.00014000000000000001,
                0.00013666666666666666,
                0.00013333333333333337,
                0.00013000000000000002,
                0.00012666666666666666,
                0.00012333333333333334,
                0.00012,
                0.00011666666666666664,
                0.00011333333333333334,
                0.00010999999999999999,
                0.0001066666666666667,
                0.00010333333333333333,
                9.999999999999998e-05,
                9.666666666666668e-05,
                9.333333333333333e-05,
                9.000000000000003e-05,
                8.666666666666667e-05,
                8.333333333333332e-05,
                8.000000000000002e-05,
                7.666666666666667e-05,
                7.33333333333333e-05,
                7.000000000000001e-05,
                6.666666666666666e-05,
                6.333333333333336e-05,
                6e-05,
                5.6666666666666644e-05,
                5.333333333333335e-05,
                4.999999999999999e-05,
                4.666666666666669e-05,
                4.3333333333333334e-05,
                3.999999999999998e-05,
                3.666666666666668e-05,
                3.333333333333333e-05,
                3.0000000000000028e-05,
                2.6666666666666673e-05,
                2.333333333333332e-05,
                2.000000000000002e-05,
                1.6666666666666664e-05,
                1.3333333333333308e-05,
                1.000000000000001e-05,
                6.666666666666654e-06,
                3.333333333333355e-06,
                0
            ],
            "train_loss": [
                2.864652633666992,
                2.9537200927734375,
                3.022313356399536,
                2.96563458442688,
                2.77797532081604,
                3.043362617492676,
                2.646876573562622,
                2.8109538555145264,
                2.9788689613342285,
                2.8858718872070312,
                2.8724911212921143,
                2.7854561805725098,
                3.104992389678955,
                2.7107152938842773,
                2.817485809326172,
                2.7833144664764404,
                3.068774700164795,
                2.8749608993530273,
                2.862530469894409,
                2.7686266899108887,
                2.904653310775757,
                2.9544835090637207,
                2.842205762863159,
                2.834591865539551,
                2.9682021141052246,
                2.6945812702178955,
                2.7369823455810547,
                2.7480785846710205,
                2.9846901893615723,
                2.854132652282715,
                2.885019063949585,
                2.9906413555145264,
                2.8713371753692627,
                2.686638116836548,
                3.062742233276367,
                2.890892267227173,
                2.9973573684692383,
                2.7657437324523926,
                2.8797781467437744,
                2.9684252738952637,
                2.717510223388672,
                2.719414710998535,
                2.8180296421051025,
                2.7852108478546143,
                3.1735928058624268,
                2.872086763381958,
                2.8244802951812744,
                2.9315907955169678,
                2.993670701980591,
                2.6702678203582764,
                2.8986308574676514,
                3.056985378265381,
                2.568538188934326,
                2.871509313583374,
                2.6363589763641357,
                2.8166122436523438,
                2.6108474731445312,
                2.920131206512451,
                2.897296190261841,
                3.0000016689300537,
                3.0360336303710938,
                2.680283546447754,
                2.8761558532714844,
                2.8747355937957764,
                2.823552131652832,
                2.9945178031921387,
                2.9720656871795654,
                3.009202241897583,
                2.9481496810913086,
                2.872267484664917,
                2.9817607402801514,
                3.024553060531616,
                2.8430817127227783,
                3.027045488357544,
                2.971452474594116,
                2.830440044403076,
                2.9812941551208496,
                2.890348434448242,
                3.0479955673217773,
                2.8246121406555176,
                2.797086715698242,
                2.786884069442749,
                2.806239604949951,
                2.9742894172668457,
                2.805640697479248,
                2.756803512573242,
                2.961038827896118,
                2.7460296154022217,
                2.779224157333374,
                2.5356557369232178,
                2.7107930183410645,
                2.839827299118042,
                2.9221444129943848,
                2.8050975799560547,
                2.779107093811035,
                2.7909646034240723,
                2.687061071395874,
                2.7688586711883545,
                2.913672924041748,
                2.7022578716278076,
                2.7989344596862793,
                3.0056004524230957,
                2.838268995285034,
                2.6839277744293213,
                2.977923631668091,
                2.785386085510254,
                2.9421095848083496,
                2.7772533893585205,
                2.6747961044311523,
                2.733696222305298,
                2.5808465480804443,
                2.804938793182373,
                3.050947904586792,
                2.562166690826416,
                2.804982900619507,
                2.822941303253174,
                2.8582468032836914,
                2.7195045948028564,
                2.906573534011841,
                2.99680495262146,
                2.7131004333496094,
                2.9694762229919434,
                2.768092393875122,
                2.7792155742645264,
                2.8158202171325684,
                2.8010666370391846,
                2.7227416038513184,
                2.759355306625366,
                2.7502832412719727,
                2.6216790676116943,
                2.919147253036499,
                2.7403924465179443,
                2.860513925552368,
                2.887303113937378,
                2.503098249435425,
                2.9556798934936523,
                2.8798532485961914,
                2.620654821395874,
                2.7120659351348877,
                2.8485536575317383,
                2.7778804302215576,
                2.5087978839874268,
                2.8704795837402344,
                2.6851658821105957,
                2.7708141803741455,
                2.6631927490234375,
                2.635169506072998,
                2.622220993041992,
                2.806262254714966,
                2.8460097312927246
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}