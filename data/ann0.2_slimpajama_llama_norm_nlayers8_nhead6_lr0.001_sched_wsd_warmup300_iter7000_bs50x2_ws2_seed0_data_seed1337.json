{
    "summary": {
        "iter_dt": 0.129106444,
        "train/loss": 3.663374662399292,
        "final-val/acc": 0.3964453041553498,
        "val/perplexity": 32.12694677990367,
        "final-val/perplexity": 33.03549883458974,
        "_timestamp": 1715257498.800656,
        "train/perplexity": 38.99261223135891,
        "iter": 7000,
        "_wandb": {
            "runtime": 465
        },
        "val/acc": 0.40080446004867554,
        "parameters": 33479040,
        "final-val/loss": 3.4975850582122803,
        "optimized_parameters": 33479040,
        "lr": 0,
        "_step": 76,
        "_runtime": 465.17833518981934,
        "val/loss": 3.4696974754333496
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 384,
        "n_head": 6,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 8,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 7000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl_slimpajama_llama_norm_nlayers8_nhead6_lr0.001_sched_wsd_warmup300_iter10000_bs50x2_ws2_seed0_data_seed1337/ckpts/4000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            3000,
            7000,
            10000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers8_nhead6_lr0.001_sched_wsd_warmup300_iter7000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                7000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.4975850582122803
            ],
            "final_val_perplexity": [
                33.03549883458974
            ]
        },
        "val": {
            "iter": [
                4000,
                4200,
                4400,
                4600,
                4800,
                5000,
                5200,
                5400,
                5600,
                5800,
                6000,
                6200,
                6400,
                6600,
                6800
            ],
            "val_perplexity": [
                39.015683812085584,
                38.619561748845626,
                38.31888509715911,
                37.98509537622993,
                37.65080196503464,
                37.39718113277838,
                37.191233815342514,
                36.99336126461815,
                36.736057725511984,
                36.03180632706999,
                35.132490838889346,
                34.29204991152629,
                33.51507499233728,
                32.76873338781343,
                32.12694677990367
            ],
            "val_loss": [
                3.663966178894043,
                3.653761386871338,
                3.6459453105926514,
                3.6371963024139404,
                3.628356695175171,
                3.6215977668762207,
                3.6160755157470703,
                3.610740900039673,
                3.6037611961364746,
                3.584404468536377,
                3.559128761291504,
                3.5349159240722656,
                3.511997699737549,
                3.4894771575927734,
                3.4696974754333496
            ],
            "val_acc": [
                0.3807946741580963,
                0.3819226026535034,
                0.3826013207435608,
                0.3831518292427063,
                0.38432741165161133,
                0.3850353956222534,
                0.38599973917007446,
                0.38539549708366394,
                0.38633909821510315,
                0.38820311427116394,
                0.3909631073474884,
                0.394378662109375,
                0.3963037133216858,
                0.3986254930496216,
                0.40080446004867554
            ]
        },
        "train": {
            "iter": [
                4050,
                4100,
                4150,
                4200,
                4250,
                4300,
                4350,
                4400,
                4450,
                4500,
                4550,
                4600,
                4650,
                4700,
                4750,
                4800,
                4850,
                4900,
                4950,
                5000,
                5050,
                5100,
                5150,
                5200,
                5250,
                5300,
                5350,
                5400,
                5450,
                5500,
                5550,
                5600,
                5650,
                5700,
                5750,
                5800,
                5850,
                5900,
                5950,
                6000,
                6050,
                6100,
                6150,
                6200,
                6250,
                6300,
                6350,
                6400,
                6450,
                6500,
                6550,
                6600,
                6650,
                6700,
                6750,
                6800,
                6850,
                6900,
                6950,
                7000
            ],
            "train_perplexity": [
                43.9715969995435,
                38.55970344328377,
                44.472007938166186,
                49.673379940558235,
                33.95715316722907,
                43.117542578730585,
                48.46574410929303,
                37.10427868309781,
                34.20026815599996,
                46.04702168002668,
                52.74408706967934,
                46.64976341968536,
                43.47648511846383,
                45.63983029434355,
                40.119508907239826,
                49.644443960778034,
                44.083820544383514,
                40.268735508617716,
                38.56842891335696,
                41.58475888556093,
                42.41817030410712,
                48.67917364960809,
                48.265158921069315,
                33.128245860190354,
                41.20894031058776,
                41.106524571793564,
                52.62711705632756,
                42.369573546030196,
                37.841850231226815,
                44.98086976686824,
                36.45486876221911,
                49.96748104696867,
                35.702222251245864,
                39.620671936062315,
                38.83574244394314,
                45.23153759842588,
                38.58389871788786,
                44.35788666756471,
                53.938635994516964,
                32.39401696866912,
                36.46293537785415,
                38.41994271847036,
                35.891785253239576,
                33.652426617489354,
                40.97653998023868,
                36.18870287101997,
                37.71747661155413,
                51.3661237149288,
                37.69414818466015,
                43.73019486253119,
                32.731956367262704,
                40.46733632072702,
                39.64027785361507,
                48.01678217227677,
                46.27109750632092,
                30.16619489306414,
                41.58429290326629,
                33.54099856504874,
                34.448564864924776,
                38.99261223135891
            ],
            "train_lr": [
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.0009642857142857143,
                0.0009285714285714287,
                0.0008928571428571429,
                0.0008571428571428572,
                0.0008214285714285714,
                0.0007857142857142857,
                0.00075,
                0.0007142857142857143,
                0.0006785714285714287,
                0.0006428571428571428,
                0.0006071428571428572,
                0.0005714285714285714,
                0.0005357142857142857,
                0.0005,
                0.00046428571428571433,
                0.0004285714285714286,
                0.00039285714285714293,
                0.0003571428571428571,
                0.0003214285714285714,
                0.0002857142857142857,
                0.00025,
                0.0002142857142857143,
                0.0001785714285714286,
                0.0001428571428571429,
                0.0001071428571428571,
                7.14285714285714e-05,
                3.57142857142857e-05,
                0
            ],
            "train_loss": [
                3.7835464477539062,
                3.652210235595703,
                3.7948625087738037,
                3.9054718017578125,
                3.525101900100708,
                3.763932466506958,
                3.880859851837158,
                3.613734722137451,
                3.532235860824585,
                3.8296656608581543,
                3.965454339981079,
                3.842670440673828,
                3.7722227573394775,
                3.8207833766937256,
                3.6918652057647705,
                3.9048891067504883,
                3.786095380783081,
                3.69557785987854,
                3.6524364948272705,
                3.727736234664917,
                3.747579336166382,
                3.88525390625,
                3.8767125606536865,
                3.5003886222839355,
                3.7186577320098877,
                3.7161693572998047,
                3.9632341861724854,
                3.7464330196380615,
                3.633418083190918,
                3.8062398433685303,
                3.5960774421691895,
                3.911375045776367,
                3.5752153396606445,
                3.6793534755706787,
                3.6593434810638428,
                3.8117971420288086,
                3.6528375148773193,
                3.792293071746826,
                3.987849712371826,
                3.477976083755493,
                3.5962986946105957,
                3.6485791206359863,
                3.5805108547210693,
                3.516087532043457,
                3.7130022048950195,
                3.588749408721924,
                3.6301259994506836,
                3.938981533050537,
                3.629507303237915,
                3.778041362762451,
                3.488354206085205,
                3.700497627258301,
                3.6798481941223145,
                3.8715531826019287,
                3.834520101547241,
                3.406724214553833,
                3.727725028991699,
                3.512770891189575,
                3.5394697189331055,
                3.663374662399292
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}