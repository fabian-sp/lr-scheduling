{
    "summary": {
        "final-val/perplexity": 33.79672228195782,
        "_runtime": 611.5179975032806,
        "final-val/acc": 0.3940005898475647,
        "_step": 43,
        "_wandb": {
            "runtime": 611
        },
        "lr": 0,
        "iter": 3650,
        "parameters": 53027328,
        "train/loss": 3.530893087387085,
        "final-val/loss": 3.5203661918640137,
        "optimized_parameters": 53027328,
        "val/acc": 0.39930784702301025,
        "val/loss": 3.483654260635376,
        "val/perplexity": 32.578479011227365,
        "train/perplexity": 34.1543757936524,
        "iter_dt": 0.179364573,
        "_timestamp": 1715380101.9110694
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 512,
        "n_head": 8,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 8,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 3650,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl53_slimpajama_llama_norm_nlayers8_nhead8_lr0.001_sched_wsd_warmup300_iter11250_bs50x2_ws2_seed0_data_seed1337/ckpts/2000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            3650,
            7500,
            11250
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers8_nhead8_lr0.001_sched_wsd_warmup300_iter3650_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                3650
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.5203661918640137
            ],
            "final_val_perplexity": [
                33.79672228195782
            ]
        },
        "val": {
            "iter": [
                2000,
                2200,
                2400,
                2600,
                2800,
                3000,
                3200,
                3400,
                3600
            ],
            "val_perplexity": [
                42.281225517585284,
                41.02637548696184,
                40.0279404010863,
                39.24657162752177,
                38.50274682029579,
                37.47033849694189,
                35.57672011993492,
                33.925116182829385,
                32.578479011227365
            ],
            "val_loss": [
                3.7443456649780273,
                3.7142176628112793,
                3.689580202102661,
                3.6698665618896484,
                3.6507320404052734,
                3.623552083969116,
                3.5716938972473145,
                3.524158000946045,
                3.483654260635376
            ],
            "val_acc": [
                0.3733483850955963,
                0.3755773901939392,
                0.37788695096969604,
                0.37919431924819946,
                0.3815588355064392,
                0.3842736482620239,
                0.389739990234375,
                0.39483642578125,
                0.39930784702301025
            ]
        },
        "train": {
            "iter": [
                2050,
                2100,
                2150,
                2200,
                2250,
                2300,
                2350,
                2400,
                2450,
                2500,
                2550,
                2600,
                2650,
                2700,
                2750,
                2800,
                2850,
                2900,
                2950,
                3000,
                3050,
                3100,
                3150,
                3200,
                3250,
                3300,
                3350,
                3400,
                3450,
                3500,
                3550,
                3600,
                3650
            ],
            "train_perplexity": [
                54.15453563651169,
                54.892697244796736,
                43.74385516559045,
                48.96541537115162,
                43.72253236225592,
                34.27672360688488,
                47.39569975978299,
                46.90502331559287,
                55.5466936363208,
                43.95078142169939,
                47.83097384658256,
                40.840714671061804,
                46.14135726423144,
                39.89660060490969,
                55.92186784445987,
                38.73187349179768,
                45.49885174350507,
                40.93249317719133,
                43.49902576277981,
                39.79602315603131,
                45.425460786111564,
                41.58641465212388,
                46.302041245352264,
                44.491203411566694,
                41.89497722985522,
                39.21646266008868,
                43.01016808636946,
                31.574760066928125,
                47.35421299902023,
                35.9352310777755,
                28.83675614046663,
                34.773539287888156,
                34.1543757936524
            ],
            "train_lr": [
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.0009589041095890412,
                0.0008904109589041097,
                0.000821917808219178,
                0.0007534246575342466,
                0.0006849315068493152,
                0.0006164383561643835,
                0.000547945205479452,
                0.0004794520547945206,
                0.000410958904109589,
                0.0003424657534246576,
                0.000273972602739726,
                0.00020547945205479456,
                0.000136986301369863,
                6.849315068493156e-05,
                0
            ],
            "train_loss": [
                3.991844415664673,
                4.005383014678955,
                3.778353691101074,
                3.8911168575286865,
                3.7778661251068115,
                3.53446888923645,
                3.858534097671509,
                3.8481273651123047,
                4.017226696014404,
                3.7830729484558105,
                3.867676019668579,
                3.709681987762451,
                3.831712245941162,
                3.686293601989746,
                4.023958206176758,
                3.656665325164795,
                3.8176896572113037,
                3.7119266986846924,
                3.7727410793304443,
                3.683769464492798,
                3.816075325012207,
                3.727776050567627,
                3.835188627243042,
                3.7952940464019775,
                3.73516845703125,
                3.6690990924835205,
                3.761439085006714,
                3.4523603916168213,
                3.8576583862304688,
                3.5817205905914307,
                3.3616530895233154,
                3.548859119415283,
                3.530893087387085
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}