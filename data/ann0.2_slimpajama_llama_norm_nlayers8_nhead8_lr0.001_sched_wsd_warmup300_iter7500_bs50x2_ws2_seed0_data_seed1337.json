{
    "summary": {
        "optimized_parameters": 53027328,
        "iter_dt": 0.289294986,
        "_runtime": 582.5516149997711,
        "parameters": 53027328,
        "val/perplexity": 28.334985339410977,
        "final-val/perplexity": 29.366961590139702,
        "final-val/loss": 3.379872560501098,
        "lr": 0,
        "iter": 7500,
        "val/acc": 0.4129602015018463,
        "train/loss": 3.499690532684326,
        "final-val/acc": 0.407649278640747,
        "val/loss": 3.344099521636963,
        "_timestamp": 1715380073.886395,
        "train/perplexity": 33.10512746214819,
        "_step": 39,
        "_wandb": {
            "runtime": 583
        }
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 512,
        "n_head": 8,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 8,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 7500,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/sl53_slimpajama_llama_norm_nlayers8_nhead8_lr0.001_sched_wsd_warmup300_iter11250_bs50x2_ws2_seed0_data_seed1337/ckpts/6000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            3650,
            7500,
            11250
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann0.2_slimpajama_llama_norm_nlayers8_nhead8_lr0.001_sched_wsd_warmup300_iter7500_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                7500
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.3798725605010986
            ],
            "final_val_perplexity": [
                29.366961590139706
            ]
        },
        "val": {
            "iter": [
                6000,
                6200,
                6400,
                6600,
                6800,
                7000,
                7200,
                7400
            ],
            "val_perplexity": [
                32.89510417206652,
                32.206061041497456,
                31.49726418328113,
                30.76852628195186,
                30.083555112718635,
                29.40910657433856,
                28.809144758900125,
                28.334985339410977
            ],
            "val_loss": [
                3.493326187133789,
                3.4721570014953613,
                3.4499030113220215,
                3.426494598388672,
                3.4039809703826904,
                3.3813066482543945,
                3.3606951236724854,
                3.344099521636963
            ],
            "val_acc": [
                0.3963659703731537,
                0.39915403723716736,
                0.40156859159469604,
                0.40367797017097473,
                0.40636229515075684,
                0.40879881381988525,
                0.41108885407447815,
                0.4129602015018463
            ]
        },
        "train": {
            "iter": [
                6050,
                6100,
                6150,
                6200,
                6250,
                6300,
                6350,
                6400,
                6450,
                6500,
                6550,
                6600,
                6650,
                6700,
                6750,
                6800,
                6850,
                6900,
                6950,
                7000,
                7050,
                7100,
                7150,
                7200,
                7250,
                7300,
                7350,
                7400,
                7450,
                7500
            ],
            "train_perplexity": [
                34.21769763791051,
                36.157327621944795,
                33.66988194730729,
                31.5026039102033,
                38.15333529215106,
                33.77282335871533,
                35.16381515368114,
                48.286555738500724,
                35.17583105002869,
                41.03761590516882,
                30.78558670637123,
                37.71304354931277,
                36.882705068158295,
                44.75214696590304,
                43.438128616082764,
                28.181214690127955,
                39.02170270759432,
                31.27868037048167,
                31.831175647487864,
                36.09349696475672,
                25.04524604499112,
                38.15475436596856,
                36.52934407741163,
                33.38370380116582,
                26.327213175157112,
                43.25352473169068,
                37.65261529092266,
                28.903205898576974,
                27.39326471437532,
                33.10512746214819
            ],
            "train_lr": [
                0.0009666666666666667,
                0.0009333333333333333,
                0.0009000000000000001,
                0.0008666666666666667,
                0.0008333333333333334,
                0.0008,
                0.0007666666666666666,
                0.0007333333333333334,
                0.0007,
                0.0006666666666666668,
                0.0006333333333333333,
                0.0006,
                0.0005666666666666667,
                0.0005333333333333334,
                0.0005,
                0.00046666666666666666,
                0.00043333333333333337,
                0.0004,
                0.0003666666666666667,
                0.0003333333333333334,
                0.00030000000000000003,
                0.00026666666666666673,
                0.00023333333333333328,
                0.00019999999999999996,
                0.00016666666666666663,
                0.0001333333333333333,
                9.999999999999998e-05,
                6.666666666666666e-05,
                3.333333333333333e-05,
                0
            ],
            "train_loss": [
                3.532745361328125,
                3.5878820419311523,
                3.516606092453003,
                3.4500725269317627,
                3.641615629196167,
                3.5196588039398193,
                3.5600199699401855,
                3.8771557807922363,
                3.560361623764038,
                3.714491605758667,
                3.427048921585083,
                3.6300084590911865,
                3.6077451705932617,
                3.8011419773101807,
                3.7713401317596436,
                3.338657855987549,
                3.6641204357147217,
                3.442939043045044,
                3.4604485034942627,
                3.5861151218414307,
                3.220686197280884,
                3.641652822494507,
                3.598118305206299,
                3.508070230484009,
                3.2706053256988525,
                3.7670812606811523,
                3.6284048557281494,
                3.363954782485962,
                3.3102993965148926,
                3.499690532684326
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}