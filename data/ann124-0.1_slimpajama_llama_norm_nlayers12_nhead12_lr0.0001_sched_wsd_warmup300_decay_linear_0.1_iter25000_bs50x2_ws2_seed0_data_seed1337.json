{
    "summary": {
        "iter_dt": 0.288422986,
        "val/acc": 0.4352782964706421,
        "_runtime": 1746.2130799293518,
        "train/loss": 3.247850179672241,
        "final-val/perplexity": 24.24468974893,
        "val/perplexity": 23.384505554819615,
        "_step": 126,
        "_wandb": {
            "runtime": 1747
        },
        "val/loss": 3.15207576751709,
        "parameters": 123587328,
        "final-val/loss": 3.188199758529663,
        "iter": 25000,
        "_timestamp": 1720816309.4985988,
        "final-val/acc": 0.4300632178783417,
        "lr": 0,
        "train/perplexity": 25.734898652997188,
        "optimized_parameters": 123587328
    },
    "config": {
        "lr": 0.0001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.0001_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.1,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.1",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.1_slimpajama_llama_norm_nlayers12_nhead12_lr0.0001_sched_wsd_warmup300_decay_linear_0.1_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.188199758529663
            ],
            "final_val_perplexity": [
                24.24468974893
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                25.793794785133898,
                25.69874200758055,
                25.68861598374884,
                25.661957022580932,
                25.600462537012838,
                25.54309792599391,
                25.47091247020193,
                25.436557908370563,
                25.402467713203244,
                25.38464993216508,
                25.312544118245988,
                25.27724000712444,
                25.23661751288546,
                25.13722245755866,
                24.96081193438635,
                24.81545231585435,
                24.62025902271141,
                24.445273337261785,
                24.265635329928507,
                24.11223707245111,
                23.946879022474377,
                23.780449358360656,
                23.630101363301165,
                23.508997623098217,
                23.384505554819615
            ],
            "val_loss": [
                3.250136137008667,
                3.2464442253112793,
                3.2460501194000244,
                3.245011806488037,
                3.242612600326538,
                3.2403693199157715,
                3.237539291381836,
                3.236189603805542,
                3.2348484992980957,
                3.2341468334198,
                3.231302261352539,
                3.2299065589904785,
                3.2282981872558594,
                3.2243518829345703,
                3.2173092365264893,
                3.2114686965942383,
                3.2035717964172363,
                3.196439027786255,
                3.189063310623169,
                3.1827216148376465,
                3.175840139389038,
                3.168865919113159,
                3.1625235080718994,
                3.1573853492736816,
                3.15207576751709
            ],
            "val_acc": [
                0.4240441918373108,
                0.4243749976158142,
                0.42438721656799316,
                0.42442137002944946,
                0.4249023199081421,
                0.4248083233833313,
                0.42522215843200684,
                0.42549559473991394,
                0.4256384074687958,
                0.42530882358551025,
                0.4261828362941742,
                0.4256884455680847,
                0.42608642578125,
                0.4264147877693176,
                0.42744138836860657,
                0.4278515577316284,
                0.42937618494033813,
                0.4297460913658142,
                0.4305737018585205,
                0.4315258860588074,
                0.4322228729724884,
                0.4333813488483429,
                0.4338977038860321,
                0.43453124165534973,
                0.4352782964706421
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                24.923009336171308,
                23.70930490936856,
                27.18200051614473,
                27.22335930646894,
                21.982517091089548,
                32.39490516383011,
                29.33975188715664,
                21.10998456891482,
                28.31984337098143,
                27.455439004727914,
                27.11465897679369,
                32.14139613922179,
                24.568241961470918,
                30.856335961984872,
                28.396067503055644,
                26.75477119460222,
                29.55975123717122,
                28.16746441520135,
                28.65106579018575,
                31.462514252365846,
                37.45396675124171,
                28.116176794546103,
                27.736494820345968,
                26.66629671603817,
                29.574188224112085,
                22.5672655002536,
                22.16363995914283,
                29.56913306683951,
                24.765650257066486,
                28.526835157183687,
                26.392731168982763,
                31.108074279286,
                30.754012190998793,
                26.78298687082441,
                24.764835437441167,
                30.84694286202742,
                31.04325286930976,
                28.100803366376862,
                23.525543733305497,
                30.46269439006158,
                35.42290755088493,
                29.725076096546736,
                27.01892553105515,
                28.332816880440443,
                28.662749082115678,
                30.812712058738633,
                32.01447059222432,
                37.670825205082224,
                26.977600748939214,
                29.3641260690993,
                23.337987006516578,
                37.45369886073392,
                23.88169829289635,
                27.765136804851707,
                23.84451235693921,
                25.737193497326846,
                33.2621960876201,
                22.646815466536143,
                31.372186676341112,
                27.30040060598228,
                30.146336640774358,
                30.837956997341514,
                28.75510503871514,
                26.70691540882106,
                31.641506049612325,
                24.100156119306114,
                29.814208079969877,
                23.04124209719514,
                26.608377153287968,
                33.061831823183816,
                29.838556686774275,
                26.39904331444688,
                25.5318887973996,
                29.126035177132202,
                26.105964913114587,
                22.537961081102363,
                26.375784581310434,
                26.906633994882863,
                21.095343591841182,
                28.83512676083058,
                24.66423462497043,
                25.793204419176615,
                29.564388914598915,
                21.43914151576757,
                26.91865846050742,
                26.6371687728655,
                25.795080107752117,
                26.305435093641147,
                31.112116664054337,
                33.84932395005614,
                19.648327111407195,
                26.41677951898169,
                30.239694834584686,
                27.407519192276165,
                27.927601449186955,
                23.778345993750506,
                32.4296256315284,
                25.867647703230684,
                25.493209159788204,
                25.734898652997188
            ],
            "train_lr": [
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                0.0001,
                9.8e-05,
                9.6e-05,
                9.4e-05,
                9.200000000000001e-05,
                9e-05,
                8.800000000000001e-05,
                8.6e-05,
                8.4e-05,
                8.200000000000001e-05,
                8e-05,
                7.800000000000001e-05,
                7.6e-05,
                7.4e-05,
                7.2e-05,
                7e-05,
                6.8e-05,
                6.599999999999999e-05,
                6.400000000000001e-05,
                6.2e-05,
                6e-05,
                5.800000000000001e-05,
                5.6000000000000006e-05,
                5.4000000000000005e-05,
                5.2000000000000004e-05,
                5e-05,
                4.8e-05,
                4.6e-05,
                4.4e-05,
                4.2000000000000004e-05,
                4e-05,
                3.8e-05,
                3.6e-05,
                3.4e-05,
                3.2e-05,
                3.0000000000000008e-05,
                2.8000000000000003e-05,
                2.6000000000000002e-05,
                2.4e-05,
                2.2e-05,
                1.9999999999999995e-05,
                1.8000000000000007e-05,
                1.6000000000000003e-05,
                1.4000000000000001e-05,
                1.2e-05,
                9.999999999999997e-06,
                7.999999999999996e-06,
                6.000000000000005e-06,
                4.000000000000004e-06,
                2.000000000000002e-06,
                0
            ],
            "train_loss": [
                3.2157936096191406,
                3.16586971282959,
                3.3025572299957275,
                3.304077625274658,
                3.090249538421631,
                3.47800350189209,
                3.3789455890655518,
                3.049748182296753,
                3.343564987182617,
                3.3125665187835693,
                3.300076723098755,
                3.470147132873535,
                3.2014567852020264,
                3.429344415664673,
                3.346252918243408,
                3.286715030670166,
                3.386415958404541,
                3.338169813156128,
                3.3551928997039795,
                3.4487991333007812,
                3.623115062713623,
                3.3363473415374756,
                3.32275128364563,
                3.283402681350708,
                3.386904239654541,
                3.116502523422241,
                3.0984551906585693,
                3.386733293533325,
                3.2094597816467285,
                3.3508474826812744,
                3.2730908393859863,
                3.437469720840454,
                3.42602276802063,
                3.287769079208374,
                3.2094268798828125,
                3.42903995513916,
                3.4353837966918945,
                3.3358004093170166,
                3.1580889225006104,
                3.4165050983428955,
                3.5673611164093018,
                3.391993284225464,
                3.296539783477783,
                3.3440229892730713,
                3.355600595474243,
                3.427929639816284,
                3.4661903381347656,
                3.6288883686065674,
                3.295009136199951,
                3.3797760009765625,
                3.1500844955444336,
                3.62310791015625,
                3.173114538192749,
                3.3237833976745605,
                3.171556234359741,
                3.247939348220825,
                3.5044238567352295,
                3.120021343231201,
                3.4459240436553955,
                3.306903600692749,
                3.4060657024383545,
                3.428748607635498,
                3.3588175773620605,
                3.2849247455596924,
                3.454472064971924,
                3.182220458984375,
                3.3949873447418213,
                3.1372878551483154,
                3.2812283039093018,
                3.4983818531036377,
                3.395803689956665,
                3.273329973220825,
                3.2399303913116455,
                3.3716347217559814,
                3.2621660232543945,
                3.1152031421661377,
                3.2724485397338867,
                3.292375087738037,
                3.0490543842315674,
                3.3615965843200684,
                3.2053563594818115,
                3.2501132488250732,
                3.38657283782959,
                3.065220355987549,
                3.2928218841552734,
                3.2823097705841064,
                3.250185966491699,
                3.269777774810791,
                3.4375996589660645,
                3.521921396255493,
                2.977994203567505,
                3.2740015983581543,
                3.4091577529907227,
                3.310819625854492,
                3.329617738723755,
                3.1687774658203125,
                3.479074716567993,
                3.252995252609253,
                3.2384142875671387,
                3.247850179672241
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}