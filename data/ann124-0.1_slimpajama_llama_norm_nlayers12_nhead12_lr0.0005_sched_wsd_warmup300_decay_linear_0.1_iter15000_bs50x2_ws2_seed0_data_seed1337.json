{
    "summary": {
        "_step": 126,
        "_wandb": {
            "runtime": 1756
        },
        "_runtime": 1755.6957890987396,
        "final-val/perplexity": 22.940394825437945,
        "iter": 15000,
        "_timestamp": 1721148727.277807,
        "final-val/loss": 3.132901430130005,
        "iter_dt": 0.310410283,
        "val/acc": 0.4384741187095642,
        "train/loss": 3.259481191635132,
        "train/perplexity": 26.03596884602079,
        "optimized_parameters": 123587328,
        "lr": 0,
        "val/loss": 3.102487087249756,
        "parameters": 123587328,
        "final-val/acc": 0.4337013363838196,
        "val/perplexity": 22.253181793719943
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 15000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/10000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.1,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.1",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.1_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.1_iter15000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                15000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.132901430130005
            ],
            "final_val_perplexity": [
                22.940394825437945
            ]
        },
        "val": {
            "iter": [
                10000,
                10200,
                10400,
                10600,
                10800,
                11000,
                11200,
                11400,
                11600,
                11800,
                12000,
                12200,
                12400,
                12600,
                12800,
                13000,
                13200,
                13400,
                13600,
                13800,
                14000,
                14200,
                14400,
                14600,
                14800
            ],
            "val_perplexity": [
                25.993755169359304,
                25.9236891185207,
                25.877147125487554,
                25.766682647814875,
                25.680979693884126,
                25.588380217920495,
                25.517526875043767,
                25.44385460105864,
                25.363627357874694,
                25.30030814377386,
                25.213415083935026,
                25.189543327846575,
                25.079424883770795,
                25.067176091809102,
                25.040320249881177,
                24.955420804384165,
                24.875114516302848,
                24.81111001351351,
                24.62945891084454,
                24.24078830597283,
                23.82820775233021,
                23.366493136232933,
                22.95420377746662,
                22.591662886073717,
                22.253181793719943
            ],
            "val_loss": [
                3.2578585147857666,
                3.255159378051758,
                3.2533624172210693,
                3.24908447265625,
                3.2457528114318848,
                3.242140531539917,
                3.239367723464966,
                3.236476421356201,
                3.233318328857422,
                3.230818748474121,
                3.2273783683776855,
                3.226431131362915,
                3.2220499515533447,
                3.2215614318847656,
                3.220489501953125,
                3.2170932292938232,
                3.213870048522949,
                3.2112936973571777,
                3.2039453983306885,
                3.1880388259887695,
                3.170872211456299,
                3.1513051986694336,
                3.1335031986236572,
                3.1175830364227295,
                3.102487087249756
            ],
            "val_acc": [
                0.4206201136112213,
                0.4207385182380676,
                0.42130979895591736,
                0.4217602610588074,
                0.42209839820861816,
                0.42238524556159973,
                0.42234617471694946,
                0.42281004786491394,
                0.42313718795776367,
                0.4229980409145355,
                0.4235265851020813,
                0.42375731468200684,
                0.42447996139526367,
                0.4243786334991455,
                0.42405152320861816,
                0.4247339069843292,
                0.4245324730873108,
                0.42527830600738525,
                0.42637449502944946,
                0.42820924520492554,
                0.429840087890625,
                0.43256956338882446,
                0.4344506859779358,
                0.43644410371780396,
                0.4384741187095642
            ]
        },
        "train": {
            "iter": [
                10050,
                10100,
                10150,
                10200,
                10250,
                10300,
                10350,
                10400,
                10450,
                10500,
                10550,
                10600,
                10650,
                10700,
                10750,
                10800,
                10850,
                10900,
                10950,
                11000,
                11050,
                11100,
                11150,
                11200,
                11250,
                11300,
                11350,
                11400,
                11450,
                11500,
                11550,
                11600,
                11650,
                11700,
                11750,
                11800,
                11850,
                11900,
                11950,
                12000,
                12050,
                12100,
                12150,
                12200,
                12250,
                12300,
                12350,
                12400,
                12450,
                12500,
                12550,
                12600,
                12650,
                12700,
                12750,
                12800,
                12850,
                12900,
                12950,
                13000,
                13050,
                13100,
                13150,
                13200,
                13250,
                13300,
                13350,
                13400,
                13450,
                13500,
                13550,
                13600,
                13650,
                13700,
                13750,
                13800,
                13850,
                13900,
                13950,
                14000,
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000
            ],
            "train_perplexity": [
                39.06132778110673,
                26.32610846524888,
                34.590888450896266,
                26.466740309621343,
                37.45085933915015,
                28.022779412885193,
                27.945438484272035,
                28.470209207808512,
                27.22104876862695,
                29.304559489388797,
                29.285694361380283,
                29.39708401378802,
                27.626384485102484,
                22.951861579244998,
                25.436921783608057,
                32.84302220535466,
                27.24452672543585,
                33.48979424749483,
                31.970451765704894,
                32.665783832321864,
                31.393219180253617,
                26.806579118941446,
                25.97558457839367,
                29.974287738478544,
                31.691758229118193,
                30.19800826877075,
                28.81238006562899,
                26.615051801728402,
                38.86497533798223,
                29.07576106407352,
                32.74375018633071,
                33.845708647710964,
                33.88136206189445,
                29.829053814148196,
                29.647800788442474,
                22.19451071477163,
                32.21207388243254,
                32.993552836834475,
                29.930340903609995,
                25.860852205309353,
                21.898313801012574,
                19.272291438419167,
                26.202879990132605,
                27.294341475494864,
                25.347951928476768,
                28.69269644162787,
                22.52060610093899,
                20.142765160215486,
                29.00318158136602,
                27.002838681813547,
                34.02622562219346,
                34.34080446476454,
                34.812477394007786,
                25.858466188136937,
                28.07753138003993,
                26.963351296998084,
                21.600254766018967,
                26.21072771009971,
                37.2987159052451,
                24.277909212141473,
                24.92186253639252,
                25.165616173823455,
                23.873113530440737,
                29.836849360861116,
                31.92387508972965,
                24.50156856583874,
                26.964431316637068,
                25.888032568484977,
                28.035743835589155,
                31.606107171357,
                29.662500012664026,
                29.155222305380846,
                32.6684474795046,
                30.355074935400143,
                22.223130141751376,
                26.57621386518817,
                37.11487811621383,
                31.282565924241357,
                31.869805016143907,
                26.56352536859064,
                28.74866821313724,
                24.44524419626208,
                30.62680357229861,
                24.525647886230207,
                22.798526665504905,
                26.5729192148033,
                27.044698611778614,
                19.178221270032715,
                27.283495672218702,
                23.220567046177464,
                21.530919901622205,
                24.037148413332417,
                25.86244300573583,
                24.629723157511215,
                28.815176047935367,
                26.02714954718538,
                25.862609490506365,
                22.275779064040737,
                25.307354570297512,
                26.03596884602079
            ],
            "train_lr": [
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.00048333333333333334,
                0.00046666666666666666,
                0.00045000000000000004,
                0.00043333333333333337,
                0.0004166666666666667,
                0.0004,
                0.0003833333333333333,
                0.0003666666666666667,
                0.00035,
                0.0003333333333333334,
                0.00031666666666666665,
                0.0003,
                0.00028333333333333335,
                0.0002666666666666667,
                0.00025,
                0.00023333333333333333,
                0.00021666666666666668,
                0.0002,
                0.00018333333333333336,
                0.0001666666666666667,
                0.00015000000000000001,
                0.00013333333333333337,
                0.00011666666666666664,
                9.999999999999998e-05,
                8.333333333333332e-05,
                6.666666666666666e-05,
                4.999999999999999e-05,
                3.333333333333333e-05,
                1.6666666666666664e-05,
                0
            ],
            "train_loss": [
                3.665135383605957,
                3.2705633640289307,
                3.543592691421509,
                3.275891065597534,
                3.6230320930480957,
                3.333019971847534,
                3.330256223678589,
                3.348860502243042,
                3.303992748260498,
                3.3777453899383545,
                3.377101421356201,
                3.3808977603912354,
                3.3187735080718994,
                3.1334011554718018,
                3.236203908920288,
                3.49174165725708,
                3.3048548698425293,
                3.5112431049346924,
                3.4648144245147705,
                3.486330509185791,
                3.44659423828125,
                3.288649559020996,
                3.2571592330932617,
                3.4003422260284424,
                3.456058979034424,
                3.407778263092041,
                3.360807418823242,
                3.2814791202545166,
                3.6600959300994873,
                3.3699071407318115,
                3.4887144565582275,
                3.5218145847320557,
                3.522867441177368,
                3.3954851627349854,
                3.389390230178833,
                3.0998470783233643,
                3.472343683242798,
                3.496314525604248,
                3.3988749980926514,
                3.252732515335083,
                3.086411714553833,
                2.9586703777313232,
                3.265871524810791,
                3.3066816329956055,
                3.2327001094818115,
                3.356644868850708,
                3.1144328117370605,
                3.002847194671631,
                3.36740779876709,
                3.2959442138671875,
                3.5271339416503906,
                3.536336660385132,
                3.549978256225586,
                3.2526402473449707,
                3.3349719047546387,
                3.294480800628662,
                3.072707176208496,
                3.2661709785461426,
                3.6189613342285156,
                3.1895689964294434,
                3.215747594833374,
                3.225480794906616,
                3.172755002975464,
                3.3957464694976807,
                3.4633564949035645,
                3.1987392902374268,
                3.294520854949951,
                3.2537829875946045,
                3.333482503890991,
                3.453352689743042,
                3.389885902404785,
                3.372636318206787,
                3.4864120483398438,
                3.412966012954712,
                3.101135730743408,
                3.2800188064575195,
                3.614020347595215,
                3.443063259124756,
                3.4616613388061523,
                3.279541254043579,
                3.358593702316284,
                3.1964378356933594,
                3.421877861022949,
                3.199721574783325,
                3.1266980171203613,
                3.2798948287963867,
                3.2974932193756104,
                2.953777313232422,
                3.306284189224243,
                3.145040512084961,
                3.0694921016693115,
                3.17960262298584,
                3.252794027328491,
                3.203956127166748,
                3.3609044551849365,
                3.2591423988342285,
                3.252800464630127,
                3.103502035140991,
                3.2310972213745117,
                3.259481191635132
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}