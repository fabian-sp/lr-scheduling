{
    "summary": {
        "train/loss": 3.124683380126953,
        "final-val/acc": 0.441509872674942,
        "train/perplexity": 22.75264217696725,
        "parameters": 123587328,
        "_wandb": {
            "runtime": 1615
        },
        "val/acc": 0.44658568501472473,
        "_runtime": 1615.447138786316,
        "val/loss": 3.0275521278381348,
        "_timestamp": 1720831957.5420108,
        "final-val/perplexity": 21.342502425360372,
        "iter": 25000,
        "_step": 126,
        "iter_dt": 0.287346195,
        "final-val/loss": 3.0607025623321533,
        "val/perplexity": 20.646588322419653,
        "optimized_parameters": 123587328,
        "lr": 0
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.1,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.1",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.1_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.1_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.0607025623321533
            ],
            "final_val_perplexity": [
                21.342502425360372
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                23.529144937432257,
                23.493163290111315,
                23.495835215797495,
                23.472615866442684,
                23.41713821400559,
                23.381863013438863,
                23.403887739328702,
                23.34473736440403,
                23.315151556011816,
                23.298025745705107,
                23.311416367467867,
                23.279202993393838,
                23.235885255822676,
                23.15970986086836,
                22.931678238085336,
                22.69822218780389,
                22.46791955548288,
                22.178446002602968,
                21.929698584794092,
                21.69403657204406,
                21.45697779502748,
                21.222534746317596,
                21.01323095455862,
                20.836044129076907,
                20.646588322419653
            ],
            "val_loss": [
                3.1582419872283936,
                3.1567115783691406,
                3.156825304031372,
                3.155836582183838,
                3.153470277786255,
                3.1519627571105957,
                3.1529042720794678,
                3.150373697280884,
                3.1491055488586426,
                3.1483707427978516,
                3.1489453315734863,
                3.1475625038146973,
                3.145699977874756,
                3.14241623878479,
                3.132521390914917,
                3.122288703918457,
                3.112090587615967,
                3.099123001098633,
                3.087843894958496,
                3.0770394802093506,
                3.066051959991455,
                3.055065631866455,
                3.045154333114624,
                3.036686420440674,
                3.0275521278381348
            ],
            "val_acc": [
                0.43126586079597473,
                0.431610107421875,
                0.43162229657173157,
                0.43134886026382446,
                0.43201783299446106,
                0.4322253465652466,
                0.43205198645591736,
                0.43202024698257446,
                0.4321081340312958,
                0.4315734803676605,
                0.43218138813972473,
                0.4320300221443176,
                0.43275389075279236,
                0.4328247010707855,
                0.4339550733566284,
                0.4353662133216858,
                0.4366491436958313,
                0.43778562545776367,
                0.43938109278678894,
                0.44025999307632446,
                0.44187742471694946,
                0.4428772032260895,
                0.444305419921875,
                0.4453356862068176,
                0.44658568501472473
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                22.611676346949864,
                21.5803904469287,
                24.57233085162675,
                24.886005638368704,
                19.995569199451598,
                29.750125035755076,
                26.671338877556348,
                19.306328086330726,
                25.969355109341738,
                25.2140102138715,
                25.009235476768897,
                29.51185942176715,
                22.644623408950412,
                28.040342968327675,
                25.941112141046013,
                24.585674269225862,
                26.834958196884358,
                25.83716825856824,
                26.114698846240195,
                28.750957611103736,
                34.414275520728886,
                25.67816335178234,
                25.194540525168343,
                24.3021858984245,
                27.010333523598145,
                20.71327789586726,
                20.600196479013956,
                26.53624315105966,
                23.066399371454136,
                26.01133070914854,
                24.84801419536249,
                28.075462948237156,
                28.08934913048852,
                24.015941985585606,
                22.14497867051615,
                28.185474807782207,
                28.665482703387767,
                25.789871564865336,
                21.722274773419205,
                27.737460319270415,
                32.318801953738976,
                27.07542766245669,
                24.690881375932165,
                25.521116598075768,
                26.19592147863358,
                28.35737542547888,
                29.748273826156023,
                34.24326660557783,
                24.931632821306145,
                26.86504540810734,
                21.39052514979735,
                34.22285396413715,
                21.998340232711175,
                25.795104707852687,
                21.83299277334271,
                23.34195462258752,
                30.28224755814779,
                20.70910040797484,
                28.08277342841773,
                25.031486099712197,
                27.659225210930252,
                28.202003976041116,
                26.255540922312047,
                24.251482647568658,
                28.969125001084166,
                21.831332317838285,
                27.064494625006702,
                20.730895814732744,
                23.911564044167513,
                29.972179618040975,
                26.877935604310206,
                23.88009268491099,
                22.825089542981154,
                26.17430816653433,
                23.553386062615044,
                20.062963594283172,
                23.45537439298431,
                24.273996636156852,
                19.139924211849095,
                25.600749408844578,
                22.07954302333155,
                23.17670636975783,
                26.303064497774024,
                19.244856640411278,
                23.862671380206425,
                23.649410823319958,
                22.900016912095072,
                23.073186696657437,
                27.592931456838134,
                30.19909545230899,
                17.612757067534258,
                23.278487029795038,
                26.90877670259706,
                23.94257453910841,
                24.688379629302347,
                20.87862596812572,
                28.781566677465857,
                22.8072633300777,
                22.550312687093726,
                22.752642176967246
            ],
            "train_lr": [
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.00049,
                0.00048,
                0.00047,
                0.00046,
                0.00045000000000000004,
                0.00044,
                0.00043,
                0.00042,
                0.00041000000000000005,
                0.0004,
                0.00039000000000000005,
                0.00038,
                0.00037,
                0.00035999999999999997,
                0.00035,
                0.00033999999999999997,
                0.00032999999999999994,
                0.00032,
                0.00031,
                0.0003,
                0.00029000000000000006,
                0.00028000000000000003,
                0.00027,
                0.00026000000000000003,
                0.00025,
                0.00024,
                0.00022999999999999998,
                0.00021999999999999998,
                0.00021000000000000004,
                0.0002,
                0.00019,
                0.00017999999999999998,
                0.00016999999999999999,
                0.00015999999999999999,
                0.00015000000000000001,
                0.00014000000000000001,
                0.00013000000000000002,
                0.00012,
                0.00010999999999999999,
                9.999999999999998e-05,
                9.000000000000003e-05,
                8.000000000000002e-05,
                7.000000000000001e-05,
                6e-05,
                4.999999999999999e-05,
                3.999999999999998e-05,
                3.0000000000000028e-05,
                2.000000000000002e-05,
                1.000000000000001e-05,
                0
            ],
            "train_loss": [
                3.1184685230255127,
                3.071787118911743,
                3.2016232013702393,
                3.2143077850341797,
                2.9955127239227295,
                3.3928356170654297,
                3.2835917472839355,
                2.960434913635254,
                3.2569193840026855,
                3.2274019718170166,
                3.219247341156006,
                3.3847944736480713,
                3.119924545288086,
                3.333646535873413,
                3.255831241607666,
                3.2021660804748535,
                3.289707660675049,
                3.2518162727355957,
                3.262500524520874,
                3.358673334121704,
                3.5384738445281982,
                3.245643138885498,
                3.2266294956207275,
                3.190568447113037,
                3.2962217330932617,
                3.0307769775390625,
                3.0253026485443115,
                3.2785136699676514,
                3.1383790969848633,
                3.2585344314575195,
                3.212779998779297,
                3.3348982334136963,
                3.335392713546753,
                3.178719997406006,
                3.0976128578186035,
                3.338809013366699,
                3.355695962905884,
                3.2499840259552,
                3.0783402919769287,
                3.3227860927581787,
                3.475651502609253,
                3.298628807067871,
                3.2064361572265625,
                3.2395083904266357,
                3.265605926513672,
                3.3448894023895264,
                3.392773389816284,
                3.53349232673645,
                3.216139554977417,
                3.290828227996826,
                3.0629501342773438,
                3.532896041870117,
                3.0909690856933594,
                3.2501869201660156,
                3.0834243297576904,
                3.150254487991333,
                3.4105639457702637,
                3.0305752754211426,
                3.335158586502075,
                3.2201366424560547,
                3.3199615478515625,
                3.33939528465271,
                3.2678792476654053,
                3.1884799003601074,
                3.3662328720092773,
                3.083348274230957,
                3.298224925994873,
                3.0316271781921387,
                3.1743643283843994,
                3.4002718925476074,
                3.2913079261779785,
                3.1730473041534424,
                3.1278624534606934,
                3.2647805213928223,
                3.159271717071533,
                2.99887752532959,
                3.155101776123047,
                3.1894078254699707,
                2.9517784118652344,
                3.242623805999756,
                3.094653606414795,
                3.1431498527526855,
                3.2696876525878906,
                2.9572458267211914,
                3.1723175048828125,
                3.1633403301239014,
                3.1311397552490234,
                3.1386733055114746,
                3.3175618648529053,
                3.4078142642974854,
                2.8686254024505615,
                3.147531747817993,
                3.292454719543457,
                3.1756603717803955,
                3.2063348293304443,
                3.0387279987335205,
                3.3597373962402344,
                3.1270811557769775,
                3.115751028060913,
                3.124683380126953
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}