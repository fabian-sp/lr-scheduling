{
    "summary": {
        "iter_dt": 0.596297102,
        "_runtime": 3694.164906024933,
        "final-val/loss": 3.0223710536956787,
        "iter": 35000,
        "_step": 126,
        "_wandb": {
            "runtime": 3698
        },
        "_timestamp": 1721150664.683481,
        "parameters": 123587328,
        "final-val/perplexity": 20.53989352480137,
        "optimized_parameters": 123587328,
        "lr": 0,
        "val/perplexity": 19.8628273715783,
        "val/loss": 2.988852024078369,
        "train/loss": 2.9445292949676514,
        "final-val/acc": 0.4460738897323608,
        "train/perplexity": 19.0016784420876,
        "val/acc": 0.4512109160423279
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 35000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/30000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.1,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.1",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.1_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.1_iter35000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                35000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.0223710536956787
            ],
            "final_val_perplexity": [
                20.53989352480137
            ]
        },
        "val": {
            "iter": [
                30000,
                30200,
                30400,
                30600,
                30800,
                31000,
                31200,
                31400,
                31600,
                31800,
                32000,
                32200,
                32400,
                32600,
                32800,
                33000,
                33200,
                33400,
                33600,
                33800,
                34000,
                34200,
                34400,
                34600,
                34800
            ],
            "val_perplexity": [
                22.55488847609695,
                22.503983431998844,
                22.571650994495528,
                22.489925205487836,
                22.515978216380375,
                22.490407791781838,
                22.45618059246965,
                22.43498888839167,
                22.401967619440107,
                22.252194979875462,
                22.069217137607577,
                21.91350684560633,
                21.74475804021313,
                21.570261999401357,
                21.39826819177672,
                21.22968044760286,
                21.045695376632587,
                20.88405252860932,
                20.709174469571863,
                20.54860729384291,
                20.390257324191204,
                20.24727638489314,
                20.105355580943193,
                19.976380447207237,
                19.8628273715783
            ],
            "val_loss": [
                3.1159539222717285,
                3.113694429397583,
                3.116696834564209,
                3.113069534301758,
                3.114227294921875,
                3.113090991973877,
                3.111567974090576,
                3.110623836517334,
                3.1091508865356445,
                3.102442741394043,
                3.0941858291625977,
                3.0871052742004395,
                3.0793747901916504,
                3.071317672729492,
                3.06331205368042,
                3.0554022789001465,
                3.0466980934143066,
                3.038987874984741,
                3.030578851699829,
                3.0227952003479004,
                3.015059232711792,
                3.0080223083496094,
                3.000988245010376,
                2.9945526123046875,
                2.988852024078369
            ],
            "val_acc": [
                0.4357531666755676,
                0.43634033203125,
                0.43580564856529236,
                0.4359411597251892,
                0.43599849939346313,
                0.4358288645744324,
                0.4361523389816284,
                0.435943603515625,
                0.43648314476013184,
                0.4371887147426605,
                0.43804931640625,
                0.43892088532447815,
                0.44032835960388184,
                0.44103267788887024,
                0.4421093761920929,
                0.44300535321235657,
                0.44390013813972473,
                0.4447082281112671,
                0.44566160440444946,
                0.4470495581626892,
                0.4479309022426605,
                0.4489159882068634,
                0.44999998807907104,
                0.45081785321235657,
                0.4512109160423279
            ]
        },
        "train": {
            "iter": [
                30050,
                30100,
                30150,
                30200,
                30250,
                30300,
                30350,
                30400,
                30450,
                30500,
                30550,
                30600,
                30650,
                30700,
                30750,
                30800,
                30850,
                30900,
                30950,
                31000,
                31050,
                31100,
                31150,
                31200,
                31250,
                31300,
                31350,
                31400,
                31450,
                31500,
                31550,
                31600,
                31650,
                31700,
                31750,
                31800,
                31850,
                31900,
                31950,
                32000,
                32050,
                32100,
                32150,
                32200,
                32250,
                32300,
                32350,
                32400,
                32450,
                32500,
                32550,
                32600,
                32650,
                32700,
                32750,
                32800,
                32850,
                32900,
                32950,
                33000,
                33050,
                33100,
                33150,
                33200,
                33250,
                33300,
                33350,
                33400,
                33450,
                33500,
                33550,
                33600,
                33650,
                33700,
                33750,
                33800,
                33850,
                33900,
                33950,
                34000,
                34050,
                34100,
                34150,
                34200,
                34250,
                34300,
                34350,
                34400,
                34450,
                34500,
                34550,
                34600,
                34650,
                34700,
                34750,
                34800,
                34850,
                34900,
                34950,
                35000
            ],
            "train_perplexity": [
                25.925629926247225,
                29.68894725468194,
                23.84403482416279,
                23.903019836086525,
                27.835182212299674,
                32.24903563988508,
                26.72122046510541,
                25.23147360954236,
                23.216348836671948,
                27.080456793093393,
                22.248433816578913,
                27.59844492726679,
                23.433016282755574,
                25.81548164502026,
                24.40512670559849,
                23.10730204024518,
                26.855484263278235,
                23.09234938482641,
                31.2327540806775,
                24.882285748531018,
                20.345862686701643,
                19.97229443676604,
                24.938784671944283,
                29.91687840482994,
                22.421182241056023,
                25.343365388748285,
                28.10254535513513,
                30.048222754879,
                22.138226873155535,
                27.80750220308672,
                18.886113229485176,
                26.94387979550029,
                25.240041346676193,
                20.44447569787088,
                25.013314270406187,
                28.78045504592395,
                22.296044262760912,
                22.944913005170648,
                22.415126468359478,
                23.002479948629926,
                21.420068826469624,
                23.25925306068159,
                26.88992160051781,
                29.773533974265806,
                26.82779984766792,
                28.560562435802808,
                24.565377800471264,
                25.38549119747029,
                26.447198656798957,
                24.991711391855997,
                22.52507382435213,
                19.829781015561018,
                25.756413177941788,
                22.587408134630703,
                23.52686747635955,
                25.770245980187784,
                25.7633225082279,
                23.647031514950275,
                27.67538637895111,
                24.444900335089045,
                21.921151744704026,
                22.622574264366424,
                21.377376562946054,
                19.335648322441127,
                25.965634240807816,
                22.03987632925367,
                27.792184907626915,
                26.76767229879634,
                23.71620790349876,
                20.57650246801908,
                23.71015848771621,
                24.218917179190047,
                21.73799869752018,
                28.71612228813565,
                26.11547713598811,
                17.628977665357937,
                18.055226521847253,
                24.904542178525727,
                22.27530639396979,
                18.46166331251537,
                23.73193229259757,
                20.89691761538872,
                22.126375296919726,
                21.34175952522101,
                25.124232607650494,
                22.43148027481558,
                20.995488227386726,
                20.795953693543037,
                25.170734648571816,
                22.58436567097117,
                25.451481062256576,
                19.080142571085243,
                26.487111026060425,
                24.43262940691672,
                23.56026051236983,
                24.128632476942144,
                18.67605045992148,
                19.403922443247648,
                23.9543137852602,
                19.001678442087602
            ],
            "train_lr": [
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0004928571428571429,
                0.0004857142857142857,
                0.0004785714285714286,
                0.0004714285714285714,
                0.00046428571428571433,
                0.00045714285714285713,
                0.00045000000000000004,
                0.00044285714285714284,
                0.00043571428571428575,
                0.0004285714285714286,
                0.00042142857142857146,
                0.00041428571428571426,
                0.00040714285714285717,
                0.0004,
                0.0003928571428571429,
                0.0003857142857142857,
                0.0003785714285714286,
                0.00037142857142857143,
                0.00036428571428571434,
                0.00035714285714285714,
                0.00035,
                0.00034285714285714285,
                0.00033571428571428576,
                0.00032857142857142856,
                0.0003214285714285714,
                0.00031428571428571427,
                0.0003071428571428572,
                0.0003,
                0.00029285714285714283,
                0.0002857142857142857,
                0.0002785714285714286,
                0.00027142857142857144,
                0.0002642857142857143,
                0.0002571428571428571,
                0.00025,
                0.00024285714285714289,
                0.0002357142857142857,
                0.0002285714285714286,
                0.00022142857142857142,
                0.0002142857142857143,
                0.00020714285714285713,
                0.0002,
                0.00019285714285714284,
                0.00018571428571428572,
                0.00017857142857142854,
                0.00017142857142857143,
                0.0001642857142857143,
                0.00015714285714285713,
                0.00015000000000000001,
                0.00014285714285714284,
                0.00013571428571428572,
                0.00012857142857142855,
                0.00012142857142857144,
                0.00011428571428571427,
                0.00010714285714285715,
                9.999999999999998e-05,
                9.285714285714286e-05,
                8.571428571428569e-05,
                7.857142857142857e-05,
                7.142857142857145e-05,
                6.428571428571427e-05,
                5.714285714285716e-05,
                4.999999999999999e-05,
                4.285714285714287e-05,
                3.57142857142857e-05,
                2.857142857142858e-05,
                2.1428571428571408e-05,
                1.428571428571429e-05,
                7.142857142857117e-06,
                0
            ],
            "train_loss": [
                3.2552342414855957,
                3.390777111053467,
                3.1715362071990967,
                3.174006938934326,
                3.326303005218506,
                3.4734904766082764,
                3.2854602336883545,
                3.2280943393707275,
                3.1448588371276855,
                3.298814535140991,
                3.10227370262146,
                3.3177616596221924,
                3.1541481018066406,
                3.2509765625,
                3.1947953701019287,
                3.140150785446167,
                3.2904722690582275,
                3.1395034790039062,
                3.441469669342041,
                3.214158296585083,
                3.0128796100616455,
                2.9943480491638184,
                3.216426372528076,
                3.3984251022338867,
                3.1100082397460938,
                3.2325191497802734,
                3.335862398147583,
                3.402805805206299,
                3.0973079204559326,
                3.325308084487915,
                2.9384288787841797,
                3.2937583923339844,
                3.228433847427368,
                3.017714738845825,
                3.2194104194641113,
                3.35969877243042,
                3.1044113636016846,
                3.1330983638763428,
                3.1097381114959717,
                3.1356041431427,
                3.0643303394317627,
                3.146705150604248,
                3.2917537689208984,
                3.3936221599578857,
                3.289440870285034,
                3.3520290851593018,
                3.2013401985168457,
                3.234179973602295,
                3.2751524448394775,
                3.2185463905334473,
                3.114631175994873,
                2.987186908721924,
                3.248685836791992,
                3.1173946857452393,
                3.1581451892852783,
                3.249222755432129,
                3.2489540576934814,
                3.1632397174835205,
                3.3205456733703613,
                3.1964237689971924,
                3.087454080581665,
                3.118950366973877,
                3.062335252761841,
                2.9619524478912354,
                3.2567760944366455,
                3.092855453491211,
                3.3247570991516113,
                3.2871971130371094,
                3.166160821914673,
                3.0241518020629883,
                3.165905714035034,
                3.187136173248291,
                3.079063892364502,
                3.3574609756469727,
                3.2625303268432617,
                2.8695459365844727,
                2.893437147140503,
                3.215052366256714,
                3.103480815887451,
                2.915698289871216,
                3.166823625564575,
                3.0396037101745605,
                3.0967724323272705,
                3.0606677532196045,
                3.223834991455078,
                3.1104674339294434,
                3.044309616088867,
                3.0347604751586914,
                3.22568416595459,
                3.117259979248047,
                3.236776113510132,
                2.9486501216888428,
                3.276660442352295,
                3.1959216594696045,
                3.1595635414123535,
                3.183401346206665,
                2.927243947982788,
                2.965477228164673,
                3.1761505603790283,
                2.9445292949676514
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}