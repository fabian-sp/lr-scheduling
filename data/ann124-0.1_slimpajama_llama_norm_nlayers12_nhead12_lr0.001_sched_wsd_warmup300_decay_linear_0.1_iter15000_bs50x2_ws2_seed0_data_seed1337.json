{
    "summary": {
        "parameters": 123587328,
        "train/loss": 3.2502217292785645,
        "final-val/perplexity": 22.64682086595472,
        "val/loss": 3.092489719390869,
        "_timestamp": 1721148858.9469552,
        "final-val/acc": 0.43468448519706726,
        "final-val/loss": 3.1200215816497803,
        "val/perplexity": 22.03181707419586,
        "lr": 0,
        "iter": 15000,
        "_step": 126,
        "_wandb": {
            "runtime": 1750
        },
        "iter_dt": 0.308829623,
        "val/acc": 0.4391723573207855,
        "_runtime": 1751.0344882011414,
        "train/perplexity": 25.796002627579487,
        "optimized_parameters": 123587328
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 15000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/10000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.1,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.1",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.1_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.1_iter15000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                15000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1200215816497803
            ],
            "final_val_perplexity": [
                22.64682086595472
            ]
        },
        "val": {
            "iter": [
                10000,
                10200,
                10400,
                10600,
                10800,
                11000,
                11200,
                11400,
                11600,
                11800,
                12000,
                12200,
                12400,
                12600,
                12800,
                13000,
                13200,
                13400,
                13600,
                13800,
                14000,
                14200,
                14400,
                14600,
                14800
            ],
            "val_perplexity": [
                25.96778868872246,
                25.923516059919262,
                25.880151889524356,
                25.81982736048945,
                25.741851310472985,
                25.628304077218388,
                25.575206009580818,
                25.495409509063187,
                25.48900349570823,
                25.443951661781053,
                25.316998322935465,
                25.30615388462885,
                25.234644055233076,
                25.204940515459917,
                25.24954506915114,
                25.086714827792918,
                25.063112417218314,
                24.971103537302632,
                24.7798903091305,
                24.350243171453997,
                23.837930069289406,
                23.30714831328155,
                22.855159624906086,
                22.42236900072782,
                22.03181707419586
            ],
            "val_loss": [
                3.256859064102173,
                3.255152702331543,
                3.253478527069092,
                3.2511448860168457,
                3.2481203079223633,
                3.243699550628662,
                3.2416255474090576,
                3.2385005950927734,
                3.2382493019104004,
                3.236480236053467,
                3.231478214263916,
                3.2310497760772705,
                3.228219985961914,
                3.2270421981811523,
                3.2288103103637695,
                3.2223405838012695,
                3.2213993072509766,
                3.217721462249756,
                3.2100346088409424,
                3.1925439834594727,
                3.1712801456451416,
                3.1487622261047363,
                3.129179000854492,
                3.1100611686706543,
                3.092489719390869
            ],
            "val_acc": [
                0.4199792146682739,
                0.4202221632003784,
                0.42078614234924316,
                0.42066407203674316,
                0.42095088958740234,
                0.4213000535964966,
                0.4217846393585205,
                0.42271238565444946,
                0.42201662063598633,
                0.42236328125,
                0.42310911417007446,
                0.42303466796875,
                0.4229357838630676,
                0.4233019948005676,
                0.4230895936489105,
                0.423431396484375,
                0.4237682819366455,
                0.4241418242454529,
                0.42524412274360657,
                0.42732298374176025,
                0.42951905727386475,
                0.4325891137123108,
                0.4349340796470642,
                0.4372240900993347,
                0.4391723573207855
            ]
        },
        "train": {
            "iter": [
                10050,
                10100,
                10150,
                10200,
                10250,
                10300,
                10350,
                10400,
                10450,
                10500,
                10550,
                10600,
                10650,
                10700,
                10750,
                10800,
                10850,
                10900,
                10950,
                11000,
                11050,
                11100,
                11150,
                11200,
                11250,
                11300,
                11350,
                11400,
                11450,
                11500,
                11550,
                11600,
                11650,
                11700,
                11750,
                11800,
                11850,
                11900,
                11950,
                12000,
                12050,
                12100,
                12150,
                12200,
                12250,
                12300,
                12350,
                12400,
                12450,
                12500,
                12550,
                12600,
                12650,
                12700,
                12750,
                12800,
                12850,
                12900,
                12950,
                13000,
                13050,
                13100,
                13150,
                13200,
                13250,
                13300,
                13350,
                13400,
                13450,
                13500,
                13550,
                13600,
                13650,
                13700,
                13750,
                13800,
                13850,
                13900,
                13950,
                14000,
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000
            ],
            "train_perplexity": [
                39.071871451939955,
                26.421572919632684,
                34.47604888440569,
                26.37617446950894,
                37.72432055620733,
                28.275746846982436,
                27.80567243277569,
                28.3584909993219,
                27.403938543544903,
                29.22826588743062,
                29.51599698024656,
                29.35390646306145,
                27.705451455430488,
                22.97649397508894,
                25.754650827690167,
                32.81451633411974,
                27.166483695166352,
                33.471546462152176,
                32.10610396064556,
                32.63973515917201,
                31.27602564393489,
                26.896083327915463,
                26.143535952660425,
                30.2545071854402,
                31.589232206926223,
                30.523559840856468,
                28.73817632952367,
                26.66864918222749,
                38.82766004165193,
                29.075033192501802,
                33.36634114733555,
                34.0225346444932,
                33.890459044227676,
                29.928335770359656,
                29.88700716860554,
                22.101194634158727,
                32.17765538006556,
                33.275489960133854,
                30.192623327439716,
                25.443806070836278,
                21.976406891333422,
                19.47159270714003,
                26.683124593696835,
                27.38473647931423,
                25.2362865869609,
                28.20258895942386,
                22.59246545434171,
                20.14189114124667,
                29.243112683216523,
                27.051598802964648,
                34.080638917222956,
                34.45997485051568,
                35.05341618425932,
                25.851605303647016,
                28.17385171514066,
                27.145461046695157,
                21.584090135910124,
                26.454583427281566,
                37.57886910062718,
                24.612159861116748,
                25.14798251224571,
                25.57971253310375,
                24.005111133810573,
                29.806219470287704,
                32.15278552452707,
                24.570719817967905,
                27.270937624688614,
                26.369069347293077,
                27.946571167459542,
                31.422048588095098,
                30.21908932519016,
                29.497101226654898,
                33.08612688078038,
                30.515228379299707,
                22.21290657525943,
                26.59273128660142,
                37.12729515823893,
                31.4755616183591,
                31.927901689512456,
                26.477766452428316,
                28.649644989521008,
                24.53277686151674,
                30.410214589771666,
                24.60108945021926,
                22.7371004435138,
                26.219396673167385,
                26.864898090713414,
                19.08461936870359,
                27.0057359255758,
                23.137131593297283,
                21.31372632811935,
                24.06839063654852,
                25.577321964368227,
                24.427515426367062,
                28.317777342830762,
                25.966779542875326,
                25.744650085766946,
                21.90344660747128,
                24.88450456326695,
                25.796002627579487
            ],
            "train_lr": [
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.0009666666666666667,
                0.0009333333333333333,
                0.0009000000000000001,
                0.0008666666666666667,
                0.0008333333333333334,
                0.0008,
                0.0007666666666666666,
                0.0007333333333333334,
                0.0007,
                0.0006666666666666668,
                0.0006333333333333333,
                0.0006,
                0.0005666666666666667,
                0.0005333333333333334,
                0.0005,
                0.00046666666666666666,
                0.00043333333333333337,
                0.0004,
                0.0003666666666666667,
                0.0003333333333333334,
                0.00030000000000000003,
                0.00026666666666666673,
                0.00023333333333333328,
                0.00019999999999999996,
                0.00016666666666666663,
                0.0001333333333333333,
                9.999999999999998e-05,
                6.666666666666666e-05,
                3.333333333333333e-05,
                0
            ],
            "train_loss": [
                3.6654052734375,
                3.2741830348968506,
                3.5402672290802,
                3.272463321685791,
                3.63030743598938,
                3.3420066833496094,
                3.325242280960083,
                3.344928741455078,
                3.3106889724731445,
                3.375138521194458,
                3.384934663772583,
                3.379427909851074,
                3.32163143157959,
                3.1344738006591797,
                3.24861741065979,
                3.490873336791992,
                3.3019862174987793,
                3.510698080062866,
                3.469048500061035,
                3.485532760620117,
                3.442854166030884,
                3.291982889175415,
                3.263604164123535,
                3.4096474647521973,
                3.4528186321258545,
                3.418501138687134,
                3.3582286834716797,
                3.2834908962249756,
                3.659135341644287,
                3.369882106781006,
                3.507550001144409,
                3.5270254611968994,
                3.5231359004974365,
                3.398808002471924,
                3.397426128387451,
                3.0956337451934814,
                3.4712746143341064,
                3.5048234462738037,
                3.407599925994873,
                3.2364745140075684,
                3.0899715423583984,
                2.968958616256714,
                3.2840335369110107,
                3.309988021850586,
                3.228285074234009,
                3.339416027069092,
                3.1176185607910156,
                3.0028038024902344,
                3.3756463527679443,
                3.297748327255249,
                3.5287318229675293,
                3.5398008823394775,
                3.556875467300415,
                3.2523748874664307,
                3.3383965492248535,
                3.3012120723724365,
                3.071958541870117,
                3.2754316329956055,
                3.6264443397521973,
                3.203242778778076,
                3.2247798442840576,
                3.2418017387390137,
                3.1782689094543457,
                3.394719362258911,
                3.47050142288208,
                3.2015576362609863,
                3.305823802947998,
                3.2721939086914062,
                3.330296754837036,
                3.447512149810791,
                3.4084761142730713,
                3.384294271469116,
                3.4991164207458496,
                3.4182281494140625,
                3.100675582885742,
                3.280640125274658,
                3.6143548488616943,
                3.449213743209839,
                3.463482618331909,
                3.2763075828552246,
                3.3551433086395264,
                3.20001220703125,
                3.414780855178833,
                3.2027928829193115,
                3.124000072479248,
                3.2665016651153564,
                3.290822744369507,
                2.9488847255706787,
                3.296051502227783,
                3.1414408683776855,
                3.0593533515930176,
                3.180901527404785,
                3.241708278656006,
                3.1957123279571533,
                3.343492031097412,
                3.2568202018737793,
                3.2482290267944336,
                3.08664608001709,
                3.214247465133667,
                3.2502217292785645
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}