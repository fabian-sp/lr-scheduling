{
    "summary": {
        "val/acc": 0.447052001953125,
        "val/loss": 3.021970748901367,
        "_wandb": {
            "runtime": 1567
        },
        "iter": 25000,
        "parameters": 123587328,
        "final-val/acc": 0.4419425129890442,
        "lr": 0,
        "val/perplexity": 20.53167295795427,
        "train/perplexity": 22.762131866448705,
        "optimized_parameters": 123587328,
        "_step": 126,
        "_runtime": 1567.3295488357544,
        "_timestamp": 1720856463.6188548,
        "train/loss": 3.1251003742218018,
        "final-val/loss": 3.0541107654571533,
        "final-val/perplexity": 21.202279746341222,
        "iter_dt": 0.287757152
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.1,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.1",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.1_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.1_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.0541107654571533
            ],
            "final_val_perplexity": [
                21.202279746341226
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                23.870643421387992,
                23.866733886447616,
                23.875225277916662,
                23.884676355180876,
                23.793674768342804,
                23.77768837614865,
                23.789908293877133,
                23.716835548071167,
                23.71291162859319,
                23.741366269537362,
                23.7021665798913,
                23.665006291672487,
                23.669780051773596,
                23.556564684639905,
                23.32088890375032,
                23.03439277516049,
                22.72746946717317,
                22.43265153448763,
                22.106712313277768,
                21.84690079160885,
                21.530144777025605,
                21.259321292734352,
                21.004790898920444,
                20.75844453751874,
                20.53167295795427
            ],
            "val_loss": [
                3.172651529312134,
                3.172487735748291,
                3.1728434562683105,
                3.173239231109619,
                3.169421911239624,
                3.1687498092651367,
                3.1692636013031006,
                3.166187286376953,
                3.1660218238830566,
                3.1672210693359375,
                3.1655685901641846,
                3.163999557495117,
                3.164201259613037,
                3.1594066619873047,
                3.1493515968322754,
                3.136990547180176,
                3.1235764026641846,
                3.1105196475982666,
                3.095883369445801,
                3.0840611457824707,
                3.069456100463867,
                3.056797504425049,
                3.044752597808838,
                3.0329551696777344,
                3.021970748901367
            ],
            "val_acc": [
                0.4293005168437958,
                0.4292285144329071,
                0.4293505549430847,
                0.42915529012680054,
                0.42975831031799316,
                0.4293908476829529,
                0.4293456971645355,
                0.4294750690460205,
                0.4301220774650574,
                0.42913818359375,
                0.4300524890422821,
                0.43010008335113525,
                0.4299951195716858,
                0.43055662512779236,
                0.43183839321136475,
                0.4331896901130676,
                0.4351257383823395,
                0.4358556866645813,
                0.43791747093200684,
                0.43947142362594604,
                0.4412182569503784,
                0.44310179352760315,
                0.4442480504512787,
                0.4457653760910034,
                0.447052001953125
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                23.026738445247865,
                21.8661919242826,
                24.903770289284413,
                25.498011272001044,
                20.350927581883507,
                30.01982356234335,
                26.966572197708235,
                19.69260820124861,
                26.427828954068314,
                25.684512803213835,
                25.56297105351063,
                29.817243459934947,
                22.916702633715765,
                28.65492553226324,
                26.518312934317837,
                24.751288562285694,
                27.642177170798536,
                26.17719140729485,
                26.58492131104165,
                29.24894193696259,
                35.40402850459477,
                26.18798453614561,
                25.690435065995977,
                25.043675656013363,
                27.778770154413944,
                21.024411106753377,
                21.19360711651927,
                27.18355592614434,
                23.57538124781307,
                26.315277232067544,
                25.030555114121352,
                28.95915333751038,
                28.50484136032427,
                24.473766531960504,
                22.533394098594435,
                28.789665042210654,
                29.300954549824954,
                26.273888557412867,
                22.258801100037086,
                28.440751733562255,
                33.05693712220111,
                27.623558961514473,
                25.006063541551036,
                26.050299593584892,
                26.799517792807187,
                29.12218835366841,
                30.361227186394835,
                34.91922850996175,
                25.154464744888738,
                27.43510193823367,
                21.80676297764894,
                35.037749598664455,
                22.548726701949924,
                26.181810246923693,
                22.174417103069217,
                23.87347780777854,
                30.92409943069465,
                21.239335012056145,
                28.930259057728673,
                25.574651133984187,
                28.021236110483372,
                28.678901729389256,
                26.73600488180719,
                24.648221594481363,
                29.33803113385532,
                22.06128390838811,
                27.140115719305662,
                21.131733331137266,
                24.251812223816344,
                30.149463340141573,
                27.28546021908832,
                24.003720421761866,
                22.944316729522026,
                26.21039650881879,
                23.718034338818043,
                20.217195562086307,
                23.775471885266978,
                24.504927730597874,
                19.2939454284935,
                25.832696444359268,
                22.267463659342628,
                23.317675370351807,
                26.217983942945057,
                19.285851070625224,
                23.826577337115253,
                23.730348069141524,
                22.920970230714364,
                23.055930786434747,
                27.286143290047633,
                30.216221955813467,
                17.506728416687288,
                23.27851477991192,
                26.794336410343405,
                23.824077962462205,
                24.481283161787115,
                20.967939865386303,
                28.68662923388023,
                22.89519642864533,
                22.35181804442307,
                22.762131866448705
            ],
            "train_lr": [
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.00098,
                0.00096,
                0.00094,
                0.00092,
                0.0009000000000000001,
                0.00088,
                0.00086,
                0.00084,
                0.0008200000000000001,
                0.0008,
                0.0007800000000000001,
                0.00076,
                0.00074,
                0.0007199999999999999,
                0.0007,
                0.0006799999999999999,
                0.0006599999999999999,
                0.00064,
                0.00062,
                0.0006,
                0.0005800000000000001,
                0.0005600000000000001,
                0.00054,
                0.0005200000000000001,
                0.0005,
                0.00048,
                0.00045999999999999996,
                0.00043999999999999996,
                0.00042000000000000007,
                0.0004,
                0.00038,
                0.00035999999999999997,
                0.00033999999999999997,
                0.00031999999999999997,
                0.00030000000000000003,
                0.00028000000000000003,
                0.00026000000000000003,
                0.00024,
                0.00021999999999999998,
                0.00019999999999999996,
                0.00018000000000000007,
                0.00016000000000000004,
                0.00014000000000000001,
                0.00012,
                9.999999999999998e-05,
                7.999999999999997e-05,
                6.0000000000000056e-05,
                4.000000000000004e-05,
                2.000000000000002e-05,
                0
            ],
            "train_loss": [
                3.136658191680908,
                3.0849437713623047,
                3.2150213718414307,
                3.238602638244629,
                3.0131285190582275,
                3.401860237121582,
                3.294600248336792,
                2.980245351791382,
                3.2744197845458984,
                3.2458903789520264,
                3.241147041320801,
                3.3950891494750977,
                3.1318681240081787,
                3.355327606201172,
                3.2778377532958984,
                3.2088797092437744,
                3.319344997406006,
                3.264890670776367,
                3.280346393585205,
                3.3758456707000732,
                3.5668280124664307,
                3.265302896499634,
                3.2461209297180176,
                3.22062349319458,
                3.3242743015289307,
                3.0456862449645996,
                3.053701639175415,
                3.302614450454712,
                3.160205125808716,
                3.2701518535614014,
                3.220099449157715,
                3.3658885955810547,
                3.350076198577881,
                3.197603940963745,
                3.1150004863739014,
                3.360018730163574,
                3.377622365951538,
                3.268577814102173,
                3.1027395725250244,
                3.347825288772583,
                3.4982337951660156,
                3.318671226501465,
                3.219120502471924,
                3.2600314617156982,
                3.288386106491089,
                3.371502637863159,
                3.4131686687469482,
                3.553040027618408,
                3.2250375747680664,
                3.3118255138397217,
                3.0822222232818604,
                3.5564284324645996,
                3.115680694580078,
                3.2650671005249023,
                3.0989413261413574,
                3.1727702617645264,
                3.4315381050109863,
                3.055856943130493,
                3.3648903369903564,
                3.2416038513183594,
                3.3329648971557617,
                3.35616397857666,
                3.28601336479187,
                3.204706907272339,
                3.3788869380950928,
                3.0938262939453125,
                3.3010151386260986,
                3.0507779121398926,
                3.188493490219116,
                3.4061694145202637,
                3.306356191635132,
                3.178210973739624,
                3.1330723762512207,
                3.26615834236145,
                3.1662378311157227,
                3.006535530090332,
                3.168656587600708,
                3.19887638092041,
                2.9597933292388916,
                3.251643180847168,
                3.103128671646118,
                3.1492137908935547,
                3.2664477825164795,
                2.959373712539673,
                3.1708037853240967,
                3.1667568683624268,
                3.132054328918457,
                3.137925148010254,
                3.3063812255859375,
                3.408381223678589,
                2.8625872135162354,
                3.1475329399108887,
                3.2881927490234375,
                3.170698881149292,
                3.197911024093628,
                3.042996644973755,
                3.356433391571045,
                3.1309292316436768,
                3.10690975189209,
                3.1251003742218018
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}