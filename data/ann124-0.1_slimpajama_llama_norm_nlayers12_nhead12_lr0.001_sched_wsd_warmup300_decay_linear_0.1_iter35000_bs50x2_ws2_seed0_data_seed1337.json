{
    "summary": {
        "lr": 0,
        "_timestamp": 1721150727.516449,
        "final-val/acc": 0.44612917304039,
        "optimized_parameters": 123587328,
        "_wandb": {
            "runtime": 3752
        },
        "val/loss": 2.9845786094665527,
        "final-val/loss": 3.0180513858795166,
        "final-val/perplexity": 20.45135942396756,
        "iter": 35000,
        "iter_dt": 0.617376098,
        "val/acc": 0.45150142908096313,
        "_step": 126,
        "_runtime": 3748.446536064148,
        "parameters": 123587328,
        "train/loss": 2.941791534423828,
        "val/perplexity": 19.77812644182746,
        "train/perplexity": 18.949727578488694
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 35000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/30000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.1,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.1",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.1_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.1_iter35000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                35000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.0180513858795166
            ],
            "final_val_perplexity": [
                20.45135942396756
            ]
        },
        "val": {
            "iter": [
                30000,
                30200,
                30400,
                30600,
                30800,
                31000,
                31200,
                31400,
                31600,
                31800,
                32000,
                32200,
                32400,
                32600,
                32800,
                33000,
                33200,
                33400,
                33600,
                33800,
                34000,
                34200,
                34400,
                34600,
                34800
            ],
            "val_perplexity": [
                23.11276230883165,
                23.08550138247695,
                23.118962462071654,
                23.069688279674732,
                23.06247859368189,
                23.014444131680122,
                23.011552628829442,
                23.006697696522167,
                22.938289198204505,
                22.777799322577373,
                22.5851141328696,
                22.390770254372832,
                22.152910306346193,
                21.956458389771157,
                21.72096970704326,
                21.50116181799861,
                21.303331940774335,
                21.112536458779694,
                20.869195074905317,
                20.677081259534525,
                20.486428254507558,
                20.287968112250013,
                20.091147914101317,
                19.931166639373615,
                19.77812644182746
            ],
            "val_loss": [
                3.1403870582580566,
                3.139206886291504,
                3.140655279159546,
                3.138521671295166,
                3.138209104537964,
                3.1361241340637207,
                3.135998487472534,
                3.1357874870300293,
                3.132809638977051,
                3.125788450241089,
                3.117293119430542,
                3.1086509227752686,
                3.097970962524414,
                3.0890634059906006,
                3.078280210494995,
                3.0681090354919434,
                3.058865547180176,
                3.0498690605163574,
                3.038276195526123,
                3.0290279388427734,
                3.0197646617889404,
                3.0100300312042236,
                3.00028133392334,
                2.9922866821289062,
                2.9845786094665527
            ],
            "val_acc": [
                0.4331128001213074,
                0.4329491853713989,
                0.4324682354927063,
                0.4321874976158142,
                0.4328894019126892,
                0.43305420875549316,
                0.432891845703125,
                0.4327624440193176,
                0.4333740174770355,
                0.4344836175441742,
                0.43531492352485657,
                0.4364257752895355,
                0.4376586675643921,
                0.43848997354507446,
                0.4401891827583313,
                0.4407104253768921,
                0.4418298304080963,
                0.443359375,
                0.44480833411216736,
                0.44624632596969604,
                0.4469043016433716,
                0.4485192894935608,
                0.4493921101093292,
                0.4505944550037384,
                0.45150142908096313
            ]
        },
        "train": {
            "iter": [
                30050,
                30100,
                30150,
                30200,
                30250,
                30300,
                30350,
                30400,
                30450,
                30500,
                30550,
                30600,
                30650,
                30700,
                30750,
                30800,
                30850,
                30900,
                30950,
                31000,
                31050,
                31100,
                31150,
                31200,
                31250,
                31300,
                31350,
                31400,
                31450,
                31500,
                31550,
                31600,
                31650,
                31700,
                31750,
                31800,
                31850,
                31900,
                31950,
                32000,
                32050,
                32100,
                32150,
                32200,
                32250,
                32300,
                32350,
                32400,
                32450,
                32500,
                32550,
                32600,
                32650,
                32700,
                32750,
                32800,
                32850,
                32900,
                32950,
                33000,
                33050,
                33100,
                33150,
                33200,
                33250,
                33300,
                33350,
                33400,
                33450,
                33500,
                33550,
                33600,
                33650,
                33700,
                33750,
                33800,
                33850,
                33900,
                33950,
                34000,
                34050,
                34100,
                34150,
                34200,
                34250,
                34300,
                34350,
                34400,
                34450,
                34500,
                34550,
                34600,
                34650,
                34700,
                34750,
                34800,
                34850,
                34900,
                34950,
                35000
            ],
            "train_perplexity": [
                26.943520058537743,
                30.53498746432726,
                24.288787865774953,
                24.64972017048948,
                28.851383428772138,
                32.57431599936797,
                27.36848403035506,
                25.849885744657687,
                23.817569458205078,
                27.443992643189343,
                22.636019204902794,
                28.440799199195254,
                24.033761690682546,
                26.424754302916273,
                24.82170680308505,
                23.581891038737695,
                27.433460187918747,
                23.63230430187826,
                31.783483319252113,
                25.771947952447135,
                20.91838202799857,
                20.489735220806683,
                25.575169424005935,
                30.555480549104466,
                23.039187636059722,
                26.06099069620938,
                28.32441482513932,
                30.759863941371,
                22.624472904746433,
                28.485146333853063,
                19.396924185512372,
                27.635916995819567,
                26.107894468711088,
                21.15973399790183,
                25.723341639262763,
                29.94811468082495,
                22.753097852043624,
                23.743398432567382,
                22.906340216931635,
                23.60431803435618,
                21.685478173835307,
                23.8864132550961,
                27.780598154403094,
                30.217309795077753,
                27.44149327243531,
                29.25354480017835,
                25.11422517788609,
                25.907093113239284,
                27.197221435267608,
                25.695942096699795,
                22.842189021080525,
                20.33115059502915,
                26.290650580724318,
                23.273525840601977,
                24.026983948359884,
                26.22273501958303,
                26.47776013964186,
                23.89706520630633,
                28.068937341936937,
                24.713744360399943,
                22.06974857649925,
                22.910032348803107,
                21.72528915496579,
                19.422862305942537,
                26.24590259283956,
                22.353699290631592,
                28.243561230025787,
                27.017295802404426,
                23.989291533073,
                20.796618094701156,
                23.86494151903314,
                24.45166771257946,
                22.024957997090933,
                28.957807011675477,
                26.326233998131205,
                17.88537502303397,
                18.21569135902746,
                25.337015700645402,
                22.369042952004936,
                18.682899990439477,
                23.85027192798445,
                20.78918197925901,
                22.12711913171528,
                21.48344247132877,
                25.18434297088198,
                22.444346090795456,
                21.085809779838627,
                20.989272054594572,
                25.110938149087076,
                22.75083041634915,
                25.630937734476024,
                19.036226548697414,
                26.32088682770468,
                24.398197699036544,
                23.578703377685155,
                24.21012461429395,
                18.764257100597376,
                19.287915728984082,
                23.74033044277657,
                18.949727578488698
            ],
            "train_lr": [
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.0009857142857142857,
                0.0009714285714285714,
                0.0009571428571428573,
                0.0009428571428571429,
                0.0009285714285714287,
                0.0009142857142857143,
                0.0009000000000000001,
                0.0008857142857142857,
                0.0008714285714285715,
                0.0008571428571428572,
                0.0008428571428571429,
                0.0008285714285714285,
                0.0008142857142857143,
                0.0008,
                0.0007857142857142857,
                0.0007714285714285715,
                0.0007571428571428572,
                0.0007428571428571429,
                0.0007285714285714287,
                0.0007142857142857143,
                0.0007,
                0.0006857142857142857,
                0.0006714285714285715,
                0.0006571428571428571,
                0.0006428571428571428,
                0.0006285714285714285,
                0.0006142857142857143,
                0.0006,
                0.0005857142857142857,
                0.0005714285714285714,
                0.0005571428571428572,
                0.0005428571428571429,
                0.0005285714285714286,
                0.0005142857142857142,
                0.0005,
                0.00048571428571428577,
                0.0004714285714285714,
                0.0004571428571428572,
                0.00044285714285714284,
                0.0004285714285714286,
                0.00041428571428571426,
                0.0004,
                0.00038571428571428567,
                0.00037142857142857143,
                0.0003571428571428571,
                0.00034285714285714285,
                0.0003285714285714286,
                0.00031428571428571427,
                0.00030000000000000003,
                0.0002857142857142857,
                0.00027142857142857144,
                0.0002571428571428571,
                0.00024285714285714289,
                0.00022857142857142854,
                0.0002142857142857143,
                0.00019999999999999996,
                0.00018571428571428572,
                0.00017142857142857137,
                0.00015714285714285713,
                0.0001428571428571429,
                0.00012857142857142855,
                0.00011428571428571432,
                9.999999999999998e-05,
                8.571428571428574e-05,
                7.14285714285714e-05,
                5.714285714285716e-05,
                4.2857142857142816e-05,
                2.857142857142858e-05,
                1.4285714285714235e-05,
                0
            ],
            "train_loss": [
                3.2937450408935547,
                3.4188754558563232,
                3.190016984939575,
                3.2047677040100098,
                3.3621602058410645,
                3.4835264682769775,
                3.309394359588623,
                3.2523083686828613,
                3.1704256534576416,
                3.3121495246887207,
                3.119544506072998,
                3.3478269577026367,
                3.179461717605591,
                3.274303436279297,
                3.2117207050323486,
                3.1604812145233154,
                3.311765670776367,
                3.162616729736328,
                3.458949089050293,
                3.24928879737854,
                3.040630340576172,
                3.019926071166992,
                3.241624116897583,
                3.419546365737915,
                3.1371986865997314,
                3.260441780090332,
                3.343726396560669,
                3.426213026046753,
                3.1190342903137207,
                3.3493850231170654,
                2.965116500854492,
                3.3191184997558594,
                3.262239933013916,
                3.0521020889282227,
                3.247400999069214,
                3.3994686603546143,
                3.1247034072875977,
                3.167306661605835,
                3.131415843963623,
                3.1614317893981934,
                3.0766448974609375,
                3.173311948776245,
                3.3243401050567627,
                3.408417224884033,
                3.312058448791504,
                3.3760030269622803,
                3.2234365940093994,
                3.254518985748291,
                3.303117036819458,
                3.24633526802063,
                3.1286113262176514,
                3.0121562480926514,
                3.2692155838012695,
                3.1473186016082764,
                3.1791796684265137,
                3.2666289806365967,
                3.2763073444366455,
                3.173757791519165,
                3.3346657752990723,
                3.2073616981506348,
                3.094209909439087,
                3.1315770149230957,
                3.078479051589966,
                2.9664528369903564,
                3.267512083053589,
                3.1069939136505127,
                3.340867757797241,
                3.2964794635772705,
                3.17760968208313,
                3.034792423248291,
                3.172412633895874,
                3.1967005729675293,
                3.0921783447265625,
                3.36584210395813,
                3.2705681324005127,
                2.8839852809906006,
                2.90228533744812,
                3.2322685718536377,
                3.107680082321167,
                2.9276106357574463,
                3.171797752380371,
                3.0344347953796387,
                3.096806049346924,
                3.06728458404541,
                3.226224660873413,
                3.1110408306121826,
                3.048602342605591,
                3.044013500213623,
                3.2233057022094727,
                3.124603748321533,
                3.243802309036255,
                2.946345806121826,
                3.270364999771118,
                3.1945114135742188,
                3.160346031188965,
                3.1867730617523193,
                2.9319558143615723,
                2.9594807624816895,
                3.167177438735962,
                2.941791534423828
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}