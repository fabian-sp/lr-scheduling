{
    "summary": {
        "_wandb": {
            "runtime": 1724
        },
        "train/loss": 3.2606053352355957,
        "final-val/loss": 3.1275851726531982,
        "val/perplexity": 22.25056630220719,
        "train/perplexity": 26.065253451049298,
        "_step": 126,
        "_runtime": 1725.0926628112793,
        "parameters": 123587328,
        "final-val/acc": 0.4338463246822357,
        "final-val/perplexity": 22.81876146534591,
        "iter": 15000,
        "optimized_parameters": 123587328,
        "_timestamp": 1721153609.0788488,
        "iter_dt": 0.308732359,
        "val/acc": 0.43788087368011475,
        "val/loss": 3.102369546890259,
        "lr": 0
    },
    "config": {
        "lr": 0.002,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 15000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_sqrt_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/10000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.1,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.1",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.1_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_linear_0.1_iter15000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                15000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1275851726531982
            ],
            "final_val_perplexity": [
                22.81876146534591
            ]
        },
        "val": {
            "iter": [
                10000,
                10200,
                10400,
                10600,
                10800,
                11000,
                11200,
                11400,
                11600,
                11800,
                12000,
                12200,
                12400,
                12600,
                12800,
                13000,
                13200,
                13400,
                13600,
                13800,
                14000,
                14200,
                14400,
                14600,
                14800
            ],
            "val_perplexity": [
                26.79043346574121,
                26.727789599344586,
                26.652256174224004,
                26.636514649356425,
                26.586524958137,
                26.450748891163485,
                26.47192145671227,
                26.38177188692276,
                26.345786771942414,
                26.335154641723754,
                26.204029509201803,
                26.162360457062544,
                26.129970013783954,
                26.095952187870136,
                26.102436062631146,
                25.990018411803064,
                25.948831968484704,
                25.962483373100817,
                25.71492865122733,
                25.13106222672693,
                24.53855641927476,
                23.89243928369529,
                23.292954876196507,
                22.741513519765377,
                22.25056630220719
            ],
            "val_loss": [
                3.2880470752716064,
                3.285706043243408,
                3.2828760147094727,
                3.282285213470459,
                3.2804067134857178,
                3.2752866744995117,
                3.2760868072509766,
                3.2726755142211914,
                3.271310567855835,
                3.270906925201416,
                3.2659153938293457,
                3.2643239498138428,
                3.263085126876831,
                3.26178240776062,
                3.262030839920044,
                3.2577147483825684,
                3.2561287879943848,
                3.256654739379883,
                3.2470738887786865,
                3.224106788635254,
                3.2002477645874023,
                3.1735641956329346,
                3.148153066635132,
                3.1241941452026367,
                3.102369546890259
            ],
            "val_acc": [
                0.4164440929889679,
                0.41667723655700684,
                0.41736936569213867,
                0.41722410917282104,
                0.41728881001472473,
                0.4182165265083313,
                0.417999267578125,
                0.41819700598716736,
                0.41853517293930054,
                0.4184509217739105,
                0.41924434900283813,
                0.41905760765075684,
                0.41954100131988525,
                0.41938841342926025,
                0.41924193501472473,
                0.4198864698410034,
                0.4197668433189392,
                0.4194701910018921,
                0.42054444551467896,
                0.4233325123786926,
                0.4260790944099426,
                0.429290771484375,
                0.43275022506713867,
                0.4354516565799713,
                0.43788087368011475
            ]
        },
        "train": {
            "iter": [
                10050,
                10100,
                10150,
                10200,
                10250,
                10300,
                10350,
                10400,
                10450,
                10500,
                10550,
                10600,
                10650,
                10700,
                10750,
                10800,
                10850,
                10900,
                10950,
                11000,
                11050,
                11100,
                11150,
                11200,
                11250,
                11300,
                11350,
                11400,
                11450,
                11500,
                11550,
                11600,
                11650,
                11700,
                11750,
                11800,
                11850,
                11900,
                11950,
                12000,
                12050,
                12100,
                12150,
                12200,
                12250,
                12300,
                12350,
                12400,
                12450,
                12500,
                12550,
                12600,
                12650,
                12700,
                12750,
                12800,
                12850,
                12900,
                12950,
                13000,
                13050,
                13100,
                13150,
                13200,
                13250,
                13300,
                13350,
                13400,
                13450,
                13500,
                13550,
                13600,
                13650,
                13700,
                13750,
                13800,
                13850,
                13900,
                13950,
                14000,
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000
            ],
            "train_perplexity": [
                40.433003449461104,
                27.1758639958963,
                35.50539749040035,
                27.098566814964837,
                38.92353499645416,
                28.955480432017684,
                29.02978153423776,
                29.525048152070656,
                28.25823796004474,
                30.500310197051977,
                30.57109627023013,
                30.48325524055001,
                28.78522438550946,
                23.98829636263742,
                26.51209869003279,
                34.05233347781997,
                28.072785592912872,
                34.976504143241,
                32.77590620342611,
                33.57258476256628,
                32.65898550713286,
                27.925370955979982,
                27.03754877575582,
                31.168802393777977,
                32.91760501077757,
                31.486632486479152,
                29.77326423024991,
                27.57859369767396,
                40.44525771143194,
                30.24030045546802,
                34.784360272387026,
                35.164200806051355,
                35.224422798608224,
                31.097522051408948,
                30.81285898545065,
                22.927332119086657,
                33.39519103235796,
                34.64439577372555,
                30.840846601134125,
                26.538331053807926,
                22.756211875987983,
                20.185773335819178,
                27.629289345568708,
                28.50216383087951,
                26.379130261044196,
                29.363930043195474,
                23.528438115576247,
                21.144640087077264,
                30.189420174871476,
                28.215165673993337,
                35.42730791592537,
                36.111340273666286,
                36.47749109319563,
                26.80783821140441,
                29.16357877540149,
                28.073535226666355,
                22.359770453745732,
                27.123122503474747,
                38.94313947700593,
                25.475024043390803,
                26.017458592226966,
                26.52632469385607,
                24.88443930118601,
                31.064042631084604,
                33.670243187645696,
                25.596397847613954,
                28.096522552797556,
                27.191042581693782,
                29.26435740298101,
                32.92391553890714,
                31.19590838898563,
                30.278226371171478,
                34.46996682440559,
                31.3057923545764,
                23.04782969307862,
                27.375871497786722,
                38.32548180492564,
                32.42218074350215,
                32.8925004659407,
                27.37867821381376,
                29.55302155570318,
                25.030006087568623,
                31.16892129347005,
                25.198907878161133,
                23.203151124971065,
                27.004963296845666,
                27.294621298299827,
                19.57333085411738,
                27.711648097853047,
                23.530766220149353,
                21.49781462229322,
                24.195150544634533,
                25.99778998336653,
                24.853429526347707,
                28.893670249508965,
                26.094384352544235,
                25.94474289556092,
                21.981269759681354,
                25.241040303108065,
                26.065253451049298
            ],
            "train_lr": [
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.0019333333333333333,
                0.0018666666666666666,
                0.0018000000000000002,
                0.0017333333333333335,
                0.0016666666666666668,
                0.0016,
                0.0015333333333333332,
                0.001466666666666667,
                0.0014,
                0.0013333333333333335,
                0.0012666666666666666,
                0.0012,
                0.0011333333333333334,
                0.0010666666666666667,
                0.001,
                0.0009333333333333333,
                0.0008666666666666667,
                0.0008,
                0.0007333333333333334,
                0.0006666666666666668,
                0.0006000000000000001,
                0.0005333333333333335,
                0.00046666666666666655,
                0.0003999999999999999,
                0.00033333333333333327,
                0.0002666666666666666,
                0.00019999999999999996,
                0.0001333333333333333,
                6.666666666666666e-05,
                0
            ],
            "train_loss": [
                3.699648857116699,
                3.3023314476013184,
                3.5696871280670166,
                3.299483060836792,
                3.6616015434265137,
                3.3657617568969727,
                3.3683245182037354,
                3.3852412700653076,
                3.3413872718811035,
                3.417739152908325,
                3.4200572967529297,
                3.417179822921753,
                3.3598644733428955,
                3.177568197250366,
                3.2776033878326416,
                3.5279009342193604,
                3.3348028659820557,
                3.5546789169311523,
                3.4896960258483887,
                3.513712167739868,
                3.4861223697662354,
                3.329537868499756,
                3.2972288131713867,
                3.439419984817505,
                3.4940099716186523,
                3.4495654106140137,
                3.39361310005188,
                3.317042112350464,
                3.6999518871307373,
                3.409177780151367,
                3.5491702556610107,
                3.560030937194824,
                3.561742067337036,
                3.4371304512023926,
                3.427934408187866,
                3.1323318481445312,
                3.5084142684936523,
                3.545138359069824,
                3.428842306137085,
                3.278592348098755,
                3.124840259552002,
                3.0049800872802734,
                3.318878650665283,
                3.349982261657715,
                3.2725753784179688,
                3.3797693252563477,
                3.1582119464874268,
                3.0513885021209717,
                3.407493829727173,
                3.3398618698120117,
                3.5674853324890137,
                3.586609363555908,
                3.5966978073120117,
                3.288696527481079,
                3.372922897338867,
                3.334829568862915,
                3.1072654724121094,
                3.300388813018799,
                3.662105083465576,
                3.2377007007598877,
                3.258769989013672,
                3.27813982963562,
                3.214244842529297,
                3.4360532760620117,
                3.5166168212890625,
                3.2424538135528564,
                3.3356480598449707,
                3.302889823913574,
                3.3763725757598877,
                3.49420166015625,
                3.440289258956909,
                3.410431146621704,
                3.540090799331665,
                3.443805456161499,
                3.137573719024658,
                3.309664249420166,
                3.6461174488067627,
                3.4788451194763184,
                3.4932470321655273,
                3.3097667694091797,
                3.386188268661499,
                3.2200775146484375,
                3.4394237995147705,
                3.2268028259277344,
                3.1442902088165283,
                3.296022891998291,
                3.306691884994507,
                2.974169969558716,
                3.321855068206787,
                3.158310890197754,
                3.06795334815979,
                3.186154365539551,
                3.2580137252807617,
                3.2129979133605957,
                3.3636248111724854,
                3.2617223262786865,
                3.2559711933135986,
                3.0901927947998047,
                3.228473424911499,
                3.2606053352355957
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}