{
    "summary": {
        "_runtime": 1564.7439744472504,
        "_timestamp": 1720847378.7129724,
        "val/perplexity": 20.79493234211518,
        "lr": 0,
        "_wandb": {
            "runtime": 1564
        },
        "iter_dt": 0.287742212,
        "_step": 126,
        "val/loss": 3.0347113609313965,
        "iter": 25000,
        "train/perplexity": 22.89906692906728,
        "final-val/perplexity": 21.422985087104465,
        "final-val/acc": 0.44071468710899353,
        "final-val/loss": 3.0644664764404297,
        "optimized_parameters": 123587328,
        "val/acc": 0.44539061188697815,
        "parameters": 123587328,
        "train/loss": 3.13109827041626
    },
    "config": {
        "lr": 0.002,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_sqrt_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.1,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.1",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.1_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_linear_0.1_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.0644664764404297
            ],
            "final_val_perplexity": [
                21.422985087104465
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                24.963043703144475,
                24.97429485527751,
                24.9342781130421,
                24.922581508321127,
                24.910355866823064,
                24.867868274297937,
                24.924881169369357,
                24.795249913327883,
                24.84168792932578,
                24.84630807735317,
                24.77969534648276,
                24.762414754664764,
                24.801765401213093,
                24.648756369974155,
                24.328174684537046,
                23.98635761466519,
                23.61908975031122,
                23.215014890547845,
                22.82288022967829,
                22.50197151038567,
                22.105811050945714,
                21.74470101242881,
                21.424185414774122,
                21.092964763743815,
                20.79493234211518
            ],
            "val_loss": [
                3.2173986434936523,
                3.2178492546081543,
                3.216245651245117,
                3.2157764434814453,
                3.2152857780456543,
                3.213578701019287,
                3.2158687114715576,
                3.2106542587280273,
                3.2125253677368164,
                3.2127113342285156,
                3.210026741027832,
                3.209329128265381,
                3.2109169960021973,
                3.204728603363037,
                3.1916372776031494,
                3.177487373352051,
                3.162057399749756,
                3.144801378250122,
                3.127765655517578,
                3.11360502243042,
                3.0958425998687744,
                3.0793721675872803,
                3.0645225048065186,
                3.0489416122436523,
                3.0347113609313965
            ],
            "val_acc": [
                0.42396479845046997,
                0.4241039752960205,
                0.42409422993659973,
                0.4239501953125,
                0.42415040731430054,
                0.4243713319301605,
                0.4243432283401489,
                0.4246496260166168,
                0.42454099655151367,
                0.4242956340312958,
                0.42478638887405396,
                0.4246801733970642,
                0.42431026697158813,
                0.42571043968200684,
                0.4266931116580963,
                0.4281872510910034,
                0.43037474155426025,
                0.4320165812969208,
                0.4339929223060608,
                0.4357055425643921,
                0.4377990663051605,
                0.43988037109375,
                0.4414147734642029,
                0.44359129667282104,
                0.44539061188697815
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                24.301600702508278,
                22.801820870213316,
                26.260943689442694,
                26.68941074143397,
                21.0015259829619,
                31.542052783866573,
                28.582497006902074,
                20.509343740075423,
                27.434127341535085,
                26.89836628250912,
                26.520418395157478,
                31.281544148362247,
                24.06818405692014,
                30.0856352019834,
                27.929852097517287,
                26.04086077970288,
                28.813417364017216,
                27.3961124040437,
                27.62214960090574,
                30.556077924071072,
                36.80158628206282,
                27.327074157582302,
                26.88802399591136,
                26.353884638742308,
                29.040850698198685,
                22.213674503612104,
                22.078390200256635,
                28.749175429300802,
                24.676633640176597,
                27.725261793386725,
                26.01110745321453,
                30.103953367704293,
                30.01678187293254,
                25.683104399816436,
                23.849623693564297,
                30.210725724503124,
                30.57713921000632,
                27.244390318240733,
                23.213675486500073,
                29.6693678034393,
                34.43462993062533,
                28.95962284021342,
                26.31238505544293,
                27.136841740837756,
                27.967707457271832,
                30.225055478104903,
                31.67470160105824,
                36.94216193610952,
                26.226373926160196,
                29.125375487194315,
                22.73842861347018,
                36.30789684572754,
                23.475324633843947,
                27.433152779457792,
                23.232240311870857,
                24.70316421328347,
                32.37372641396098,
                22.086355909846652,
                30.068195596509163,
                26.531156948336903,
                28.757340098989005,
                29.71406492973976,
                27.808284532934536,
                25.768906600912636,
                30.40288536394547,
                22.80250586363569,
                28.476638001215306,
                21.891485848276016,
                25.145338528924555,
                31.195506756897018,
                28.20973076923703,
                24.816120884942197,
                23.7706258028135,
                27.258911773451587,
                24.426327365460676,
                20.889331086936505,
                24.4773436463401,
                25.28616088913643,
                19.900364518531795,
                26.431779901877206,
                22.854789089720544,
                23.70381108756365,
                27.011982152727825,
                19.83527546283165,
                24.718611806655254,
                24.277793446402992,
                23.3356000842315,
                23.66506271347354,
                27.98713813623813,
                30.6633353129641,
                17.882322114391464,
                23.435401994559662,
                27.181080273801918,
                24.129449375647265,
                24.875992273238353,
                21.13388978838397,
                29.07233676042624,
                23.017566484802636,
                22.42949622560556,
                22.899066929067278
            ],
            "train_lr": [
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.00196,
                0.00192,
                0.00188,
                0.00184,
                0.0018000000000000002,
                0.00176,
                0.00172,
                0.00168,
                0.0016400000000000002,
                0.0016,
                0.0015600000000000002,
                0.00152,
                0.00148,
                0.0014399999999999999,
                0.0014,
                0.0013599999999999999,
                0.0013199999999999998,
                0.00128,
                0.00124,
                0.0012,
                0.0011600000000000002,
                0.0011200000000000001,
                0.00108,
                0.0010400000000000001,
                0.001,
                0.00096,
                0.0009199999999999999,
                0.0008799999999999999,
                0.0008400000000000001,
                0.0008,
                0.00076,
                0.0007199999999999999,
                0.0006799999999999999,
                0.0006399999999999999,
                0.0006000000000000001,
                0.0005600000000000001,
                0.0005200000000000001,
                0.00048,
                0.00043999999999999996,
                0.0003999999999999999,
                0.00036000000000000013,
                0.0003200000000000001,
                0.00028000000000000003,
                0.00024,
                0.00019999999999999996,
                0.00015999999999999993,
                0.00012000000000000011,
                8.000000000000007e-05,
                4.000000000000004e-05,
                0
            ],
            "train_loss": [
                3.190544366836548,
                3.126842498779297,
                3.26808500289917,
                3.284269094467163,
                3.0445971488952637,
                3.451323986053467,
                3.352796792984009,
                3.0208826065063477,
                3.3117899894714355,
                3.292067766189575,
                3.2779171466827393,
                3.443030595779419,
                3.1808929443359375,
                3.40405011177063,
                3.329698324203491,
                3.259669065475464,
                3.3608434200286865,
                3.310403347015381,
                3.318620204925537,
                3.4195659160614014,
                3.605543375015259,
                3.307880163192749,
                3.2916831970214844,
                3.271617889404297,
                3.3687057495117188,
                3.100710153579712,
                3.0946013927459717,
                3.3586113452911377,
                3.2058589458465576,
                3.3223462104797363,
                3.258525848388672,
                3.404658794403076,
                3.401758909225464,
                3.245835542678833,
                3.1717705726623535,
                3.4081993103027344,
                3.420254945755005,
                3.304849863052368,
                3.1447436809539795,
                3.3901174068450928,
                3.53906512260437,
                3.3659048080444336,
                3.2700419425964355,
                3.3008944988250732,
                3.331052780151367,
                3.4086735248565674,
                3.4555206298828125,
                3.609355926513672,
                3.266767740249634,
                3.371612071990967,
                3.124058485031128,
                3.5920376777648926,
                3.155951976776123,
                3.3117544651031494,
                3.145543098449707,
                3.2069334983825684,
                3.4773495197296143,
                3.0949621200561523,
                3.403470277786255,
                3.2783219814300537,
                3.3588953018188477,
                3.39162278175354,
                3.325336217880249,
                3.2491707801818848,
                3.4145398139953613,
                3.1268725395202637,
                3.349086284637451,
                3.086099863052368,
                3.224674701690674,
                3.4402763843536377,
                3.3396692276000977,
                3.2114956378936768,
                3.168452739715576,
                3.30538272857666,
                3.1956636905670166,
                3.039240598678589,
                3.1977500915527344,
                3.230259418487549,
                2.9907400608062744,
                3.274569272994995,
                3.1291627883911133,
                3.165637969970703,
                3.2962827682495117,
                2.98746395111084,
                3.2075586318969727,
                3.1895642280578613,
                3.149982213973999,
                3.164001941680908,
                3.33174729347229,
                3.423069953918457,
                2.883814573287964,
                3.154249906539917,
                3.302523374557495,
                3.1834352016448975,
                3.2139053344726562,
                3.050879955291748,
                3.3697893619537354,
                3.1362597942352295,
                3.1103789806365967,
                3.1310982704162598
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}