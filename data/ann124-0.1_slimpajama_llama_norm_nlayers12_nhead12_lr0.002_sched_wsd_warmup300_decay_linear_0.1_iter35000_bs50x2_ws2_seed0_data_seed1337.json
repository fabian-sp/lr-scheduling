{
    "summary": {
        "val/loss": 2.99813461303711,
        "parameters": 123587328,
        "val/perplexity": 20.04806411721518,
        "lr": 0,
        "val/acc": 0.4493066370487213,
        "_runtime": 1926.8089020252228,
        "train/loss": 2.9502956867218018,
        "train/perplexity": 19.11156601295468,
        "final-val/perplexity": 20.68647465587166,
        "optimized_parameters": 123587328,
        "iter": 35000,
        "_wandb": {
            "runtime": 1927
        },
        "_timestamp": 1721150903.556606,
        "final-val/loss": 3.029482126235962,
        "_step": 126,
        "iter_dt": 0.313054359,
        "final-val/acc": 0.4444630444049835
    },
    "config": {
        "lr": 0.002,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 35000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_sqrt_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/30000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.1,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.1",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.1_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_linear_0.1_iter35000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                35000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.029482126235962
            ],
            "final_val_perplexity": [
                20.68647465587166
            ]
        },
        "val": {
            "iter": [
                30000,
                30200,
                30400,
                30600,
                30800,
                31000,
                31200,
                31400,
                31600,
                31800,
                32000,
                32200,
                32400,
                32600,
                32800,
                33000,
                33200,
                33400,
                33600,
                33800,
                34000,
                34200,
                34400,
                34600,
                34800
            ],
            "val_perplexity": [
                24.237060847065532,
                24.1971869353718,
                24.262008171292422,
                24.204612848459096,
                24.209495459249673,
                24.18440608597178,
                24.12349010190141,
                24.222895954539112,
                24.120349995826874,
                23.839572628937677,
                23.623995057489825,
                23.37910929020456,
                23.07605843529675,
                22.802103563417646,
                22.557200919994084,
                22.2695077079417,
                22.037984713947274,
                21.77497267182463,
                21.47051831027429,
                21.22547471882205,
                20.952413279371772,
                20.710324927057222,
                20.46424094427662,
                20.24486286694316,
                20.04806411721518
            ],
            "val_loss": [
                3.187885046005249,
                3.1862385272979736,
                3.1889138221740723,
                3.1865453720092773,
                3.1867470741271973,
                3.1857101917266846,
                3.1831881999969482,
                3.187300443649292,
                3.183058023452759,
                3.171349048614502,
                3.1622650623321533,
                3.1518449783325195,
                3.1387977600097656,
                3.12685489654541,
                3.116056442260742,
                3.1032204627990723,
                3.0927696228027344,
                3.080763339996338,
                3.066682815551758,
                3.055204153060913,
                3.0422558784484863,
                3.0306344032287598,
                3.018681049346924,
                3.0079030990600586,
                2.9981346130371094
            ],
            "val_acc": [
                0.4271789491176605,
                0.42699217796325684,
                0.42653441429138184,
                0.4269506633281708,
                0.42686766386032104,
                0.42680054903030396,
                0.4273070991039276,
                0.42677488923072815,
                0.4272692799568176,
                0.42885130643844604,
                0.4294384717941284,
                0.43131470680236816,
                0.4328259229660034,
                0.4341979920864105,
                0.4350842237472534,
                0.43708986043930054,
                0.4378308057785034,
                0.43925535678863525,
                0.4409533739089966,
                0.4426965117454529,
                0.4439978003501892,
                0.4456799030303955,
                0.44706419110298157,
                0.4483691453933716,
                0.4493066370487213
            ]
        },
        "train": {
            "iter": [
                30050,
                30100,
                30150,
                30200,
                30250,
                30300,
                30350,
                30400,
                30450,
                30500,
                30550,
                30600,
                30650,
                30700,
                30750,
                30800,
                30850,
                30900,
                30950,
                31000,
                31050,
                31100,
                31150,
                31200,
                31250,
                31300,
                31350,
                31400,
                31450,
                31500,
                31550,
                31600,
                31650,
                31700,
                31750,
                31800,
                31850,
                31900,
                31950,
                32000,
                32050,
                32100,
                32150,
                32200,
                32250,
                32300,
                32350,
                32400,
                32450,
                32500,
                32550,
                32600,
                32650,
                32700,
                32750,
                32800,
                32850,
                32900,
                32950,
                33000,
                33050,
                33100,
                33150,
                33200,
                33250,
                33300,
                33350,
                33400,
                33450,
                33500,
                33550,
                33600,
                33650,
                33700,
                33750,
                33800,
                33850,
                33900,
                33950,
                34000,
                34050,
                34100,
                34150,
                34200,
                34250,
                34300,
                34350,
                34400,
                34450,
                34500,
                34550,
                34600,
                34650,
                34700,
                34750,
                34800,
                34850,
                34900,
                34950,
                35000
            ],
            "train_perplexity": [
                28.068428743018913,
                32.43963215018331,
                25.339728170064735,
                25.639983444028232,
                30.30520814742668,
                34.46780548584786,
                28.997366739599244,
                27.297790654491898,
                25.15958095153021,
                28.893050265675196,
                23.989028438023848,
                29.825846566658683,
                25.418449564444767,
                27.413440050119483,
                26.285166499356635,
                24.96353174316645,
                28.798479749918723,
                24.902796555445963,
                33.51549849740573,
                27.24339001967787,
                21.97954038365358,
                21.4145795705882,
                27.208824355438992,
                32.16159475399288,
                24.197596541746965,
                27.263194968482345,
                30.090563435674078,
                32.66892259729455,
                23.94109612190795,
                30.314479650699088,
                20.42789991787368,
                29.154422935009542,
                27.394864870529407,
                22.13745099707833,
                26.880979669255325,
                31.510603928900917,
                23.84008985973065,
                24.647545795894008,
                23.985019455261305,
                24.732182073388714,
                22.843501544447594,
                24.72810195742083,
                29.441658737882314,
                31.689861755244312,
                28.624642237524373,
                30.48235405045191,
                26.271007193095624,
                27.125411794881927,
                28.476013387405356,
                26.703642755194192,
                23.833486063533975,
                21.012755015525414,
                27.552653414146484,
                24.19909656794206,
                24.824506152262806,
                27.296599662290802,
                27.41271457825695,
                24.755036084514032,
                28.873362367965168,
                25.493889910546173,
                23.03655116291391,
                23.80750352159944,
                22.411850726008964,
                20.188184622567483,
                27.06215885781282,
                23.351111092940045,
                29.27740760452974,
                27.98510972438522,
                24.760372118660957,
                21.417178494052425,
                24.791147571601098,
                25.141148294911403,
                22.502100267981227,
                29.834245876927586,
                27.156595131455354,
                18.22579153161387,
                18.582032846639233,
                25.81500772312439,
                22.859219558269675,
                19.076608280844898,
                24.30331577199215,
                21.298827249454554,
                22.717723410885768,
                22.047107999762893,
                25.77545055947594,
                23.084571223740138,
                21.462692836136068,
                21.40414110175762,
                25.267990930706212,
                23.11559488362642,
                25.970147642725077,
                19.32536620372058,
                26.900367233508216,
                24.74352974917077,
                23.871423128666862,
                24.65063111415357,
                19.27406973485753,
                19.586747381000002,
                24.09963324615699,
                19.11156601295468
            ],
            "train_lr": [
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.0019714285714285715,
                0.0019428571428571429,
                0.0019142857142857145,
                0.0018857142857142857,
                0.0018571428571428573,
                0.0018285714285714285,
                0.0018000000000000002,
                0.0017714285714285714,
                0.001742857142857143,
                0.0017142857142857144,
                0.0016857142857142858,
                0.001657142857142857,
                0.0016285714285714287,
                0.0016,
                0.0015714285714285715,
                0.001542857142857143,
                0.0015142857142857143,
                0.0014857142857142857,
                0.0014571428571428574,
                0.0014285714285714286,
                0.0014,
                0.0013714285714285714,
                0.001342857142857143,
                0.0013142857142857142,
                0.0012857142857142856,
                0.001257142857142857,
                0.0012285714285714287,
                0.0012,
                0.0011714285714285713,
                0.0011428571428571427,
                0.0011142857142857144,
                0.0010857142857142858,
                0.0010571428571428572,
                0.0010285714285714284,
                0.001,
                0.0009714285714285715,
                0.0009428571428571429,
                0.0009142857142857144,
                0.0008857142857142857,
                0.0008571428571428572,
                0.0008285714285714285,
                0.0008,
                0.0007714285714285713,
                0.0007428571428571429,
                0.0007142857142857142,
                0.0006857142857142857,
                0.0006571428571428572,
                0.0006285714285714285,
                0.0006000000000000001,
                0.0005714285714285714,
                0.0005428571428571429,
                0.0005142857142857142,
                0.00048571428571428577,
                0.0004571428571428571,
                0.0004285714285714286,
                0.0003999999999999999,
                0.00037142857142857143,
                0.00034285714285714274,
                0.00031428571428571427,
                0.0002857142857142858,
                0.0002571428571428571,
                0.00022857142857142865,
                0.00019999999999999996,
                0.00017142857142857148,
                0.0001428571428571428,
                0.00011428571428571432,
                8.571428571428563e-05,
                5.714285714285716e-05,
                2.857142857142847e-05,
                0
            ],
            "train_loss": [
                3.3346476554870605,
                3.4793832302093506,
                3.2323756217956543,
                3.244155168533325,
                3.4113218784332275,
                3.5400280952453613,
                3.3672072887420654,
                3.3068079948425293,
                3.22524094581604,
                3.363603353500366,
                3.177598714828491,
                3.3953776359558105,
                3.2354774475097656,
                3.311035633087158,
                3.2690069675445557,
                3.2174181938171387,
                3.3603248596191406,
                3.214982271194458,
                3.512010335922241,
                3.3048131465911865,
                3.090114116668701,
                3.0640740394592285,
                3.3035435676574707,
                3.4707753658294678,
                3.18625545501709,
                3.305539846420288,
                3.4042139053344727,
                3.486426591873169,
                3.175598621368408,
                3.411627769470215,
                3.0169036388397217,
                3.3726089000701904,
                3.3103578090667725,
                3.0972728729248047,
                3.2914211750030518,
                3.450326442718506,
                3.1713707447052,
                3.204679489135742,
                3.177431583404541,
                3.2081074714660645,
                3.128668785095215,
                3.207942485809326,
                3.382412910461426,
                3.4559991359710693,
                3.3542702198028564,
                3.4171502590179443,
                3.268468141555786,
                3.300473213195801,
                3.349064350128174,
                3.284802198410034,
                3.171093702316284,
                3.0451316833496094,
                3.31610107421875,
                3.1863174438476562,
                3.2118334770202637,
                3.3067643642425537,
                3.311009168624878,
                3.209031105041504,
                3.362921714782715,
                3.238440990447998,
                3.1370842456817627,
                3.1700029373168945,
                3.1095919609069824,
                3.0050995349884033,
                3.2981386184692383,
                3.150646686553955,
                3.3768184185028076,
                3.331674814224243,
                3.2092466354370117,
                3.064195394515991,
                3.210488796234131,
                3.224508047103882,
                3.1136107444763184,
                3.3956592082977295,
                3.301622152328491,
                2.9028396606445312,
                2.922197103500366,
                3.250958204269409,
                3.129356622695923,
                2.948464870452881,
                3.190614938735962,
                3.0586540699005127,
                3.123147487640381,
                3.0931835174560547,
                3.249424695968628,
                3.1391665935516357,
                3.0663182735443115,
                3.063586473464966,
                3.2295405864715576,
                3.140509605407715,
                3.2569499015808105,
                2.9614205360412598,
                3.292142152786255,
                3.208566188812256,
                3.1726841926574707,
                3.2048046588897705,
                2.9587626457214355,
                2.9748551845550537,
                3.1821987628936768,
                2.9502956867218018
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}