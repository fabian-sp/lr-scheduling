{
    "summary": {
        "_runtime": 1671.267385005951,
        "val/loss": 3.151388168334961,
        "_timestamp": 1720816225.056584,
        "train/loss": 3.2474827766418457,
        "final-val/acc": 0.4302406311035156,
        "optimized_parameters": 123587328,
        "lr": 0,
        "iter_dt": 0.286874968,
        "val/acc": 0.4357702434062958,
        "_step": 126,
        "final-val/loss": 3.1887807846069336,
        "val/perplexity": 23.368431925478095,
        "train/perplexity": 25.725445316302583,
        "final-val/perplexity": 24.258780629619334,
        "iter": 25000,
        "_wandb": {
            "runtime": 1671
        },
        "parameters": 123587328
    },
    "config": {
        "lr": 0.0001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.0001_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.0001_sched_wsd_warmup300_decay_linear_0.2_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1887807846069336
            ],
            "final_val_perplexity": [
                24.258780629619338
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                25.793794785133898,
                25.647729841109623,
                25.56542732881547,
                25.479288148116428,
                25.337227129920205,
                25.205601549554828,
                25.04426080845719,
                24.9741221802497,
                24.846722748037255,
                24.7510230113716,
                24.62662871324335,
                24.519877214804193,
                24.42193087797831,
                24.30768511073254,
                24.204543598651906,
                24.102178768410408,
                23.999823423440155,
                23.906992313519776,
                23.80382566223386,
                23.718577207389924,
                23.641986143635428,
                23.556620847895886,
                23.487753151199794,
                23.429061117798135,
                23.368431925478095
            ],
            "val_loss": [
                3.250136137008667,
                3.244457244873047,
                3.2412431240081787,
                3.237868070602417,
                3.2322769165039062,
                3.2270684242248535,
                3.220646858215332,
                3.2178423404693604,
                3.2127280235290527,
                3.208868980407715,
                3.2038304805755615,
                3.199486255645752,
                3.195483684539795,
                3.1907947063446045,
                3.186542510986328,
                3.1823043823242188,
                3.178048610687256,
                3.17417311668396,
                3.1698484420776367,
                3.1662607192993164,
                3.1630263328552246,
                3.1594090461730957,
                3.1564812660217285,
                3.1539793014526367,
                3.151388168334961
            ],
            "val_acc": [
                0.4240441918373108,
                0.42469847202301025,
                0.42491698265075684,
                0.4252978265285492,
                0.42618653178215027,
                0.4265991151332855,
                0.42729735374450684,
                0.42787107825279236,
                0.4285241365432739,
                0.4285925328731537,
                0.42948850989341736,
                0.4296850562095642,
                0.430206298828125,
                0.43052855134010315,
                0.4313366711139679,
                0.4317407011985779,
                0.43229490518569946,
                0.4326831102371216,
                0.43321654200553894,
                0.43388426303863525,
                0.43425536155700684,
                0.4349633753299713,
                0.43480345606803894,
                0.43552732467651367,
                0.4357702434062958
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                24.913230551106647,
                23.69540325842622,
                27.144930349695148,
                27.167273899449025,
                21.931094623791914,
                32.273633683768296,
                29.20290438114942,
                21.02543370341893,
                28.169808271885433,
                27.284295785161643,
                26.913986631859867,
                31.901133198181608,
                24.369838965856992,
                30.551845555649127,
                28.07994809046909,
                26.49837940931643,
                29.213642545783568,
                27.82043999208137,
                28.27783677645853,
                31.069716328939663,
                36.8627843420338,
                27.633709798569214,
                27.336998727438058,
                26.17712899612343,
                29.034813707900025,
                22.156745124724186,
                21.754703898980733,
                28.99200926717388,
                24.236852819736306,
                27.97320244268576,
                25.90819877117527,
                30.365831333252693,
                30.018320571407948,
                26.11964916441114,
                24.118785846433006,
                30.10406820531468,
                30.251831194808045,
                27.38703479275407,
                22.92193751744563,
                29.627379623288075,
                34.37200474212047,
                28.88347664897311,
                26.229050282766714,
                27.52354815441856,
                27.759312062301213,
                29.88871736465166,
                30.989433037573104,
                36.46665635805012,
                26.11131199937007,
                28.311735413152807,
                22.559723367489017,
                36.125144113966606,
                23.08147830268067,
                26.93063051292982,
                23.032097307320523,
                25.00175941578911,
                32.24508385729116,
                21.940477055948953,
                30.443736944427076,
                26.50761117928059,
                29.26123180141493,
                29.99268112415802,
                28.025411908349298,
                26.004286667844884,
                30.867608513793087,
                23.510028961679154,
                29.11859890632251,
                22.495175228316516,
                26.025908506406502,
                32.39643446125516,
                29.188245015098744,
                25.9476194076372,
                25.107328301750222,
                28.637004332710244,
                25.689497946933756,
                22.186479549509297,
                25.97100831183974,
                26.541798600681403,
                20.759137436455735,
                28.560153876877017,
                24.394672863972083,
                25.490668661224383,
                29.241341824279253,
                21.2681120860132,
                26.660645287413214,
                26.435630596298644,
                25.63216605232426,
                26.134742527026376,
                30.8852835070649,
                33.64002479126011,
                19.575491628896557,
                26.344511694671926,
                30.203703817064394,
                27.31137033670551,
                27.88425529104391,
                23.764137566969158,
                32.43664688411237,
                25.904671948937903,
                25.484409661508174,
                25.725445316302586
            ],
            "train_lr": [
                9.900000000000001e-05,
                9.8e-05,
                9.7e-05,
                9.6e-05,
                9.5e-05,
                9.4e-05,
                9.3e-05,
                9.200000000000001e-05,
                9.1e-05,
                9e-05,
                8.900000000000001e-05,
                8.800000000000001e-05,
                8.7e-05,
                8.6e-05,
                8.5e-05,
                8.4e-05,
                8.3e-05,
                8.200000000000001e-05,
                8.1e-05,
                8e-05,
                7.900000000000001e-05,
                7.800000000000001e-05,
                7.7e-05,
                7.6e-05,
                7.500000000000001e-05,
                7.4e-05,
                7.3e-05,
                7.2e-05,
                7.1e-05,
                7e-05,
                6.9e-05,
                6.8e-05,
                6.7e-05,
                6.599999999999999e-05,
                6.500000000000001e-05,
                6.400000000000001e-05,
                6.3e-05,
                6.2e-05,
                6.1e-05,
                6e-05,
                5.900000000000001e-05,
                5.800000000000001e-05,
                5.700000000000001e-05,
                5.6000000000000006e-05,
                5.500000000000001e-05,
                5.4000000000000005e-05,
                5.300000000000001e-05,
                5.2000000000000004e-05,
                5.1000000000000006e-05,
                5e-05,
                4.9e-05,
                4.8e-05,
                4.7e-05,
                4.6e-05,
                4.4999999999999996e-05,
                4.4e-05,
                4.300000000000001e-05,
                4.2000000000000004e-05,
                4.100000000000001e-05,
                4e-05,
                3.9000000000000006e-05,
                3.8e-05,
                3.7e-05,
                3.6e-05,
                3.5e-05,
                3.4e-05,
                3.2999999999999996e-05,
                3.2e-05,
                3.100000000000001e-05,
                3.0000000000000008e-05,
                2.9000000000000004e-05,
                2.8000000000000003e-05,
                2.7000000000000002e-05,
                2.6000000000000002e-05,
                2.5e-05,
                2.4e-05,
                2.3e-05,
                2.2e-05,
                2.1e-05,
                1.9999999999999995e-05,
                1.8999999999999994e-05,
                1.8000000000000007e-05,
                1.7000000000000003e-05,
                1.6000000000000003e-05,
                1.5000000000000004e-05,
                1.4000000000000001e-05,
                1.3000000000000001e-05,
                1.2e-05,
                1.1e-05,
                9.999999999999997e-06,
                8.999999999999997e-06,
                7.999999999999996e-06,
                6.999999999999996e-06,
                6.000000000000005e-06,
                5.000000000000005e-06,
                4.000000000000004e-06,
                3.0000000000000026e-06,
                2.000000000000002e-06,
                1.000000000000001e-06,
                0
            ],
            "train_loss": [
                3.2154011726379395,
                3.165283203125,
                3.30119252204895,
                3.3020153045654297,
                3.087907552719116,
                3.474252939224243,
                3.374270439147949,
                3.0457348823547363,
                3.3382530212402344,
                3.3063135147094727,
                3.2926483154296875,
                3.46264386177063,
                3.1933484077453613,
                3.4194273948669434,
                3.3350579738616943,
                3.277085781097412,
                3.374638080596924,
                3.325773239135742,
                3.342080593109131,
                3.4362359046936035,
                3.6072049140930176,
                3.3190386295318604,
                3.3082432746887207,
                3.264888286590576,
                3.368497848510742,
                3.098144054412842,
                3.079832077026367,
                3.3670225143432617,
                3.1878764629364014,
                3.331249237060547,
                3.25456166267395,
                3.413320302963257,
                3.4018101692199707,
                3.2626900672912598,
                3.182993173599243,
                3.404662609100342,
                3.4095590114593506,
                3.3100719451904297,
                3.132096529006958,
                3.3887012004852295,
                3.5372447967529297,
                3.363271951675415,
                3.2668697834014893,
                3.3150441646575928,
                3.323573589324951,
                3.3974833488464355,
                3.4336485862731934,
                3.596400737762451,
                3.2623708248138428,
                3.343278646469116,
                3.116168260574341,
                3.586991548538208,
                3.1390326023101807,
                3.293266534805298,
                3.1368908882141113,
                3.2189483642578125,
                3.473367929458618,
                3.0883352756500244,
                3.4158825874328613,
                3.2774341106414795,
                3.37626576423645,
                3.4009556770324707,
                3.3331139087677,
                3.25826358795166,
                3.4297096729278564,
                3.1574292182922363,
                3.3713793754577637,
                3.1133029460906982,
                3.259094715118408,
                3.478050708770752,
                3.3737683296203613,
                3.256082057952881,
                3.2231619358062744,
                3.3547019958496094,
                3.246084451675415,
                3.099485158920288,
                3.2569830417633057,
                3.2787230014801025,
                3.0329885482788086,
                3.3520147800445557,
                3.194366931915283,
                3.238314628601074,
                3.3755857944488525,
                3.057210922241211,
                3.2831907272338867,
                3.274714946746826,
                3.2438502311706543,
                3.263267755508423,
                3.4302821159362793,
                3.515718936920166,
                2.97428035736084,
                3.2712621688842773,
                3.4079668521881104,
                3.307305335998535,
                3.328064441680908,
                3.168179750442505,
                3.4792912006378174,
                3.254425525665283,
                3.2380690574645996,
                3.2474827766418457
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}