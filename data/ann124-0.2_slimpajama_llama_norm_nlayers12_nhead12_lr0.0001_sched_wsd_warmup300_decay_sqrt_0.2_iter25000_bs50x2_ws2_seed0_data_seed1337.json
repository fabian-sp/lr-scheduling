{
    "summary": {
        "parameters": 123587328,
        "final-val/loss": 3.1926212310791016,
        "train/perplexity": 25.805635705002377,
        "iter": 25000,
        "_timestamp": 1720083518.6308773,
        "_runtime": 1651.9076063632965,
        "val/perplexity": 23.444159135437268,
        "lr": 0,
        "iter_dt": 0.287624965,
        "final-val/perplexity": 24.352124241164212,
        "val/acc": 0.4355517625808716,
        "final-val/acc": 0.4299546480178833,
        "val/loss": 3.154623508453369,
        "train/loss": 3.2505950927734375,
        "optimized_parameters": 123587328,
        "_step": 126,
        "_wandb": {
            "runtime": 1651
        }
    },
    "config": {
        "lr": 0.0001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "sqrt",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.0001_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": 1e-07,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.0001_sched_wsd_warmup300_decay_sqrt_0.2_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1926212310791016
            ],
            "final_val_perplexity": [
                24.352124241164212
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                25.793794785133898,
                25.423801307803917,
                25.24208744445955,
                25.106466325417344,
                24.93667397897822,
                24.79139582082453,
                24.63526711895776,
                24.55106785667082,
                24.436421899179656,
                24.35546872389986,
                24.249135269122387,
                24.180975554628475,
                24.090010958564672,
                23.99974903755608,
                23.936273349184138,
                23.861334432071637,
                23.798014894619,
                23.74380035727838,
                23.67916109404199,
                23.626574835497426,
                23.58647370504979,
                23.535703685996513,
                23.503572630394757,
                23.470545325305658,
                23.444159135437268
            ],
            "val_loss": [
                3.250136137008667,
                3.2356879711151123,
                3.2285149097442627,
                3.223127603530884,
                3.216341733932495,
                3.210498809814453,
                3.20418119430542,
                3.2007575035095215,
                3.1960768699645996,
                3.192758560180664,
                3.188383102416992,
                3.185568332672119,
                3.1817994117736816,
                3.1780455112457275,
                3.1753971576690674,
                3.1722614765167236,
                3.1696043014526367,
                3.167323589324951,
                3.164597511291504,
                3.162374258041382,
                3.160675525665283,
                3.1585206985473633,
                3.1571545600891113,
                3.1557483673095703,
                3.154623508453369
            ],
            "val_acc": [
                0.4240441918373108,
                0.42589476704597473,
                0.42661499977111816,
                0.42708736658096313,
                0.42836546897888184,
                0.42869871854782104,
                0.4293529987335205,
                0.429779052734375,
                0.4307788014411926,
                0.4306603670120239,
                0.4314196705818176,
                0.4317346215248108,
                0.4320055842399597,
                0.4323498606681824,
                0.4328552186489105,
                0.4333239793777466,
                0.43376585841178894,
                0.43388062715530396,
                0.43413084745407104,
                0.4347521960735321,
                0.4349621534347534,
                0.43495845794677734,
                0.4351452589035034,
                0.43538814783096313,
                0.4355517625808716
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                24.824896784223384,
                23.57258787317168,
                26.953472411088867,
                26.967620198454725,
                21.716257620112493,
                31.88780298555456,
                28.858882187428517,
                20.753961050625804,
                27.805142087077225,
                26.937797032613204,
                26.571899223165588,
                31.442979581542872,
                23.999325614607365,
                30.014033882118333,
                27.55376360766262,
                26.081764221506813,
                28.74617338822083,
                27.395263291288806,
                27.78748072596034,
                30.569806195350555,
                36.11395768954769,
                27.114710693915956,
                26.85300007544979,
                25.67263564800515,
                28.482158281824947,
                21.78788270200395,
                21.372463850579873,
                28.430351889714117,
                23.807321885577334,
                27.55870418276037,
                25.512970479428795,
                29.794645471066225,
                29.52523821419532,
                25.730898504568767,
                23.70322899791969,
                29.611596430261503,
                29.756842844053747,
                26.950606476360512,
                22.582174274093642,
                29.16032489006954,
                33.844086729066504,
                28.420430161568817,
                25.844598355216167,
                27.13435740417082,
                27.352215141891644,
                29.410312606768798,
                30.528035757000065,
                36.11057402662639,
                25.803759248876897,
                27.937537630560783,
                22.277271492674966,
                35.66261205478627,
                22.808084433278413,
                26.65068033239686,
                22.73668845553778,
                24.752002613318083,
                31.89858535099098,
                21.714062447408462,
                30.185972666812123,
                26.30294534647804,
                28.961645931568707,
                29.704785840584805,
                27.823106547801405,
                25.79768169833135,
                30.630936779818207,
                23.340691367288304,
                28.89296760216917,
                22.350070172849478,
                25.870028399709557,
                32.213632950359816,
                28.98674262709435,
                25.83002973906438,
                24.99713420082645,
                28.503679254469944,
                25.597038634168122,
                22.119017427680376,
                25.883724742655907,
                26.459907290307996,
                20.679916087129428,
                28.558267772275574,
                24.352902256916067,
                25.466977642096438,
                29.223395271999212,
                21.258393756649813,
                26.62848230652732,
                26.458715005141666,
                25.645577489727255,
                26.152475746915062,
                30.89595523637116,
                33.665627630497724,
                19.61878531697742,
                26.381400785412996,
                30.296676245965386,
                27.360889808776395,
                27.975836950780376,
                23.862751030544636,
                32.554184163198435,
                26.021304762118138,
                25.56597590888928,
                25.805635705002377
            ],
            "train_lr": [
                9e-05,
                8.585786437626906e-05,
                8.267949192431123e-05,
                8e-05,
                7.763932022500211e-05,
                7.550510257216822e-05,
                7.35424868893541e-05,
                7.17157287525381e-05,
                7e-05,
                6.83772233983162e-05,
                6.6833752096446e-05,
                6.535898384862245e-05,
                6.39444872453601e-05,
                6.258342613226058e-05,
                6.127016653792584e-05,
                6e-05,
                5.87689437438234e-05,
                5.757359312880714e-05,
                5.641101056459327e-05,
                5.5278640450004216e-05,
                5.417424305044161e-05,
                5.309584240176571e-05,
                5.204168476687281e-05,
                5.101020514433644e-05,
                5e-05,
                4.900980486407215e-05,
                4.803847577293368e-05,
                4.708497377870819e-05,
                4.6148351928654966e-05,
                4.52277442494834e-05,
                4.432235637169978e-05,
                4.34314575050762e-05,
                4.255437353461972e-05,
                4.1690481051546994e-05,
                4.083920216900384e-05,
                4e-05,
                3.917237469701781e-05,
                3.8355859970310235e-05,
                3.755002001601602e-05,
                3.6754446796632414e-05,
                3.5968757625671514e-05,
                3.519259301592141e-05,
                3.442561475698e-05,
                3.366750419289201e-05,
                3.291796067500631e-05,
                3.217670016874732e-05,
                3.1443453995989555e-05,
                3.071796769724491e-05,
                3.0000000000000008e-05,
                2.9289321881345244e-05,
                2.8585715714571503e-05,
                2.788897449072021e-05,
                2.719890110719482e-05,
                2.6515307716504654e-05,
                2.583801512904337e-05,
                2.516685226452117e-05,
                2.450165564729251e-05,
                2.3842268941360924e-05,
                2.3188542521313917e-05,
                2.254033307585166e-05,
                2.189750324093346e-05,
                2.125992125988189e-05,
                2.062746066806228e-05,
                1.9999999999999995e-05,
                1.93774225170145e-05,
                1.8759615953640396e-05,
                1.8146472281275494e-05,
                1.7537887487646786e-05,
                1.6933761370819258e-05,
                1.6333997346592443e-05,
                1.5738502268236422e-05,
                1.5147186257614298e-05,
                1.455996254682469e-05,
                1.3976747329573736e-05,
                1.339745962155614e-05,
                1.2822021129186534e-05,
                1.2250356126078777e-05,
                1.1682391336721532e-05,
                1.111805582684411e-05,
                1.0557280900008416e-05,
                9.999999999999997e-06,
                9.446148618625838e-06,
                8.895664208557008e-06,
                8.348486100883201e-06,
                7.804555427071125e-06,
                7.263815045042966e-06,
                6.7262094691118545e-06,
                6.191684803531406e-06,
                5.660188679433964e-06,
                5.131670194948623e-06,
                4.606079858305434e-06,
                4.083369533745607e-06,
                3.5634923900704443e-06,
                3.0464028516734243e-06,
                2.5320565519103668e-06,
                2.0204102886728802e-06,
                1.5114219820389518e-06,
                1.0050506338833422e-06,
                5.012562893380035e-07,
                0
            ],
            "train_loss": [
                3.2118492126464844,
                3.1600866317749023,
                3.294114351272583,
                3.2946391105651855,
                3.0780632495880127,
                3.462225914001465,
                3.362420082092285,
                3.0327391624450684,
                3.325223207473755,
                3.293532609939575,
                3.2798564434051514,
                3.4481780529022217,
                3.178027868270874,
                3.401667356491089,
                3.316141366958618,
                3.2612385749816895,
                3.358506917953491,
                3.3103723526000977,
                3.324587821960449,
                3.4200150966644287,
                3.586681842803955,
                3.3000786304473877,
                3.290379762649536,
                3.2454278469085693,
                3.3492801189422607,
                3.0813560485839844,
                3.062105417251587,
                3.347459554672241,
                3.1699953079223633,
                3.3163206577301025,
                3.2391891479492188,
                3.3943309783935547,
                3.3852477073669434,
                3.247694730758667,
                3.1656134128570557,
                3.3881683349609375,
                3.393061399459839,
                3.2940080165863037,
                3.1171629428863525,
                3.3728113174438477,
                3.5217666625976562,
                3.3471105098724365,
                3.252103805541992,
                3.3008029460906982,
                3.3087997436523438,
                3.38134765625,
                3.4186477661132812,
                3.586588144302368,
                3.2505223751068115,
                3.3299734592437744,
                3.1035690307617188,
                3.5741052627563477,
                3.127117156982422,
                3.2828168869018555,
                3.1239819526672363,
                3.2089085578918457,
                3.462563991546631,
                3.0779621601104736,
                3.407379627227783,
                3.2696831226348877,
                3.3659746646881104,
                3.391310453414917,
                3.325869083404541,
                3.250286817550659,
                3.4220128059387207,
                3.150200366973877,
                3.363600492477417,
                3.1068315505981445,
                3.253087282180786,
                3.4723920822143555,
                3.3668408393859863,
                3.251539945602417,
                3.2187633514404297,
                3.3500354290008545,
                3.242478847503662,
                3.096439838409424,
                3.2536165714263916,
                3.275632858276367,
                3.029165029525757,
                3.3519487380981445,
                3.192653179168701,
                3.237384796142578,
                3.374971866607666,
                3.0567538738250732,
                3.2819836139678955,
                3.275587797164917,
                3.244373321533203,
                3.263946056365967,
                3.4306275844573975,
                3.516479730606079,
                2.976489543914795,
                3.2726614475250244,
                3.4110403060913086,
                3.309116840362549,
                3.331343412399292,
                3.17232084274292,
                3.482908248901367,
                3.258917808532715,
                3.241264581680298,
                3.2505950927734375
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}