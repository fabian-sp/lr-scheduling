{
    "summary": {
        "val/acc": 0.44050413370132446,
        "train/perplexity": 25.76638163023829,
        "optimized_parameters": 123587328,
        "iter": 15000,
        "_wandb": {
            "runtime": 1746
        },
        "final-val/perplexity": 22.69338466659919,
        "train/loss": 3.249072790145874,
        "final-val/loss": 3.12207555770874,
        "_runtime": 1746.4906888008118,
        "val/loss": 3.0868682861328125,
        "_timestamp": 1721148721.540295,
        "lr": 0,
        "_step": 126,
        "final-val/acc": 0.4351271092891693,
        "val/perplexity": 21.908314224775783,
        "iter_dt": 0.309634439,
        "parameters": 123587328
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 15000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/10000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.2_iter15000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                15000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1220755577087402
            ],
            "final_val_perplexity": [
                22.69338466659919
            ]
        },
        "val": {
            "iter": [
                10000,
                10200,
                10400,
                10600,
                10800,
                11000,
                11200,
                11400,
                11600,
                11800,
                12000,
                12200,
                12400,
                12600,
                12800,
                13000,
                13200,
                13400,
                13600,
                13800,
                14000,
                14200,
                14400,
                14600,
                14800
            ],
            "val_perplexity": [
                25.993755169359304,
                25.9247645800125,
                25.876622715778897,
                25.765896323591488,
                25.677698072817968,
                25.585092129717545,
                25.521597294239537,
                25.44304173204374,
                25.366971655563084,
                25.297642113968937,
                25.21117896366861,
                25.042660628080277,
                24.74038561499351,
                24.50950862079317,
                24.24660313040381,
                23.97480844126327,
                23.709203160357145,
                23.417177295577652,
                23.15326693169427,
                22.923172643455157,
                22.685059402423974,
                22.453932038883448,
                22.241289887931348,
                22.06658644048609,
                21.908314224775786
            ],
            "val_loss": [
                3.2578585147857666,
                3.2552008628845215,
                3.2533421516418457,
                3.249053955078125,
                3.2456250190734863,
                3.2420120239257812,
                3.2395272254943848,
                3.2364444732666016,
                3.233450174331665,
                3.230713367462158,
                3.2272896766662598,
                3.220582962036133,
                3.2084391117095947,
                3.199063301086426,
                3.1882786750793457,
                3.1770057678222656,
                3.165865421295166,
                3.1534719467163086,
                3.1421380043029785,
                3.132150411605835,
                3.121708631515503,
                3.1114678382873535,
                3.10195255279541,
                3.094066619873047,
                3.0868682861328125
            ],
            "val_acc": [
                0.4206201136112213,
                0.4208361506462097,
                0.42124390602111816,
                0.4217309355735779,
                0.42210814356803894,
                0.4223571717739105,
                0.42235225439071655,
                0.42292481660842896,
                0.42301270365715027,
                0.42314088344573975,
                0.42331910133361816,
                0.424445778131485,
                0.4259045422077179,
                0.4268432557582855,
                0.4279125928878784,
                0.42912840843200684,
                0.4307885766029358,
                0.4321667551994324,
                0.4336474537849426,
                0.4347851276397705,
                0.43565183877944946,
                0.43724608421325684,
                0.4386059641838074,
                0.4393566846847534,
                0.44050413370132446
            ]
        },
        "train": {
            "iter": [
                10050,
                10100,
                10150,
                10200,
                10250,
                10300,
                10350,
                10400,
                10450,
                10500,
                10550,
                10600,
                10650,
                10700,
                10750,
                10800,
                10850,
                10900,
                10950,
                11000,
                11050,
                11100,
                11150,
                11200,
                11250,
                11300,
                11350,
                11400,
                11450,
                11500,
                11550,
                11600,
                11650,
                11700,
                11750,
                11800,
                11850,
                11900,
                11950,
                12000,
                12050,
                12100,
                12150,
                12200,
                12250,
                12300,
                12350,
                12400,
                12450,
                12500,
                12550,
                12600,
                12650,
                12700,
                12750,
                12800,
                12850,
                12900,
                12950,
                13000,
                13050,
                13100,
                13150,
                13200,
                13250,
                13300,
                13350,
                13400,
                13450,
                13500,
                13550,
                13600,
                13650,
                13700,
                13750,
                13800,
                13850,
                13900,
                13950,
                14000,
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000
            ],
            "train_perplexity": [
                39.06030337113956,
                26.326296764796837,
                34.60807143686086,
                26.46751647048187,
                37.45182368082928,
                28.033437868417334,
                27.94439912126917,
                28.464752321738924,
                27.217187492866593,
                29.27841976164282,
                29.292251427089706,
                29.404654499204167,
                27.64820145657666,
                22.953864472266417,
                25.45247625041923,
                32.86410052278934,
                27.240389344344248,
                33.48414962250419,
                31.93715946643844,
                32.663899160556845,
                31.389866204014194,
                26.813418556260363,
                25.960768817935396,
                29.969735813147885,
                31.6482434854425,
                30.208248065159466,
                28.808739512536807,
                26.63667341572216,
                38.86037034621535,
                29.09171642547753,
                32.74114284795589,
                33.84567636996501,
                33.87372926775665,
                29.822447687435336,
                29.65788937073345,
                22.2049587524146,
                32.205116597613575,
                33.00627504874168,
                29.896129345094252,
                25.82615026687398,
                21.864122340977183,
                19.204787246409193,
                26.113976614103738,
                27.09588571666416,
                25.159383001561217,
                28.367018137360432,
                22.239237824867534,
                19.835209255611993,
                28.54544284153363,
                26.55455269216247,
                33.31346542802549,
                33.51450766374507,
                33.88481959694857,
                25.124310478808706,
                27.22952602758044,
                26.10533005826089,
                20.844426318994522,
                25.18871456163033,
                35.77728384838284,
                23.337330439449254,
                23.86652903764441,
                24.11329487511731,
                22.818228311097972,
                28.308198613550942,
                30.357832437256654,
                23.24634132923639,
                25.45483694381411,
                24.473731522005245,
                26.228043490410283,
                29.67004688869139,
                27.71154899352046,
                27.24950930388071,
                30.725224308565707,
                28.484487577266506,
                21.05128581609862,
                25.03365853408713,
                34.884029873987195,
                29.68482791642579,
                30.223196333122576,
                25.20680948391055,
                27.387837942074437,
                23.40551155176882,
                29.316809816233594,
                23.608899430106742,
                22.048837435240404,
                25.634525076545046,
                26.106910999974232,
                18.57836049179138,
                26.508477020096738,
                22.58356339043756,
                20.96623522689563,
                23.47931559824297,
                25.28608251633345,
                24.14027301709353,
                28.228999807599962,
                25.640643661313593,
                25.521980640707362,
                21.971560814055984,
                24.994535873014357,
                25.76638163023829
            ],
            "train_lr": [
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0005,
                0.0004916666666666666,
                0.00048333333333333334,
                0.000475,
                0.00046666666666666666,
                0.0004583333333333333,
                0.00045000000000000004,
                0.00044166666666666665,
                0.00043333333333333337,
                0.000425,
                0.0004166666666666667,
                0.00040833333333333336,
                0.0004,
                0.0003916666666666667,
                0.0003833333333333333,
                0.000375,
                0.0003666666666666667,
                0.00035833333333333333,
                0.00035,
                0.00034166666666666666,
                0.0003333333333333334,
                0.00032500000000000004,
                0.00031666666666666665,
                0.00030833333333333337,
                0.0003,
                0.00029166666666666664,
                0.00028333333333333335,
                0.000275,
                0.0002666666666666667,
                0.0002583333333333333,
                0.00025,
                0.00024166666666666664,
                0.00023333333333333333,
                0.000225,
                0.00021666666666666668,
                0.00020833333333333332,
                0.0002,
                0.00019166666666666665,
                0.00018333333333333336,
                0.000175,
                0.0001666666666666667,
                0.00015833333333333332,
                0.00015000000000000001,
                0.00014166666666666668,
                0.00013333333333333337,
                0.000125,
                0.00011666666666666664,
                0.00010833333333333334,
                9.999999999999998e-05,
                9.166666666666668e-05,
                8.333333333333332e-05,
                7.500000000000001e-05,
                6.666666666666666e-05,
                5.8333333333333346e-05,
                4.999999999999999e-05,
                4.1666666666666686e-05,
                3.333333333333333e-05,
                2.500000000000002e-05,
                1.6666666666666664e-05,
                8.333333333333359e-06,
                0
            ],
            "train_loss": [
                3.665109157562256,
                3.2705705165863037,
                3.5440893173217773,
                3.2759203910827637,
                3.6230578422546387,
                3.333400249481201,
                3.330219030380249,
                3.3486688137054443,
                3.3038508892059326,
                3.3768529891967773,
                3.3773252964019775,
                3.381155252456665,
                3.3195629119873047,
                3.133488416671753,
                3.2368152141571045,
                3.4923832416534424,
                3.3047029972076416,
                3.5110745429992676,
                3.4637725353240967,
                3.4862728118896484,
                3.4464874267578125,
                3.2889046669006348,
                3.2565886974334717,
                3.4001903533935547,
                3.4546849727630615,
                3.4081172943115234,
                3.3606810569763184,
                3.2822911739349365,
                3.659977436065674,
                3.370455741882324,
                3.4886348247528076,
                3.5218136310577393,
                3.522642135620117,
                3.395263671875,
                3.389730453491211,
                3.1003177165985107,
                3.472127676010132,
                3.4967000484466553,
                3.397731304168701,
                3.251389741897583,
                3.0848491191864014,
                2.9551615715026855,
                3.2624728679656982,
                3.299384117126465,
                3.2252330780029297,
                3.345229387283325,
                3.101860284805298,
                2.9874606132507324,
                3.351499557495117,
                3.279203414916992,
                3.5059640407562256,
                3.5119807720184326,
                3.5229694843292236,
                3.2238380908966064,
                3.3043041229248047,
                3.262141704559326,
                3.037088632583618,
                3.226398229598999,
                3.57731556892395,
                3.1500563621520996,
                3.1724791526794434,
                3.182765483856201,
                3.1275618076324463,
                3.343153715133667,
                3.4130568504333496,
                3.1461498737335205,
                3.236907958984375,
                3.1976025104522705,
                3.266831398010254,
                3.3901402950286865,
                3.3218514919281006,
                3.3050377368927,
                3.425086259841919,
                3.3493618965148926,
                3.046963691711426,
                3.2202234268188477,
                3.5520315170288086,
                3.3906383514404297,
                3.408612012863159,
                3.227116346359253,
                3.310101270675659,
                3.1529736518859863,
                3.3781633377075195,
                3.161625862121582,
                3.093261957168579,
                3.2439422607421875,
                3.262202262878418,
                2.921999454498291,
                3.2774667739868164,
                3.1172244548797607,
                3.0429153442382812,
                3.1561219692230225,
                3.2302563190460205,
                3.1838836669921875,
                3.3403520584106445,
                3.244180917739868,
                3.239542245864868,
                3.0897510051727295,
                3.2186594009399414,
                3.249072790145874
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}