{
    "summary": {
        "lr": 0,
        "iter_dt": 0.289323184,
        "train/loss": 3.114150285720825,
        "final-val/perplexity": 21.105762296557195,
        "iter": 25000,
        "_step": 126,
        "val/loss": 3.0142579078674316,
        "final-val/acc": 0.4428806602954865,
        "_wandb": {
            "runtime": 1586
        },
        "val/acc": 0.4481457471847534,
        "optimized_parameters": 123587328,
        "_runtime": 1585.8364827632904,
        "_timestamp": 1720833633.830783,
        "parameters": 123587328,
        "final-val/loss": 3.0495481491088867,
        "val/perplexity": 20.373924660159343,
        "train/perplexity": 22.51424434681618
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.2_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.0495481491088867
            ],
            "final_val_perplexity": [
                21.105762296557195
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                23.529144937432257,
                23.411310206901938,
                23.309293357413846,
                23.17237458373098,
                22.997944950012915,
                22.83815389257741,
                22.72395303711653,
                22.5578893211765,
                22.411017171420674,
                22.27695281624375,
                22.145158183450846,
                21.98970897000877,
                21.856090877056996,
                21.69164194880945,
                21.573193564816265,
                21.42084509525405,
                21.290226798933066,
                21.152904345916323,
                21.00798119196654,
                20.88096070983227,
                20.76308740205587,
                20.64602716197462,
                20.544600166440457,
                20.464040904123713,
                20.373924660159343
            ],
            "val_loss": [
                3.1582419872283936,
                3.153221368789673,
                3.1488542556762695,
                3.14296293258667,
                3.135406970977783,
                3.128434658050537,
                3.1234216690063477,
                3.116086959838867,
                3.1095547676086426,
                3.1035547256469727,
                3.097620964050293,
                3.090576648712158,
                3.084481716156006,
                3.0769290924072266,
                3.07145357131958,
                3.064366579055786,
                3.0582501888275146,
                3.051779270172119,
                3.0449044704437256,
                3.038839817047119,
                3.0331788063049316,
                3.027524948120117,
                3.0226001739501953,
                3.0186712741851807,
                3.0142579078674316
            ],
            "val_acc": [
                0.43126586079597473,
                0.4321020245552063,
                0.43260130286216736,
                0.43278685212135315,
                0.43406370282173157,
                0.4350878596305847,
                0.43546628952026367,
                0.43614500761032104,
                0.43718016147613525,
                0.43681883811950684,
                0.4381127953529358,
                0.4389098882675171,
                0.4400573670864105,
                0.44028440117836,
                0.4413183331489563,
                0.44236570596694946,
                0.4432665705680847,
                0.4438500702381134,
                0.44457152485847473,
                0.44514036178588867,
                0.44612425565719604,
                0.4466919004917145,
                0.4475634694099426,
                0.44764769077301025,
                0.4481457471847534
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                22.599301906082857,
                21.55169439055795,
                24.510192321968866,
                24.798738028776295,
                19.905104951874787,
                29.562852339052643,
                26.447715712794494,
                19.14076844290344,
                25.688769100185215,
                24.969680674368202,
                24.720456501026977,
                29.156682081744428,
                22.298755479275265,
                27.588681967742502,
                25.415219668919807,
                24.14169466392599,
                26.291308747373108,
                25.248714328805573,
                25.50544721218635,
                28.136388146583503,
                33.455988624274816,
                24.93946845586302,
                24.564118612460412,
                23.532157582965308,
                26.161056833522665,
                20.026533003786923,
                19.915776243055543,
                25.530324416281232,
                22.315258477850787,
                25.06569396945835,
                23.900774566989224,
                26.903644753639995,
                26.912934298851386,
                23.02343919248787,
                21.1141019718794,
                26.92293954285577,
                27.34805488684858,
                24.496773060876787,
                20.715564513755908,
                26.3281798343535,
                30.514297143269644,
                25.63112717269309,
                23.32926396218719,
                24.04193992232638,
                24.667427893113544,
                26.716226200278285,
                27.8750225811402,
                32.01595903051771,
                23.38642911133779,
                25.022207630566403,
                20.039596051359673,
                31.807771763094713,
                20.591760307819854,
                24.15422834666701,
                20.43135331455005,
                21.93538263999747,
                28.415877085218504,
                19.533168988039254,
                26.516612248664984,
                23.632056390607218,
                26.080166148610378,
                26.573508420359833,
                24.826808602017724,
                22.975387441823745,
                27.41196951903108,
                20.69250248262108,
                25.607525401532925,
                19.708916269658875,
                22.828839335052443,
                28.59631352672687,
                25.675953351786113,
                22.958100674151066,
                21.91248285113657,
                25.138391154207497,
                22.58369261490662,
                19.318460760405333,
                22.579417831120555,
                23.33297975839231,
                18.44553849239955,
                24.74318759136878,
                21.428931198388305,
                22.391645764503476,
                25.58353058832706,
                18.735110945958994,
                23.150970656810042,
                23.062753521304497,
                22.319834463994724,
                22.485603838711107,
                26.86622397634118,
                29.502144069319538,
                17.257413124316223,
                22.87427212492217,
                26.513432448809223,
                23.513700670039842,
                24.33144626519906,
                20.567276694773916,
                28.366774662499413,
                22.530863851478948,
                22.25612127274633,
                22.51424434681618
            ],
            "train_lr": [
                0.000495,
                0.00049,
                0.00048499999999999997,
                0.00048,
                0.000475,
                0.00047,
                0.00046499999999999997,
                0.00046,
                0.000455,
                0.00045000000000000004,
                0.00044500000000000003,
                0.00044,
                0.000435,
                0.00043,
                0.000425,
                0.00042,
                0.000415,
                0.00041000000000000005,
                0.00040500000000000003,
                0.0004,
                0.000395,
                0.00039000000000000005,
                0.00038500000000000003,
                0.00038,
                0.000375,
                0.00037,
                0.000365,
                0.00035999999999999997,
                0.000355,
                0.00035,
                0.000345,
                0.00033999999999999997,
                0.00033499999999999996,
                0.00032999999999999994,
                0.00032500000000000004,
                0.00032,
                0.000315,
                0.00031,
                0.000305,
                0.0003,
                0.00029500000000000007,
                0.00029000000000000006,
                0.00028500000000000004,
                0.00028000000000000003,
                0.000275,
                0.00027,
                0.00026500000000000004,
                0.00026000000000000003,
                0.000255,
                0.00025,
                0.000245,
                0.00024,
                0.000235,
                0.00022999999999999998,
                0.000225,
                0.00021999999999999998,
                0.00021500000000000002,
                0.00021000000000000004,
                0.00020500000000000002,
                0.0002,
                0.00019500000000000002,
                0.00019,
                0.000185,
                0.00017999999999999998,
                0.000175,
                0.00016999999999999999,
                0.00016499999999999997,
                0.00015999999999999999,
                0.00015500000000000003,
                0.00015000000000000001,
                0.00014500000000000003,
                0.00014000000000000001,
                0.000135,
                0.00013000000000000002,
                0.000125,
                0.00012,
                0.00011499999999999999,
                0.00010999999999999999,
                0.00010499999999999999,
                9.999999999999998e-05,
                9.499999999999998e-05,
                9.000000000000003e-05,
                8.500000000000002e-05,
                8.000000000000002e-05,
                7.500000000000001e-05,
                7.000000000000001e-05,
                6.500000000000001e-05,
                6e-05,
                5.4999999999999995e-05,
                4.999999999999999e-05,
                4.499999999999998e-05,
                3.999999999999998e-05,
                3.4999999999999977e-05,
                3.0000000000000028e-05,
                2.500000000000002e-05,
                2.000000000000002e-05,
                1.5000000000000014e-05,
                1.000000000000001e-05,
                5.000000000000005e-06,
                0
            ],
            "train_loss": [
                3.1179211139678955,
                3.0704565048217773,
                3.1990911960601807,
                3.2107949256896973,
                2.990978240966797,
                3.3865208625793457,
                3.275171995162964,
                2.951822519302368,
                3.246056079864502,
                3.2176644802093506,
                3.2076332569122314,
                3.3726863861083984,
                3.1045329570770264,
                3.3174078464508057,
                3.2353503704071045,
                3.1839425563812256,
                3.269240617752075,
                3.2287774085998535,
                3.23889422416687,
                3.3370659351348877,
                3.510233163833618,
                3.216453790664673,
                3.201288938522339,
                3.158370018005371,
                3.2642741203308105,
                2.9970600605010986,
                2.991514205932617,
                3.2398691177368164,
                3.1052727699279785,
                3.2215023040771484,
                3.17391300201416,
                3.292263984680176,
                3.292609214782715,
                3.136514902114868,
                3.049943208694458,
                3.292980909347534,
                3.308647632598877,
                3.1985435485839844,
                3.0308873653411865,
                3.270642042160034,
                3.4181976318359375,
                3.243809700012207,
                3.1497106552124023,
                3.1798019409179688,
                3.2054858207702637,
                3.285273313522339,
                3.327733278274536,
                3.4662368297576904,
                3.15215802192688,
                3.2197659015655518,
                2.9977121353149414,
                3.4597129821777344,
                3.024893045425415,
                3.1844615936279297,
                3.0170726776123047,
                3.0881030559539795,
                3.3469502925872803,
                2.972115993499756,
                3.27777361869812,
                3.1626062393188477,
                3.2611773014068604,
                3.279917001724243,
                3.211926221847534,
                3.134425640106201,
                3.3109819889068604,
                3.029773473739624,
                3.2428884506225586,
                2.9810731410980225,
                3.1280267238616943,
                3.3532800674438477,
                3.2455570697784424,
                3.1336729526519775,
                3.0870585441589355,
                3.224398374557495,
                3.117230176925659,
                2.9610631465911865,
                3.1170408725738525,
                3.149869918823242,
                2.9148244857788086,
                3.208552360534668,
                3.064743995666504,
                3.108690023422241,
                3.2419509887695312,
                2.93040132522583,
                3.1420388221740723,
                3.138221025466919,
                3.105477809906006,
                3.112877368927002,
                3.290872097015381,
                3.384465217590332,
                2.8482437133789062,
                3.1300148963928223,
                3.277653694152832,
                3.157585382461548,
                3.1917717456817627,
                3.0237033367156982,
                3.3452208042144775,
                3.1148881912231445,
                3.102619171142578,
                3.114150285720825
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}