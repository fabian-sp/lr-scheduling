{
    "summary": {
        "iter": 25000,
        "parameters": 123587328,
        "train/loss": 3.1120238304138184,
        "train/perplexity": 22.4664197111074,
        "final-val/perplexity": 21.05694300519062,
        "_step": 126,
        "val/loss": 3.0107967853546143,
        "_timestamp": 1720083854.9226463,
        "final-val/acc": 0.44331732392311096,
        "_wandb": {
            "runtime": 1711
        },
        "val/acc": 0.4490576088428498,
        "_runtime": 1711.3338603973389,
        "val/perplexity": 20.303529950825094,
        "optimized_parameters": 123587328,
        "lr": 0,
        "iter_dt": 0.288367495,
        "final-val/loss": 3.0472323894500732
    },
    "config": {
        "lr": 0.0005,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "sqrt",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": 1e-07,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.0005_sched_wsd_warmup300_decay_sqrt_0.2_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.0472323894500732
            ],
            "final_val_perplexity": [
                21.05694300519062
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                23.529144937432257,
                23.057151143530948,
                22.78714738359459,
                22.557873186533367,
                22.331065568572377,
                22.14015348576512,
                21.98611273648216,
                21.83874548440458,
                21.692417715727114,
                21.555317211253058,
                21.435788643013495,
                21.329230798708483,
                21.216807776702456,
                21.08637786622414,
                21.006523713836835,
                20.90443213893647,
                20.811404031212287,
                20.735250726822528,
                20.640593555070033,
                20.563128652643435,
                20.500954550409176,
                20.435898659890693,
                20.38524096322704,
                20.346265309443307,
                20.303529950825094
            ],
            "val_loss": [
                3.1582419872283936,
                3.1379780769348145,
                3.1261987686157227,
                3.11608624458313,
                3.10598087310791,
                3.0973949432373047,
                3.0904130935668945,
                3.0836877822875977,
                3.076964855194092,
                3.070624589920044,
                3.065063953399658,
                3.0600805282592773,
                3.054795742034912,
                3.0486292839050293,
                3.044835090637207,
                3.0399632453918457,
                3.0355031490325928,
                3.031837224960327,
                3.027261734008789,
                3.0235016345977783,
                3.0204734802246094,
                3.0172951221466064,
                3.014813184738159,
                3.012899398803711,
                3.0107967853546143
            ],
            "val_acc": [
                0.43126586079597473,
                0.4339892566204071,
                0.4352771043777466,
                0.4358789026737213,
                0.43787840008735657,
                0.4386035203933716,
                0.43949830532073975,
                0.4399511516094208,
                0.4409826397895813,
                0.44093626737594604,
                0.4423474073410034,
                0.4428747594356537,
                0.4435375928878784,
                0.4441186487674713,
                0.44492918252944946,
                0.4454613924026489,
                0.4459179639816284,
                0.44633543491363525,
                0.4469054937362671,
                0.4473022222518921,
                0.44794797897338867,
                0.4481542706489563,
                0.4486730694770813,
                0.4488842487335205,
                0.44905760884284973
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                22.473839561535456,
                21.35781395973939,
                24.191718489201612,
                24.42333999705949,
                19.577517280163296,
                28.999717427024596,
                25.84167781364378,
                18.708039408634043,
                24.99321893385368,
                24.36238559557575,
                24.087478207193865,
                28.245561235042096,
                21.666625420486525,
                26.800278153933466,
                24.599001473218003,
                23.42496141146836,
                25.535297897606743,
                24.402130294225387,
                24.74056847114138,
                27.33829576936493,
                32.22222837881456,
                24.10921914057853,
                23.774848357298087,
                22.72007963387431,
                25.305966848271048,
                19.353847842303352,
                19.29556470769012,
                24.59731831740991,
                21.588670601592437,
                24.27838385744059,
                23.15549718588001,
                25.916186852750585,
                26.011411329817857,
                22.30154678182585,
                20.405362464882216,
                26.02012603673259,
                26.47796846238961,
                23.66747204988925,
                20.087795124086227,
                25.473274873538976,
                29.550534427777315,
                24.81836930250699,
                22.59254086490601,
                23.292316235962755,
                23.932940781706574,
                25.88030614760633,
                27.043106013965932,
                31.093081249519507,
                22.72601731608209,
                24.253066967356883,
                19.48928823497172,
                30.801209871996786,
                20.04312238448092,
                23.48485817462091,
                19.84578629583958,
                21.37821754493991,
                27.63044874023343,
                19.00271592058854,
                25.842786841193835,
                23.029544005416184,
                25.405090276778985,
                25.926056428946104,
                24.253014926011836,
                22.438599696270025,
                26.751588347648294,
                20.245258664163877,
                25.01452491757458,
                19.333537069301297,
                22.395543267631382,
                28.06334326067064,
                25.18460116188826,
                22.60400619805691,
                21.536613559283012,
                24.7335796089071,
                22.244593736055425,
                19.023799416890384,
                22.279576721277863,
                22.982460312683024,
                18.172049239099877,
                24.518000723707907,
                21.215619067729715,
                22.10825666690494,
                25.317861491184857,
                18.546014028327562,
                22.84893761004839,
                22.854750946733645,
                22.107160322845743,
                22.28582965951064,
                26.638578685925868,
                29.282531573409234,
                17.13704591527191,
                22.74823778835305,
                26.37953906679594,
                23.38246508520537,
                24.242447064992955,
                20.531609321375882,
                28.249682904107427,
                22.48460135740388,
                22.180904942667105,
                22.4664197111074
            ],
            "train_lr": [
                0.00045000000000000004,
                0.00042928932188134527,
                0.0004133974596215562,
                0.0004,
                0.00038819660112501055,
                0.0003775255128608411,
                0.0003677124344467705,
                0.00035857864376269053,
                0.00035,
                0.000341886116991581,
                0.00033416876048223,
                0.0003267949192431123,
                0.00031972243622680054,
                0.0003129171306613029,
                0.00030635083268962916,
                0.0003,
                0.000293844718719117,
                0.00028786796564403573,
                0.00028205505282296635,
                0.0002763932022500211,
                0.00027087121525220804,
                0.0002654792120088285,
                0.00026020842383436403,
                0.0002550510257216822,
                0.00025,
                0.0002450490243203607,
                0.0002401923788646684,
                0.0002354248688935409,
                0.00023074175964327482,
                0.00022613872124741696,
                0.0002216117818584989,
                0.000217157287525381,
                0.00021277186767309857,
                0.00020845240525773495,
                0.0002041960108450192,
                0.0002,
                0.00019586187348508906,
                0.0001917792998515512,
                0.00018775010008008008,
                0.00018377223398316207,
                0.00017984378812835756,
                0.00017596296507960702,
                0.00017212807378489997,
                0.00016833752096446003,
                0.00016458980337503154,
                0.00016088350084373659,
                0.0001572172699799478,
                0.00015358983848622455,
                0.00015000000000000001,
                0.00014644660940672623,
                0.00014292857857285752,
                0.00013944487245360105,
                0.0001359945055359741,
                0.00013257653858252328,
                0.00012919007564521684,
                0.00012583426132260585,
                0.00012250827823646256,
                0.00011921134470680461,
                0.00011594271260656957,
                0.0001127016653792583,
                0.00010948751620466729,
                0.00010629960629940943,
                0.0001031373033403114,
                9.999999999999998e-05,
                9.688711258507249e-05,
                9.379807976820198e-05,
                9.073236140637748e-05,
                8.768943743823393e-05,
                8.466880685409628e-05,
                8.166998673296222e-05,
                7.869251134118211e-05,
                7.573593128807149e-05,
                7.279981273412346e-05,
                6.988373664786868e-05,
                6.69872981077807e-05,
                6.411010564593267e-05,
                6.125178063039388e-05,
                5.841195668360766e-05,
                5.559027913422055e-05,
                5.2786404500042076e-05,
                4.999999999999999e-05,
                4.723074309312919e-05,
                4.447832104278504e-05,
                4.1742430504416005e-05,
                3.902277713535563e-05,
                3.6319075225214827e-05,
                3.3631047345559273e-05,
                3.095842401765703e-05,
                2.8300943397169822e-05,
                2.5658350974743118e-05,
                2.303039929152717e-05,
                2.0416847668728032e-05,
                1.781746195035222e-05,
                1.5232014258367122e-05,
                1.2660282759551834e-05,
                1.0102051443364402e-05,
                7.55710991019476e-06,
                5.02525316941671e-06,
                2.5062814466900175e-06,
                0
            ],
            "train_loss": [
                3.112354040145874,
                3.061419725418091,
                3.1860125064849854,
                3.1955413818359375,
                2.97438383102417,
                3.36728835105896,
                3.251990795135498,
                2.928955316543579,
                3.21860671043396,
                3.193042516708374,
                3.181694269180298,
                3.3409385681152344,
                3.075775146484375,
                3.288414478302002,
                3.2027080059051514,
                3.153804302215576,
                3.2400639057159424,
                3.1946725845336914,
                3.208446502685547,
                3.308290719985962,
                3.47265887260437,
                3.182596445083618,
                3.168630361557007,
                3.12325119972229,
                3.2310423851013184,
                2.96289324760437,
                2.9598772525787354,
                3.202639579772949,
                3.0721707344055176,
                3.1895885467529297,
                3.1422343254089355,
                3.2548699378967285,
                3.258537530899048,
                3.1046581268310547,
                3.0157997608184814,
                3.2588725090026855,
                3.276315212249756,
                3.1641037464141846,
                3.0001144409179688,
                3.2376320362091064,
                3.386104106903076,
                3.2115862369537354,
                3.117621898651123,
                3.148125648498535,
                3.175257921218872,
                3.2534844875335693,
                3.2974343299865723,
                3.4369876384735107,
                3.1235125064849854,
                3.1885452270507812,
                2.969866991043091,
                3.427556276321411,
                2.9978880882263184,
                3.156358003616333,
                2.9879937171936035,
                3.0623745918273926,
                3.318920612335205,
                2.9445838928222656,
                3.2520337104797363,
                3.136780023574829,
                3.2349517345428467,
                3.2552506923675537,
                3.1885430812835693,
                3.1107847690582275,
                3.2865960597991943,
                3.007922649383545,
                3.219458818435669,
                2.961843252182007,
                3.1088640689849854,
                3.3344664573669434,
                3.2262349128723145,
                3.118129253387451,
                3.069756507873535,
                3.2081639766693115,
                3.1021010875701904,
                2.945692777633667,
                3.103672504425049,
                3.1347334384918213,
                2.8998866081237793,
                3.1994097232818604,
                3.0547397136688232,
                3.0959532260894775,
                3.2315123081207275,
                2.9202568531036377,
                3.128906726837158,
                3.1291611194610596,
                3.0959036350250244,
                3.1039531230926514,
                3.282362699508667,
                3.376993417739868,
                2.8412444591522217,
                3.1244897842407227,
                3.2725908756256104,
                3.1519885063171387,
                3.1881072521209717,
                3.021967649459839,
                3.3410844802856445,
                3.11283278465271,
                3.099233865737915,
                3.1120238304138184
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}