{
    "summary": {
        "iter": 15000,
        "val/acc": 0.44182491302490234,
        "_timestamp": 1721150402.5990818,
        "train/loss": 3.2318193912506104,
        "train/perplexity": 25.325637367962223,
        "final-val/perplexity": 22.30923131427156,
        "optimized_parameters": 123587328,
        "_step": 126,
        "_runtime": 1951.8030757904053,
        "val/loss": 3.0719027519226074,
        "parameters": 123587328,
        "final-val/acc": 0.43645623326301575,
        "_wandb": {
            "runtime": 1952
        },
        "iter_dt": 0.311360303,
        "lr": 0,
        "final-val/loss": 3.1050026416778564,
        "val/perplexity": 21.582885995054156
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 15000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/10000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.2_iter15000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                15000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1050026416778564
            ],
            "final_val_perplexity": [
                22.30923131427156
            ]
        },
        "val": {
            "iter": [
                10000,
                10200,
                10400,
                10600,
                10800,
                11000,
                11200,
                11400,
                11600,
                11800,
                12000,
                12200,
                12400,
                12600,
                12800,
                13000,
                13200,
                13400,
                13600,
                13800,
                14000,
                14200,
                14400,
                14600,
                14800
            ],
            "val_perplexity": [
                25.96778868872246,
                25.923404808571256,
                25.87862786909126,
                25.81930411238648,
                25.73947013599554,
                25.629190080194412,
                25.57331582337884,
                25.49376834657761,
                25.48540613722467,
                25.44506788670144,
                25.32129031022512,
                25.131008301411732,
                24.827110481443945,
                24.544559708857733,
                24.316582677529833,
                23.94731864854105,
                23.668222549035992,
                23.34426984059471,
                23.04825281404999,
                22.774188228665,
                22.497250907283735,
                22.224560756755203,
                21.988838690458216,
                21.775834486934425,
                21.582885995054156
            ],
            "val_loss": [
                3.256859064102173,
                3.255148410797119,
                3.2534196376800537,
                3.251124620437622,
                3.248027801513672,
                3.243734121322632,
                3.241551637649536,
                3.238436222076416,
                3.2381081581115723,
                3.2365241050720215,
                3.2316477298736572,
                3.224104642868042,
                3.2119383811950684,
                3.2004923820495605,
                3.1911606788635254,
                3.175858497619629,
                3.164135456085205,
                3.1503536701202393,
                3.137592077255249,
                3.1256299018859863,
                3.1133952140808105,
                3.1012001037597656,
                3.0905370712280273,
                3.0808029174804688,
                3.0719027519226074
            ],
            "val_acc": [
                0.4199792146682739,
                0.42020750045776367,
                0.4208666682243347,
                0.42069822549819946,
                0.4209863245487213,
                0.4212988317012787,
                0.4216955304145813,
                0.4226708710193634,
                0.42210814356803894,
                0.4222497344017029,
                0.4229174554347992,
                0.4236083924770355,
                0.4248608350753784,
                0.4264318645000458,
                0.4274548292160034,
                0.42890870571136475,
                0.43047118186950684,
                0.43190306425094604,
                0.4335888624191284,
                0.4354260265827179,
                0.4365307688713074,
                0.4382348656654358,
                0.4396313428878784,
                0.44072264432907104,
                0.44182491302490234
            ]
        },
        "train": {
            "iter": [
                10050,
                10100,
                10150,
                10200,
                10250,
                10300,
                10350,
                10400,
                10450,
                10500,
                10550,
                10600,
                10650,
                10700,
                10750,
                10800,
                10850,
                10900,
                10950,
                11000,
                11050,
                11100,
                11150,
                11200,
                11250,
                11300,
                11350,
                11400,
                11450,
                11500,
                11550,
                11600,
                11650,
                11700,
                11750,
                11800,
                11850,
                11900,
                11950,
                12000,
                12050,
                12100,
                12150,
                12200,
                12250,
                12300,
                12350,
                12400,
                12450,
                12500,
                12550,
                12600,
                12650,
                12700,
                12750,
                12800,
                12850,
                12900,
                12950,
                13000,
                13050,
                13100,
                13150,
                13200,
                13250,
                13300,
                13350,
                13400,
                13450,
                13500,
                13550,
                13600,
                13650,
                13700,
                13750,
                13800,
                13850,
                13900,
                13950,
                14000,
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000
            ],
            "train_perplexity": [
                39.07265395789551,
                26.42522681825109,
                34.47086262801868,
                26.381388205792277,
                37.722000130978515,
                28.276367067998876,
                27.80601716290419,
                28.353914045397495,
                27.414727646556084,
                29.227973209504725,
                29.523703673462247,
                29.349518724027106,
                27.716385698346787,
                22.9863291242231,
                25.761879072770718,
                32.81630016000497,
                27.16001395258365,
                33.46596874394818,
                32.10611927002229,
                32.64577448312901,
                31.292904891495816,
                26.911009405920034,
                26.143112105262112,
                30.2391036449452,
                31.595822917309196,
                30.504164513501753,
                28.74059508513238,
                26.670003533913015,
                38.82413319747194,
                29.054313828416547,
                33.19309970224551,
                34.029600580784155,
                33.89702881007945,
                29.99178728652641,
                29.894504253626472,
                22.10136325342201,
                32.152716532254544,
                33.28356723282472,
                30.19304804060001,
                25.464233337933507,
                21.932454147923416,
                19.41019665580316,
                26.510335197317623,
                27.235648691197046,
                24.992438337514287,
                27.86674964012009,
                22.31230054894386,
                19.801802828635882,
                28.7610838712953,
                26.49890378374733,
                33.22818448447504,
                33.61549932758697,
                33.88872994487247,
                24.942072952392216,
                27.202065652569587,
                26.124394878440558,
                20.71914557804395,
                25.229428372105605,
                35.836351371436365,
                23.489858812854884,
                23.89190382832165,
                24.24530825754268,
                22.81396352554223,
                28.106746672246274,
                30.247857316674892,
                23.15119144257547,
                25.399730360586304,
                24.534303515207064,
                25.966364751967564,
                29.213600755390694,
                27.805294560429484,
                27.237148726451544,
                30.678150376916957,
                28.112852097583513,
                20.71350506475325,
                24.75736750663421,
                34.59584531608213,
                29.39707700498257,
                29.850396833619346,
                24.794020321807018,
                27.025490532382417,
                23.16636999021698,
                28.83201263312927,
                23.465895667567302,
                21.855559372267866,
                25.16878434493862,
                25.696413832742845,
                18.373875897688833,
                26.04327604521319,
                22.357392962575613,
                20.600486257561997,
                23.313461753734128,
                24.807643816244724,
                23.847770067801946,
                27.627214414070174,
                25.38934079580222,
                25.21301232720067,
                21.5547005179176,
                24.496259103861476,
                25.325637367962223
            ],
            "train_lr": [
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.001,
                0.0009833333333333332,
                0.0009666666666666667,
                0.00095,
                0.0009333333333333333,
                0.0009166666666666666,
                0.0009000000000000001,
                0.0008833333333333333,
                0.0008666666666666667,
                0.00085,
                0.0008333333333333334,
                0.0008166666666666667,
                0.0008,
                0.0007833333333333334,
                0.0007666666666666666,
                0.00075,
                0.0007333333333333334,
                0.0007166666666666667,
                0.0007,
                0.0006833333333333333,
                0.0006666666666666668,
                0.0006500000000000001,
                0.0006333333333333333,
                0.0006166666666666667,
                0.0006,
                0.0005833333333333333,
                0.0005666666666666667,
                0.00055,
                0.0005333333333333334,
                0.0005166666666666666,
                0.0005,
                0.0004833333333333333,
                0.00046666666666666666,
                0.00045,
                0.00043333333333333337,
                0.00041666666666666664,
                0.0004,
                0.0003833333333333333,
                0.0003666666666666667,
                0.00035,
                0.0003333333333333334,
                0.00031666666666666665,
                0.00030000000000000003,
                0.00028333333333333335,
                0.00026666666666666673,
                0.00025,
                0.00023333333333333328,
                0.00021666666666666668,
                0.00019999999999999996,
                0.00018333333333333336,
                0.00016666666666666663,
                0.00015000000000000001,
                0.0001333333333333333,
                0.00011666666666666669,
                9.999999999999998e-05,
                8.333333333333337e-05,
                6.666666666666666e-05,
                5.000000000000004e-05,
                3.333333333333333e-05,
                1.6666666666666718e-05,
                0
            ],
            "train_loss": [
                3.6654253005981445,
                3.2743213176727295,
                3.540116786956787,
                3.272660970687866,
                3.6302459239959717,
                3.3420286178588867,
                3.3252546787261963,
                3.3447673320770264,
                3.311082601547241,
                3.3751285076141357,
                3.385195732116699,
                3.3792784214019775,
                3.322026014328003,
                3.134901762008667,
                3.2488980293273926,
                3.4909276962280273,
                3.301748037338257,
                3.510531425476074,
                3.4690489768981934,
                3.4857177734375,
                3.4433937072753906,
                3.2925376892089844,
                3.2635879516601562,
                3.4091382026672363,
                3.4530272483825684,
                3.417865514755249,
                3.3583128452301025,
                3.283541679382324,
                3.6590445041656494,
                3.369169235229492,
                3.5023443698883057,
                3.527233123779297,
                3.523329734802246,
                3.400925874710083,
                3.397676944732666,
                3.0956413745880127,
                3.470499277114868,
                3.505066156387329,
                3.40761399269104,
                3.237277030944824,
                3.0879695415496826,
                2.9658005237579346,
                3.2775368690490723,
                3.3045289516448975,
                3.2185754776000977,
                3.3274364471435547,
                3.105140209197998,
                2.9857749938964844,
                3.359025478363037,
                3.2771055698394775,
                3.5034008026123047,
                3.5149896144866943,
                3.523084878921509,
                3.2165582180023193,
                3.303295135498047,
                3.262871742248535,
                3.031060218811035,
                3.228013277053833,
                3.578965187072754,
                3.1565709114074707,
                3.173541784286499,
                3.188225269317627,
                3.1273748874664307,
                3.3360118865966797,
                3.4094276428222656,
                3.1420483589172363,
                3.234740734100342,
                3.2000744342803955,
                3.2568042278289795,
                3.374636650085449,
                3.325228691101074,
                3.30458402633667,
                3.423552989959717,
                3.336229085922241,
                3.030787944793701,
                3.209125280380249,
                3.543735980987549,
                3.3808975219726562,
                3.39620041847229,
                3.210604667663574,
                3.2967827320098877,
                3.1427037715911865,
                3.3614885807037354,
                3.155550241470337,
                3.0844573974609375,
                3.225606679916382,
                3.2463536262512207,
                2.9109318256378174,
                3.2597618103027344,
                3.10715913772583,
                3.0253167152404785,
                3.1490330696105957,
                3.211153984069824,
                3.1716928482055664,
                3.318803548812866,
                3.2343316078186035,
                3.2273623943328857,
                3.0705959796905518,
                3.1985225677490234,
                3.2318193912506104
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}