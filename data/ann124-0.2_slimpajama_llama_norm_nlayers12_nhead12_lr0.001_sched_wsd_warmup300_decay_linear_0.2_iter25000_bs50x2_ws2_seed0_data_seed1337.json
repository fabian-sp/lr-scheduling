{
    "summary": {
        "parameters": 123587328,
        "train/loss": 3.1072869300842285,
        "train/perplexity": 22.36025024719366,
        "final-val/perplexity": 20.859106996164694,
        "_step": 126,
        "val/perplexity": 20.14238097138194,
        "_timestamp": 1720856906.956226,
        "_runtime": 1636.8468492031095,
        "val/loss": 3.0028281211853027,
        "iter": 25000,
        "_wandb": {
            "runtime": 1637
        },
        "iter_dt": 0.28675009,
        "val/acc": 0.4497350752353668,
        "final-val/acc": 0.44392380118370056,
        "final-val/loss": 3.037792682647705,
        "optimized_parameters": 123587328,
        "lr": 0
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.2_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.037792682647705
            ],
            "final_val_perplexity": [
                20.859106996164694
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                23.870643421387992,
                23.765491733686535,
                23.642769655826537,
                23.510376488131325,
                23.27892548550957,
                23.10905403429936,
                22.972013392181136,
                22.769443090156493,
                22.61733225527962,
                22.45563449446898,
                22.281956562303158,
                22.10594808261584,
                21.96903080056024,
                21.785493302063067,
                21.62597320860739,
                21.445731234032642,
                21.273629733721418,
                21.114398979425847,
                20.95302772765406,
                20.804473520060093,
                20.642424284589897,
                20.497587129240767,
                20.372477170948628,
                20.25576459856467,
                20.14238097138194
            ],
            "val_loss": [
                3.172651529312134,
                3.16823673248291,
                3.1630594730377197,
                3.1574440002441406,
                3.147550582885742,
                3.1402266025543213,
                3.1342787742614746,
                3.1254215240478516,
                3.1187186241149902,
                3.111543655395508,
                3.1037793159484863,
                3.095848798751831,
                3.0896358489990234,
                3.0812463760375977,
                3.073897123336792,
                3.0655276775360107,
                3.0574703216552734,
                3.049957275390625,
                3.042285203933716,
                3.035170078277588,
                3.027350425720215,
                3.0203092098236084,
                3.0141868591308594,
                3.00844144821167,
                3.0028281211853027
            ],
            "val_acc": [
                0.4293005168437958,
                0.42977049946784973,
                0.4304150342941284,
                0.43099120259284973,
                0.432373046875,
                0.4327782988548279,
                0.4336877465248108,
                0.4342993199825287,
                0.43574219942092896,
                0.43617796897888184,
                0.4371936023235321,
                0.4378991723060608,
                0.43889036774635315,
                0.4399169683456421,
                0.44083738327026367,
                0.44143062829971313,
                0.44273191690444946,
                0.443450927734375,
                0.4442150890827179,
                0.44535398483276367,
                0.4465966820716858,
                0.447517067193985,
                0.448150634765625,
                0.44899290800094604,
                0.4497350752353668
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                23.008864460639934,
                21.825951019728066,
                24.83473563382536,
                25.384770975815606,
                20.259638105469854,
                29.810782097267825,
                26.725718650447355,
                19.483230003476187,
                26.13628786170084,
                25.36862884888793,
                25.20135320549636,
                29.328086317968996,
                22.507846825771246,
                28.070724203302365,
                25.948992822649892,
                24.21261253429859,
                26.960362182489952,
                25.544437749035563,
                25.82685838102099,
                28.494893636571177,
                34.250770350820225,
                25.392270755508395,
                24.867008590272437,
                24.113795047970886,
                26.6985435632498,
                20.247353622218366,
                20.32961889936387,
                25.86441006093986,
                22.591528229761483,
                25.182025374793284,
                23.91045808403078,
                27.49605348596637,
                27.13739168985651,
                23.155105219708865,
                21.292998465617472,
                27.193752546094704,
                27.54433823909193,
                24.743293777766507,
                20.907676975823552,
                26.607083023609757,
                30.84474395108276,
                25.805820281828247,
                23.28865133496205,
                24.27804813175631,
                24.917044177252283,
                27.02506527299689,
                28.019245309122446,
                32.16947066849716,
                23.30464786336778,
                25.219391066524594,
                20.202090032157642,
                32.04934111407987,
                20.795423179501654,
                24.131934758669516,
                20.534708162260117,
                22.025882219877598,
                28.73196935015836,
                19.718993433796463,
                26.66604876547537,
                23.68830300076036,
                26.10684253201119,
                26.675701466078507,
                24.962888960739527,
                22.92053851704328,
                27.419081085407196,
                20.756875701824278,
                25.480752200490734,
                19.912946464536102,
                22.861890243168475,
                28.528059421580657,
                25.706261001889967,
                22.836574886569387,
                21.686884518572445,
                24.864145167511328,
                22.525342345576785,
                19.155879628605668,
                22.681803697404916,
                23.3969417724745,
                18.414933539109178,
                24.78286220240697,
                21.334418416572298,
                22.327424155556475,
                25.29100238782949,
                18.62729909220625,
                22.81392001143086,
                22.91245221953619,
                22.145332417984957,
                22.320936033322475,
                26.407554198635985,
                29.321115767566383,
                17.06186123560351,
                22.78583809817915,
                26.19957540369585,
                23.306892699424733,
                24.00536868192087,
                20.52900528596879,
                28.14041337438556,
                22.539460327712614,
                21.940681066437417,
                22.36025024719366
            ],
            "train_lr": [
                0.00099,
                0.00098,
                0.0009699999999999999,
                0.00096,
                0.00095,
                0.00094,
                0.0009299999999999999,
                0.00092,
                0.00091,
                0.0009000000000000001,
                0.0008900000000000001,
                0.00088,
                0.00087,
                0.00086,
                0.00085,
                0.00084,
                0.00083,
                0.0008200000000000001,
                0.0008100000000000001,
                0.0008,
                0.00079,
                0.0007800000000000001,
                0.0007700000000000001,
                0.00076,
                0.00075,
                0.00074,
                0.00073,
                0.0007199999999999999,
                0.00071,
                0.0007,
                0.00069,
                0.0006799999999999999,
                0.0006699999999999999,
                0.0006599999999999999,
                0.0006500000000000001,
                0.00064,
                0.00063,
                0.00062,
                0.00061,
                0.0006,
                0.0005900000000000001,
                0.0005800000000000001,
                0.0005700000000000001,
                0.0005600000000000001,
                0.00055,
                0.00054,
                0.0005300000000000001,
                0.0005200000000000001,
                0.00051,
                0.0005,
                0.00049,
                0.00048,
                0.00047,
                0.00045999999999999996,
                0.00045,
                0.00043999999999999996,
                0.00043000000000000004,
                0.00042000000000000007,
                0.00041000000000000005,
                0.0004,
                0.00039000000000000005,
                0.00038,
                0.00037,
                0.00035999999999999997,
                0.00035,
                0.00033999999999999997,
                0.00032999999999999994,
                0.00031999999999999997,
                0.00031000000000000005,
                0.00030000000000000003,
                0.00029000000000000006,
                0.00028000000000000003,
                0.00027,
                0.00026000000000000003,
                0.00025,
                0.00024,
                0.00022999999999999998,
                0.00021999999999999998,
                0.00020999999999999998,
                0.00019999999999999996,
                0.00018999999999999996,
                0.00018000000000000007,
                0.00017000000000000004,
                0.00016000000000000004,
                0.00015000000000000001,
                0.00014000000000000001,
                0.00013000000000000002,
                0.00012,
                0.00010999999999999999,
                9.999999999999998e-05,
                8.999999999999997e-05,
                7.999999999999997e-05,
                6.999999999999995e-05,
                6.0000000000000056e-05,
                5.000000000000004e-05,
                4.000000000000004e-05,
                3.0000000000000028e-05,
                2.000000000000002e-05,
                1.000000000000001e-05,
                0
            ],
            "train_loss": [
                3.1358816623687744,
                3.083101749420166,
                3.212245464324951,
                3.234151601791382,
                3.0086326599121094,
                3.3948724269866943,
                3.2856285572052,
                2.9695560932159424,
                3.26332688331604,
                3.233515501022339,
                3.2268998622894287,
                3.3785479068756104,
                3.113866090774536,
                3.3347294330596924,
                3.2561349868774414,
                3.186875820159912,
                3.29436993598938,
                3.240421772003174,
                3.2514171600341797,
                3.349727153778076,
                3.5337114334106445,
                3.2344470024108887,
                3.2135441303253174,
                3.182786226272583,
                3.284611225128174,
                3.008026123046875,
                3.0120809078216553,
                3.2528700828552246,
                3.117577075958252,
                3.22613263130188,
                3.1743180751800537,
                3.314044713973999,
                3.300914764404297,
                3.1422173976898193,
                3.058380365371704,
                3.3029894828796387,
                3.3157992362976074,
                3.208556652069092,
                3.040118455886841,
                3.281179666519165,
                3.428968667984009,
                3.2506022453308105,
                3.147968292236328,
                3.189574718475342,
                3.2155542373657227,
                3.296766996383667,
                3.3328938484191895,
                3.471020221710205,
                3.1486549377441406,
                3.2276153564453125,
                3.0057880878448486,
                3.4672789573669434,
                3.0347349643707275,
                3.1835381984710693,
                3.02211856842041,
                3.0922203063964844,
                3.3580126762390137,
                2.981584310531616,
                3.283393383026123,
                3.1649835109710693,
                3.262199640274048,
                3.283755302429199,
                3.2173924446105957,
                3.132035493850708,
                3.311241388320923,
                3.032879590988159,
                3.2379255294799805,
                2.9913721084594727,
                3.1294734477996826,
                3.3508903980255127,
                3.246736764907837,
                3.1283655166625977,
                3.076709747314453,
                3.2134289741516113,
                3.114643096923828,
                2.9526116847991943,
                3.121565103530884,
                3.1526074409484863,
                2.913163900375366,
                3.2101545333862305,
                3.060323715209961,
                3.1058177947998047,
                3.2304508686065674,
                2.9246301651000977,
                3.127372980117798,
                3.1316826343536377,
                3.0976288318634033,
                3.10552716255188,
                3.2736523151397705,
                3.378310203552246,
                2.8368475437164307,
                3.126141309738159,
                3.2657454013824463,
                3.1487512588500977,
                3.1782796382904053,
                3.021840810775757,
                3.3372089862823486,
                3.115269660949707,
                3.0883445739746094,
                3.1072869300842285
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}