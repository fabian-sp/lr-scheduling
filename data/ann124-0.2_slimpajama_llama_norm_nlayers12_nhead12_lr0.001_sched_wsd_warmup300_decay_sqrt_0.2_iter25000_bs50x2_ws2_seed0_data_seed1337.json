{
    "summary": {
        "val/perplexity": 20.01971112775968,
        "optimized_parameters": 123587328,
        "_wandb": {
            "runtime": 1643
        },
        "parameters": 123587328,
        "final-val/acc": 0.4446011185646057,
        "final-val/perplexity": 20.76444382923658,
        "_step": 126,
        "train/loss": 3.100586414337158,
        "val/acc": 0.4503796100616455,
        "_runtime": 1643.5368888378143,
        "val/loss": 2.9967193603515625,
        "_timestamp": 1720085255.7495527,
        "lr": 0,
        "iter_dt": 0.286622034,
        "train/perplexity": 22.2109259722576,
        "iter": 25000,
        "final-val/loss": 3.0332441329956055
    },
    "config": {
        "lr": 0.001,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "sqrt",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_linear_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": 1e-07,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.001_sched_wsd_warmup300_decay_sqrt_0.2_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.0332441329956055
            ],
            "final_val_perplexity": [
                20.76444382923658
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                23.870643421387992,
                23.317458556191493,
                23.00753146514351,
                22.772933982650535,
                22.4638434264594,
                22.25361685458274,
                22.066775840202155,
                21.888678026967746,
                21.722243699499014,
                21.573224425518518,
                21.41005135542559,
                21.27483183764697,
                21.155163839002586,
                21.016212081074826,
                20.893141441395215,
                20.769919943410315,
                20.659410562449256,
                20.555633899645542,
                20.454246208307115,
                20.368140176457793,
                20.278789515172694,
                20.197914514568023,
                20.13231783454708,
                20.07325049770781,
                20.01971112775968
            ],
            "val_loss": [
                3.172651529312134,
                3.1492044925689697,
                3.1358237266540527,
                3.125574827194214,
                3.1119091510772705,
                3.102506637573242,
                3.0940752029418945,
                3.0859715938568115,
                3.078338861465454,
                3.0714550018310547,
                3.0638625621795654,
                3.0575268268585205,
                3.0518860816955566,
                3.0452961921691895,
                3.0394229888916016,
                3.033507823944092,
                3.0281729698181152,
                3.023137092590332,
                3.0181925296783447,
                3.0139739513397217,
                3.009577512741089,
                3.0055813789367676,
                3.002328395843506,
                2.999390125274658,
                2.9967193603515625
            ],
            "val_acc": [
                0.4293005168437958,
                0.4318285882472992,
                0.4337170124053955,
                0.43470460176467896,
                0.4366381764411926,
                0.4375659227371216,
                0.4382885694503784,
                0.43906617164611816,
                0.4404613971710205,
                0.4409582316875458,
                0.44209960103034973,
                0.4427539110183716,
                0.4433886408805847,
                0.44413450360298157,
                0.4451025128364563,
                0.44556760787963867,
                0.44655394554138184,
                0.44679200649261475,
                0.4473889172077179,
                0.4479968249797821,
                0.44864621758461,
                0.4494116008281708,
                0.4496093690395355,
                0.4502660930156708,
                0.4503796100616455
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                22.848381960832135,
                21.56516099687152,
                24.441805802186455,
                24.896883721283412,
                19.86304047759669,
                29.119418122262317,
                26.043009051123995,
                18.924597268506293,
                25.335686757030516,
                24.622190303195897,
                24.432431351297932,
                28.37004822156594,
                21.764784034643817,
                27.052914553241475,
                24.95270187930124,
                23.340908397475697,
                25.93127392834928,
                24.596778793583113,
                24.868787279742513,
                27.54704400793938,
                32.82399206354342,
                24.407733591828336,
                23.919734911685925,
                23.112844966603085,
                25.627326454307926,
                19.49038486467014,
                19.529141040216864,
                24.60347676465367,
                21.66425448355899,
                24.241129295945708,
                22.981134326009496,
                26.218327741964238,
                26.045803310883596,
                22.268153836590102,
                20.37744666574887,
                26.095977074904624,
                26.403418019506212,
                23.76153143815553,
                20.08329368619287,
                25.514923120775208,
                29.569774607960305,
                24.811630576428644,
                22.39215293542081,
                23.35936891050974,
                23.94098196221453,
                25.98268898705368,
                26.973728988737825,
                30.912585144269656,
                22.467196403730703,
                24.223063435470067,
                19.507502140163783,
                30.740992742043087,
                20.016599329377065,
                23.310660509262352,
                19.79118316963679,
                21.29766948946371,
                27.750570623304792,
                19.103233901009517,
                25.822979385144226,
                22.930152902502055,
                25.316690486832947,
                25.86403390401856,
                24.23283708652425,
                22.236305877268148,
                26.587818087900917,
                20.218627197856687,
                24.75753278033343,
                19.370217117611396,
                22.29552332166036,
                27.875826748915216,
                24.99659782663234,
                22.33632643585944,
                21.209873737024925,
                24.281098775340173,
                22.010354125813304,
                18.756979729847167,
                22.18863783795255,
                22.925659492831024,
                18.083267557085428,
                24.39546387174502,
                20.963431123167716,
                21.94351125376321,
                24.952350879930165,
                18.35231375750985,
                22.468107043069974,
                22.5846456682019,
                21.802770408319407,
                22.03684456870282,
                26.124270307999215,
                28.971155663507556,
                16.90454236283364,
                22.585884159125463,
                25.971615131668866,
                23.127816407326616,
                23.879585972886638,
                20.38273324555623,
                27.920630917287983,
                22.43619777565429,
                21.819104013250097,
                22.210925972257602
            ],
            "train_lr": [
                0.0009000000000000001,
                0.0008585786437626905,
                0.0008267949192431123,
                0.0008,
                0.0007763932022500211,
                0.0007550510257216822,
                0.000735424868893541,
                0.0007171572875253811,
                0.0007,
                0.000683772233983162,
                0.00066833752096446,
                0.0006535898384862246,
                0.0006394448724536011,
                0.0006258342613226058,
                0.0006127016653792583,
                0.0006,
                0.000587689437438234,
                0.0005757359312880715,
                0.0005641101056459327,
                0.0005527864045000422,
                0.0005417424305044161,
                0.000530958424017657,
                0.0005204168476687281,
                0.0005101020514433645,
                0.0005,
                0.0004900980486407215,
                0.0004803847577293368,
                0.0004708497377870818,
                0.00046148351928654963,
                0.0004522774424948339,
                0.0004432235637169978,
                0.000434314575050762,
                0.00042554373534619714,
                0.0004169048105154699,
                0.0004083920216900384,
                0.0004,
                0.0003917237469701781,
                0.0003835585997031024,
                0.00037550020016016017,
                0.00036754446796632414,
                0.0003596875762567151,
                0.00035192593015921403,
                0.00034425614756979995,
                0.00033667504192892006,
                0.0003291796067500631,
                0.00032176700168747317,
                0.0003144345399598956,
                0.0003071796769724491,
                0.00030000000000000003,
                0.00029289321881345245,
                0.00028585715714571504,
                0.0002788897449072021,
                0.0002719890110719482,
                0.00026515307716504656,
                0.0002583801512904337,
                0.0002516685226452117,
                0.0002450165564729251,
                0.00023842268941360922,
                0.00023188542521313915,
                0.0002254033307585166,
                0.00021897503240933457,
                0.00021259921259881887,
                0.0002062746066806228,
                0.00019999999999999996,
                0.00019377422517014497,
                0.00018759615953640397,
                0.00018146472281275496,
                0.00017537887487646786,
                0.00016933761370819256,
                0.00016333997346592444,
                0.00015738502268236422,
                0.00015147186257614297,
                0.0001455996254682469,
                0.00013976747329573735,
                0.0001339745962155614,
                0.00012822021129186534,
                0.00012250356126078775,
                0.00011682391336721532,
                0.0001111805582684411,
                0.00010557280900008415,
                9.999999999999998e-05,
                9.446148618625838e-05,
                8.895664208557008e-05,
                8.348486100883201e-05,
                7.804555427071125e-05,
                7.263815045042965e-05,
                6.726209469111855e-05,
                6.191684803531406e-05,
                5.6601886794339644e-05,
                5.1316701949486236e-05,
                4.606079858305434e-05,
                4.0833695337456064e-05,
                3.563492390070444e-05,
                3.0464028516734243e-05,
                2.5320565519103668e-05,
                2.0204102886728805e-05,
                1.511421982038952e-05,
                1.005050633883342e-05,
                5.012562893380035e-06,
                0
            ],
            "train_loss": [
                3.12888240814209,
                3.0710811614990234,
                3.1962971687316895,
                3.214744806289673,
                2.9888627529144287,
                3.3714075088500977,
                3.259751558303833,
                2.940464496612549,
                3.2322161197662354,
                3.2036502361297607,
                3.195913553237915,
                3.3453361988067627,
                3.0802953243255615,
                3.2977969646453857,
                3.216984272003174,
                3.150209665298462,
                3.2554519176483154,
                3.202617645263672,
                3.213615655899048,
                3.3158974647521973,
                3.491162061691284,
                3.194902181625366,
                3.174705982208252,
                3.140390634536743,
                3.243661403656006,
                2.969923257827759,
                2.971909761428833,
                3.202889919281006,
                3.0756657123565674,
                3.1880528926849365,
                3.1346757411956787,
                3.26646089553833,
                3.2598588466644287,
                3.1031596660614014,
                3.0144307613372803,
                3.2617833614349365,
                3.273495674133301,
                3.168070077896118,
                2.9998903274536133,
                3.2392656803131104,
                3.3867549896240234,
                3.2113146781921387,
                3.108712673187256,
                3.1510002613067627,
                3.175593852996826,
                3.257432699203491,
                3.294865608215332,
                3.4311656951904297,
                3.112058401107788,
                3.187307357788086,
                2.9708011150360107,
                3.4255993366241455,
                2.9965639114379883,
                3.1489129066467285,
                2.985238552093506,
                3.0585997104644775,
                3.323258638381958,
                2.949859619140625,
                3.2512669563293457,
                3.1324548721313477,
                3.231466054916382,
                3.2528555393218994,
                3.187710762023926,
                3.1017284393310547,
                3.2804553508758545,
                3.006606340408325,
                3.209131956100464,
                2.9637386798858643,
                3.1043879985809326,
                3.3277621269226074,
                3.2187418937683105,
                3.1062164306640625,
                3.054468870162964,
                3.1897003650665283,
                3.091515064239502,
                2.931567907333374,
                3.0995824337005615,
                3.132258892059326,
                2.894989013671875,
                3.194399356842041,
                3.0427815914154053,
                3.0884735584259033,
                3.216970205307007,
                2.909757614135742,
                3.1120989322662354,
                3.11727237701416,
                3.0820391178131104,
                3.0927178859710693,
                3.262866973876953,
                3.366302967071533,
                2.8275842666625977,
                3.1173272132873535,
                3.2570064067840576,
                3.141038179397583,
                3.1730260848999023,
                3.0146901607513428,
                3.3293681144714355,
                3.110677719116211,
                3.0827879905700684,
                3.100586414337158
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}