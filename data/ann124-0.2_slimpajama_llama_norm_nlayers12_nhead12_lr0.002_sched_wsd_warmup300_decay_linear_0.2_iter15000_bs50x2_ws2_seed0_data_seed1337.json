{
    "summary": {
        "iter": 15000,
        "_step": 126,
        "parameters": 123587328,
        "final-val/acc": 0.43604809045791626,
        "train/perplexity": 25.48731413237608,
        "_wandb": {
            "runtime": 1773
        },
        "iter_dt": 0.31923015,
        "val/acc": 0.4409167170524597,
        "val/loss": 3.075942039489746,
        "final-val/loss": 3.1075594425201416,
        "val/perplexity": 21.670241728046506,
        "final-val/perplexity": 22.366344519701627,
        "lr": 0,
        "_runtime": 1772.8316683769226,
        "_timestamp": 1721152260.9476657,
        "train/loss": 3.23818302154541,
        "optimized_parameters": 123587328
    },
    "config": {
        "lr": 0.002,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 15000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_sqrt_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/10000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_linear_0.2_iter15000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                15000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.1075594425201416
            ],
            "final_val_perplexity": [
                22.366344519701627
            ]
        },
        "val": {
            "iter": [
                10000,
                10200,
                10400,
                10600,
                10800,
                11000,
                11200,
                11400,
                11600,
                11800,
                12000,
                12200,
                12400,
                12600,
                12800,
                13000,
                13200,
                13400,
                13600,
                13800,
                14000,
                14200,
                14400,
                14600,
                14800
            ],
            "val_perplexity": [
                26.79043346574121,
                26.72862439643159,
                26.650781996799775,
                26.63401261640778,
                26.586746814166055,
                26.449594855071652,
                26.463844105402472,
                26.394392444757656,
                26.346911152361976,
                26.32549336277799,
                26.206766067281553,
                25.937129410535714,
                25.61465739159285,
                25.29711135423977,
                24.945920731444218,
                24.569917269708178,
                24.22053401921968,
                23.873893318402892,
                23.516358111279636,
                23.201037974815502,
                22.86160135812047,
                22.503012322042267,
                22.189129830142058,
                21.91002754913507,
                21.670241728046506
            ],
            "val_loss": [
                3.2880470752716064,
                3.2857372760772705,
                3.282820701599121,
                3.282191276550293,
                3.2804150581359863,
                3.275243043899536,
                3.2757816314697266,
                3.273153781890869,
                3.271353244781494,
                3.2705399990081787,
                3.266019821166992,
                3.2556777000427246,
                3.243166923522949,
                3.2306923866271973,
                3.216712474822998,
                3.2015249729156494,
                3.1872029304504395,
                3.172787666320801,
                3.157698392868042,
                3.1441991329193115,
                3.1294608116149902,
                3.1136512756347656,
                3.099604606628418,
                3.086946487426758,
                3.075942039489746
            ],
            "val_acc": [
                0.4164440929889679,
                0.4165331721305847,
                0.4172985851764679,
                0.417182594537735,
                0.41731321811676025,
                0.4182702600955963,
                0.4178857207298279,
                0.41835448145866394,
                0.41849973797798157,
                0.4186633229255676,
                0.41951173543930054,
                0.42024901509284973,
                0.42152953147888184,
                0.4228881597518921,
                0.42469239234924316,
                0.42606812715530396,
                0.42769771814346313,
                0.42911863327026367,
                0.430938720703125,
                0.4321618676185608,
                0.43407347798347473,
                0.4360119700431824,
                0.43830931186676025,
                0.4395739734172821,
                0.4409167170524597
            ]
        },
        "train": {
            "iter": [
                10050,
                10100,
                10150,
                10200,
                10250,
                10300,
                10350,
                10400,
                10450,
                10500,
                10550,
                10600,
                10650,
                10700,
                10750,
                10800,
                10850,
                10900,
                10950,
                11000,
                11050,
                11100,
                11150,
                11200,
                11250,
                11300,
                11350,
                11400,
                11450,
                11500,
                11550,
                11600,
                11650,
                11700,
                11750,
                11800,
                11850,
                11900,
                11950,
                12000,
                12050,
                12100,
                12150,
                12200,
                12250,
                12300,
                12350,
                12400,
                12450,
                12500,
                12550,
                12600,
                12650,
                12700,
                12750,
                12800,
                12850,
                12900,
                12950,
                13000,
                13050,
                13100,
                13150,
                13200,
                13250,
                13300,
                13350,
                13400,
                13450,
                13500,
                13550,
                13600,
                13650,
                13700,
                13750,
                13800,
                13850,
                13900,
                13950,
                14000,
                14050,
                14100,
                14150,
                14200,
                14250,
                14300,
                14350,
                14400,
                14450,
                14500,
                14550,
                14600,
                14650,
                14700,
                14750,
                14800,
                14850,
                14900,
                14950,
                15000
            ],
            "train_perplexity": [
                40.43568345069942,
                27.17382311617986,
                35.5040346289006,
                27.09290128793286,
                38.91868181319014,
                28.93735056353967,
                29.05269986277653,
                29.52765985354949,
                28.269107289668028,
                30.422317840631948,
                30.577481849125512,
                30.485908091849446,
                28.773868480765714,
                23.994010575551112,
                26.50833797805956,
                34.033592550424046,
                28.079131339575337,
                34.97063394976211,
                32.73040342774829,
                33.58203119193823,
                32.65732702396045,
                27.939063000793162,
                27.005620029857074,
                31.210556617235913,
                32.95394635653334,
                31.49374992027823,
                29.74516745740802,
                27.5326710139522,
                40.43821901107288,
                30.175121704637743,
                34.35510278120027,
                35.23098236537555,
                35.2398451794036,
                31.25476613445236,
                30.810023423627626,
                22.856598230208927,
                33.39276270191531,
                34.639877923783544,
                30.90568747256915,
                26.56722423458209,
                22.694883430375175,
                20.14612232189733,
                27.411642745057456,
                28.23167186851415,
                26.102006658357553,
                28.931003998034175,
                23.13829004914671,
                20.67277306582228,
                29.524660992267947,
                27.386669139077455,
                34.36915302860621,
                35.03107567212461,
                35.15648856220326,
                25.78438128845184,
                28.03744168337715,
                26.840902549140115,
                21.34681277405343,
                25.730045792599736,
                37.00550825895593,
                24.135761137982175,
                24.359975211621986,
                24.72897452679054,
                23.47083071336618,
                28.871090756667627,
                31.094037562286772,
                23.689037216745284,
                25.962582412237435,
                25.022708759019288,
                26.784621623401474,
                30.070805157181905,
                28.37228041024891,
                27.367466125777838,
                31.428357144395765,
                28.74215744908582,
                21.1335118886188,
                24.966061371774906,
                35.111405814117035,
                29.825732790376883,
                30.3381807554539,
                25.237171071405065,
                27.51455295697992,
                23.492608777574127,
                29.1834089002046,
                23.712442384859877,
                22.09139584970461,
                25.53165139487371,
                25.934192229399198,
                18.63134092363703,
                26.525376056160894,
                22.458086685636246,
                20.610169168685434,
                23.267434014728668,
                24.9444993034356,
                24.081684319571224,
                28.02134300314812,
                25.43237978079404,
                25.272087823821327,
                21.507985970077172,
                24.62831387471573,
                25.487314132376078
            ],
            "train_lr": [
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.002,
                0.0019666666666666665,
                0.0019333333333333333,
                0.0019,
                0.0018666666666666666,
                0.0018333333333333333,
                0.0018000000000000002,
                0.0017666666666666666,
                0.0017333333333333335,
                0.0017,
                0.0016666666666666668,
                0.0016333333333333334,
                0.0016,
                0.0015666666666666667,
                0.0015333333333333332,
                0.0015,
                0.001466666666666667,
                0.0014333333333333333,
                0.0014,
                0.0013666666666666666,
                0.0013333333333333335,
                0.0013000000000000002,
                0.0012666666666666666,
                0.0012333333333333335,
                0.0012,
                0.0011666666666666665,
                0.0011333333333333334,
                0.0011,
                0.0010666666666666667,
                0.0010333333333333332,
                0.001,
                0.0009666666666666666,
                0.0009333333333333333,
                0.0009,
                0.0008666666666666667,
                0.0008333333333333333,
                0.0008,
                0.0007666666666666666,
                0.0007333333333333334,
                0.0007,
                0.0006666666666666668,
                0.0006333333333333333,
                0.0006000000000000001,
                0.0005666666666666667,
                0.0005333333333333335,
                0.0005,
                0.00046666666666666655,
                0.00043333333333333337,
                0.0003999999999999999,
                0.0003666666666666667,
                0.00033333333333333327,
                0.00030000000000000003,
                0.0002666666666666666,
                0.00023333333333333339,
                0.00019999999999999996,
                0.00016666666666666674,
                0.0001333333333333333,
                0.00010000000000000009,
                6.666666666666666e-05,
                3.3333333333333437e-05,
                0
            ],
            "train_loss": [
                3.6997151374816895,
                3.3022563457489014,
                3.5696487426757812,
                3.29927396774292,
                3.6614768505096436,
                3.365135431289673,
                3.3691136837005615,
                3.3853297233581543,
                3.3417718410491943,
                3.4151787757873535,
                3.4202661514282227,
                3.417266845703125,
                3.3594698905944824,
                3.1778063774108887,
                3.277461528778076,
                3.527350425720215,
                3.335028886795044,
                3.554511070251465,
                3.488306760787964,
                3.513993501663208,
                3.4860715866088867,
                3.3300280570983887,
                3.2960472106933594,
                3.44075870513916,
                3.4951133728027344,
                3.449791431427002,
                3.3926689624786377,
                3.315375566482544,
                3.699777841567993,
                3.407020092010498,
                3.536752939224243,
                3.5619282722473145,
                3.5621798038482666,
                3.442174196243286,
                3.427842378616333,
                3.129241943359375,
                3.5083415508270264,
                3.5450079441070557,
                3.4309425354003906,
                3.2796804904937744,
                3.1221415996551514,
                3.003013849258423,
                3.3109700679779053,
                3.340446710586548,
                3.262014389038086,
                3.3649160861968994,
                3.141490936279297,
                3.0288195610046387,
                3.385228157043457,
                3.31005859375,
                3.5371618270874023,
                3.5562379360198975,
                3.559811592102051,
                3.2497711181640625,
                3.333543062210083,
                3.289929151535034,
                3.0609045028686523,
                3.247661590576172,
                3.6110692024230957,
                3.183696746826172,
                3.192943572998047,
                3.207977771759033,
                3.1557605266571045,
                3.3628430366516113,
                3.437018394470215,
                3.1650145053863525,
                3.2566585540771484,
                3.2197859287261963,
                3.287830114364624,
                3.403557062149048,
                3.345414876937866,
                3.309357166290283,
                3.4477128982543945,
                3.3583672046661377,
                3.0508620738983154,
                3.217519521713257,
                3.558528423309326,
                3.395373821258545,
                3.4124093055725098,
                3.2283201217651367,
                3.3147172927856445,
                3.1566879749298096,
                3.3736026287078857,
                3.166002035140991,
                3.0951902866363525,
                3.2399210929870605,
                3.2555644512176514,
                2.92484712600708,
                3.278104066848755,
                3.1116528511047363,
                3.0257866382598877,
                3.147056818008423,
                3.2166554927825928,
                3.1814537048339844,
                3.3329687118530273,
                3.236025333404541,
                3.2297027111053467,
                3.0684263706207275,
                3.2038989067077637,
                3.23818302154541
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}