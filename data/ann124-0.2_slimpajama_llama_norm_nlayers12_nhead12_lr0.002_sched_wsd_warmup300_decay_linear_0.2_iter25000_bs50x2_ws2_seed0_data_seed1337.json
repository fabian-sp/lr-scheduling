{
    "summary": {
        "iter_dt": 0.290278432,
        "_timestamp": 1720848923.0279534,
        "train/loss": 3.1114768981933594,
        "final-val/loss": 3.0430986881256104,
        "val/perplexity": 20.28550137933123,
        "lr": 0,
        "_wandb": {
            "runtime": 1799
        },
        "_runtime": 1797.184267282486,
        "final-val/perplexity": 20.970079607789952,
        "iter": 25000,
        "_step": 126,
        "val/loss": 3.009908437728882,
        "parameters": 123587328,
        "final-val/acc": 0.4432322680950165,
        "train/perplexity": 22.454135470181875,
        "val/acc": 0.44838377833366394,
        "optimized_parameters": 123587328
    },
    "config": {
        "lr": 0.002,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "linear",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_sqrt_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": -1,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_linear_0.2_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.0430986881256104
            ],
            "final_val_perplexity": [
                20.970079607789952
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                24.963043703144475,
                24.844815320191394,
                24.641070821897788,
                24.44713260485384,
                24.262725461088607,
                24.030638993720675,
                23.829662154119593,
                23.57980523647619,
                23.42004717782218,
                23.267450656889096,
                23.024597445346146,
                22.82276596066903,
                22.655337351003396,
                22.426795847636726,
                22.202184832408324,
                22.001796833706575,
                21.80019746003626,
                21.575930052001315,
                21.37007415293056,
                21.17731762800658,
                20.966965055148712,
                20.76583005074796,
                20.598732914058292,
                20.436722094274582,
                20.28550137933123
            ],
            "val_loss": [
                3.2173986434936523,
                3.212651252746582,
                3.2044167518615723,
                3.1965150833129883,
                3.188943386077881,
                3.1793317794799805,
                3.170933246612549,
                3.1603927612304688,
                3.153594493865967,
                3.14705753326416,
                3.1365652084350586,
                3.127760648727417,
                3.1203975677490234,
                3.1102585792541504,
                3.1001927852630615,
                3.0911262035369873,
                3.081921100616455,
                3.071580410003662,
                3.0619935989379883,
                3.0529327392578125,
                3.04295015335083,
                3.033310890197754,
                3.0252315998077393,
                3.0173354148864746,
                3.009908437728882
            ],
            "val_acc": [
                0.42396479845046997,
                0.4245055913925171,
                0.4254540801048279,
                0.42629149556159973,
                0.4272180199623108,
                0.42832762002944946,
                0.4295104742050171,
                0.43037474155426025,
                0.43128538131713867,
                0.43134641647338867,
                0.4333117604255676,
                0.43365478515625,
                0.4346911311149597,
                0.4360363781452179,
                0.43739134073257446,
                0.4381078779697418,
                0.4391406178474426,
                0.44065916538238525,
                0.4415270984172821,
                0.44248899817466736,
                0.44380614161491394,
                0.44538572430610657,
                0.4462927281856537,
                0.44755247235298157,
                0.44838377833366394
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                24.278488049114156,
                22.755761563939256,
                26.15890506117833,
                26.530144885002723,
                20.86401611751389,
                31.241095233792585,
                28.253097879578092,
                20.28404082789052,
                27.049702687192813,
                26.426499501577485,
                26.033628740836154,
                30.67855266254017,
                23.54591855042779,
                29.340528357665868,
                27.181196922515426,
                25.4260077904587,
                27.946631134319638,
                26.60147585562241,
                26.768393463900438,
                29.561534331003102,
                35.4206695710791,
                26.282108445757178,
                25.887791854436326,
                25.134267995019265,
                27.789892347790598,
                21.086850445321236,
                21.041892317778686,
                27.227214966348143,
                23.406711348105862,
                26.353570478039707,
                24.655979914059156,
                28.305215626118596,
                28.226926947152048,
                24.0743248194362,
                22.235765126265015,
                28.25253205629469,
                28.618521188256313,
                25.42362552483894,
                21.61525647774968,
                27.398222236589838,
                31.800628852992855,
                26.70278327258833,
                24.088316684963043,
                24.964995920481677,
                25.651301186190928,
                27.786904352830327,
                28.812091552185525,
                33.59122399777739,
                23.94995657443362,
                26.25966645759911,
                20.89606069282985,
                32.65995883459672,
                21.341484760487578,
                24.905183458550972,
                21.087157124657217,
                22.497309908709962,
                29.404465213310228,
                20.169628508183436,
                27.324266217118687,
                24.417680722005358,
                26.456702751511287,
                27.307828292062826,
                25.65634105319046,
                23.69012163890206,
                27.923719839943004,
                21.017474803324646,
                26.195365627005305,
                20.267938210600907,
                23.43437951690356,
                29.04224243015988,
                26.26258414695748,
                23.36473833638947,
                22.23325239708453,
                25.49622405115412,
                22.930726941620858,
                19.62813314785277,
                23.001218613787543,
                23.909580193331834,
                18.73566930371993,
                25.030047860904787,
                21.786495779260072,
                22.499369691850617,
                25.688199511659118,
                18.854565992677742,
                23.534362612689097,
                23.25577633322481,
                22.4205835392942,
                22.54861380556549,
                26.879204456850516,
                29.55457171298424,
                17.339485923097556,
                22.780851550614475,
                26.378281223187265,
                23.34300089459499,
                24.28065302172133,
                20.580407869069326,
                28.304014421321686,
                22.527082440692066,
                21.903284720331282,
                22.454135470181875
            ],
            "train_lr": [
                0.00198,
                0.00196,
                0.0019399999999999999,
                0.00192,
                0.0019,
                0.00188,
                0.0018599999999999999,
                0.00184,
                0.00182,
                0.0018000000000000002,
                0.0017800000000000001,
                0.00176,
                0.00174,
                0.00172,
                0.0017,
                0.00168,
                0.00166,
                0.0016400000000000002,
                0.0016200000000000001,
                0.0016,
                0.00158,
                0.0015600000000000002,
                0.0015400000000000001,
                0.00152,
                0.0015,
                0.00148,
                0.00146,
                0.0014399999999999999,
                0.00142,
                0.0014,
                0.00138,
                0.0013599999999999999,
                0.0013399999999999998,
                0.0013199999999999998,
                0.0013000000000000002,
                0.00128,
                0.00126,
                0.00124,
                0.00122,
                0.0012,
                0.0011800000000000003,
                0.0011600000000000002,
                0.0011400000000000002,
                0.0011200000000000001,
                0.0011,
                0.00108,
                0.0010600000000000002,
                0.0010400000000000001,
                0.00102,
                0.001,
                0.00098,
                0.00096,
                0.00094,
                0.0009199999999999999,
                0.0009,
                0.0008799999999999999,
                0.0008600000000000001,
                0.0008400000000000001,
                0.0008200000000000001,
                0.0008,
                0.0007800000000000001,
                0.00076,
                0.00074,
                0.0007199999999999999,
                0.0007,
                0.0006799999999999999,
                0.0006599999999999999,
                0.0006399999999999999,
                0.0006200000000000001,
                0.0006000000000000001,
                0.0005800000000000001,
                0.0005600000000000001,
                0.00054,
                0.0005200000000000001,
                0.0005,
                0.00048,
                0.00045999999999999996,
                0.00043999999999999996,
                0.00041999999999999996,
                0.0003999999999999999,
                0.0003799999999999999,
                0.00036000000000000013,
                0.0003400000000000001,
                0.0003200000000000001,
                0.00030000000000000003,
                0.00028000000000000003,
                0.00026000000000000003,
                0.00024,
                0.00021999999999999998,
                0.00019999999999999996,
                0.00017999999999999993,
                0.00015999999999999993,
                0.0001399999999999999,
                0.00012000000000000011,
                0.00010000000000000009,
                8.000000000000007e-05,
                6.0000000000000056e-05,
                4.000000000000004e-05,
                2.000000000000002e-05,
                0
            ],
            "train_loss": [
                3.1895928382873535,
                3.1248204708099365,
                3.2641918659210205,
                3.2782838344573975,
                3.0380280017852783,
                3.4417366981506348,
                3.341205358505249,
                3.009836435317993,
                3.297678232192993,
                3.274369478225708,
                3.2593913078308105,
                3.4235661029815674,
                3.158954620361328,
                3.378972053527832,
                3.302527666091919,
                3.2357747554779053,
                3.330298900604248,
                3.2809689044952393,
                3.287224054336548,
                3.3864762783050537,
                3.56729793548584,
                3.268890619277954,
                3.2537736892700195,
                3.2242343425750732,
                3.324674606323242,
                3.048651695251465,
                3.0465173721313477,
                3.3042192459106445,
                3.153024911880493,
                3.271605968475342,
                3.205021619796753,
                3.343048334121704,
                3.3402786254882812,
                3.181148052215576,
                3.1017041206359863,
                3.3411853313446045,
                3.3540563583374023,
                3.2356810569763184,
                3.07340145111084,
                3.3104803562164307,
                3.4594883918762207,
                3.2847700119018555,
                3.1817290782928467,
                3.2174768447875977,
                3.244596481323242,
                3.3245670795440674,
                3.36079740524292,
                3.5142672061920166,
                3.175968647003174,
                3.268036365509033,
                3.039562702178955,
                3.486152172088623,
                3.060654878616333,
                3.215078115463257,
                3.04866623878479,
                3.1133978366851807,
                3.3811488151550293,
                3.0041799545288086,
                3.3077774047851562,
                3.195309638977051,
                3.2755117416381836,
                3.307175636291504,
                3.244792938232422,
                3.16506028175354,
                3.3294787406921387,
                3.045356273651123,
                3.265584707260132,
                3.009042263031006,
                3.1542062759399414,
                3.368753671646118,
                3.2681474685668945,
                3.1512300968170166,
                3.101591110229492,
                3.238532543182373,
                3.1324799060821533,
                2.97696590423584,
                3.135549306869507,
                3.174281358718872,
                2.9304311275482178,
                3.220079183578491,
                3.0812923908233643,
                3.1134893894195557,
                3.2460339069366455,
                2.9367570877075195,
                3.158463716506958,
                3.1465556621551514,
                3.1099815368652344,
                3.115675687789917,
                3.2913551330566406,
                3.3862407207489014,
                2.8529882431030273,
                3.125922441482544,
                3.27254319190979,
                3.150299310684204,
                3.1896820068359375,
                3.024341583251953,
                3.343005895614624,
                3.114720344543457,
                3.0866386890411377,
                3.1114768981933594
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}