{
    "summary": {
        "final-val/loss": 3.035658836364746,
        "_step": 126,
        "_runtime": 1636.0222311019895,
        "_timestamp": 1720129003.933598,
        "val/perplexity": 20.09820017831387,
        "iter": 25000,
        "val/loss": 3.0006322860717773,
        "parameters": 123587328,
        "train/loss": 3.1014931201934814,
        "final-val/acc": 0.4441879689693451,
        "val/acc": 0.4495580792427063,
        "_wandb": {
            "runtime": 1636
        },
        "iter_dt": 0.288941628,
        "train/perplexity": 22.23107386808571,
        "final-val/perplexity": 20.81464435323666,
        "optimized_parameters": 123587328,
        "lr": 0
    },
    "config": {
        "lr": 0.002,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 768,
        "n_head": 12,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 12,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "wsd",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "decay_type": "sqrt",
        "from_dense": false,
        "iterations": 25000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": "/mloscratch/homes/haegele/improvegpt/exps/stable-124m_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_sqrt_0.0_iter50000_bs50x2_ws2_seed0_data_seed1337/ckpts/20000",
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "cos_final_lr": 1e-07,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "cos_inf_steps": 0,
        "eval_interval": 200,
        "wandb_project": "re-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": false,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "resume_from_swa": null,
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0.2,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": false,
        "wandb_run_prefix": "ann124-0.2",
        "max_num_wa_sweeps": 5,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "ann124-0.2_slimpajama_llama_norm_nlayers12_nhead12_lr0.002_sched_wsd_warmup300_decay_sqrt_0.2_iter25000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                25000
            ],
            "final_val_best_perplexity_wa": [],
            "final_val_best_loss_wa": [],
            "final_val_loss": [
                3.035658836364746
            ],
            "final_val_perplexity": [
                20.81464435323666
            ]
        },
        "val": {
            "iter": [
                20000,
                20200,
                20400,
                20600,
                20800,
                21000,
                21200,
                21400,
                21600,
                21800,
                22000,
                22200,
                22400,
                22600,
                22800,
                23000,
                23200,
                23400,
                23600,
                23800,
                24000,
                24200,
                24400,
                24600,
                24800
            ],
            "val_perplexity": [
                24.963043703144475,
                24.28322345374426,
                23.8416188823074,
                23.50055804141211,
                23.216005656487336,
                22.92969368155363,
                22.70333138322235,
                22.47805684270652,
                22.272555546995644,
                22.110444246598785,
                21.91846553644432,
                21.734417719666617,
                21.597113556308667,
                21.427653973480083,
                21.273883336491092,
                21.121815454408733,
                20.97524488560922,
                20.837489778963647,
                20.691234618718315,
                20.578916271641386,
                20.458513738837073,
                20.337443391052613,
                20.250868232223315,
                20.171196241473112,
                20.098200178313874
            ],
            "val_loss": [
                3.2173986434936523,
                3.1897878646850586,
                3.1714348793029785,
                3.1570262908935547,
                3.1448440551757812,
                3.132434844970703,
                3.122513771057129,
                3.112541675567627,
                3.1033573150634766,
                3.0960521697998047,
                3.087331533432007,
                3.0788991451263428,
                3.072561740875244,
                3.0646843910217285,
                3.0574822425842285,
                3.0503084659576416,
                3.0433449745178223,
                3.0367558002471924,
                3.029712200164795,
                3.0242691040039062,
                3.0184011459350586,
                3.012465715408325,
                3.008199691772461,
                3.0042576789855957,
                3.0006322860717773
            ],
            "val_acc": [
                0.42396479845046997,
                0.42726439237594604,
                0.4292858839035034,
                0.4306665062904358,
                0.43217405676841736,
                0.43384885787963867,
                0.43522337079048157,
                0.43607664108276367,
                0.43770506978034973,
                0.4375011920928955,
                0.43889036774635315,
                0.43974608182907104,
                0.4402477741241455,
                0.4415637254714966,
                0.44248414039611816,
                0.4433361887931824,
                0.4442773163318634,
                0.4450719952583313,
                0.44594234228134155,
                0.44626832008361816,
                0.44715574383735657,
                0.4480065703392029,
                0.4487341344356537,
                0.44920772314071655,
                0.4495580792427063
            ]
        },
        "train": {
            "iter": [
                20050,
                20100,
                20150,
                20200,
                20250,
                20300,
                20350,
                20400,
                20450,
                20500,
                20550,
                20600,
                20650,
                20700,
                20750,
                20800,
                20850,
                20900,
                20950,
                21000,
                21050,
                21100,
                21150,
                21200,
                21250,
                21300,
                21350,
                21400,
                21450,
                21500,
                21550,
                21600,
                21650,
                21700,
                21750,
                21800,
                21850,
                21900,
                21950,
                22000,
                22050,
                22100,
                22150,
                22200,
                22250,
                22300,
                22350,
                22400,
                22450,
                22500,
                22550,
                22600,
                22650,
                22700,
                22750,
                22800,
                22850,
                22900,
                22950,
                23000,
                23050,
                23100,
                23150,
                23200,
                23250,
                23300,
                23350,
                23400,
                23450,
                23500,
                23550,
                23600,
                23650,
                23700,
                23750,
                23800,
                23850,
                23900,
                23950,
                24000,
                24050,
                24100,
                24150,
                24200,
                24250,
                24300,
                24350,
                24400,
                24450,
                24500,
                24550,
                24600,
                24650,
                24700,
                24750,
                24800,
                24850,
                24900,
                24950,
                25000
            ],
            "train_perplexity": [
                24.071501021929727,
                22.403911842980364,
                25.632496058195535,
                25.920574240447316,
                20.39287293208335,
                30.287078020063454,
                27.337702642053646,
                19.6292282301812,
                26.07634858097035,
                25.40462994579924,
                25.041066520196214,
                29.506667184482346,
                22.612986407648147,
                28.04337158828227,
                25.660874109301577,
                24.37645770334216,
                26.68003296310703,
                25.408688414180215,
                25.591113495925516,
                28.26111492692986,
                33.63057808492182,
                24.976879169018822,
                24.677816224670718,
                23.896045375478817,
                26.37674044650401,
                20.067077722896332,
                20.057702566131958,
                25.73421760221247,
                22.231137471746436,
                25.094425695450084,
                23.50308511488887,
                26.857488427632525,
                26.77723410153899,
                22.81571503742679,
                21.13166783471097,
                26.78084779452792,
                27.196754568340722,
                24.219073084062153,
                20.663917963440895,
                26.071704834404127,
                30.129695120261093,
                25.349765018902158,
                22.95314756970859,
                23.705500923916755,
                24.38052630039257,
                26.493647873210456,
                27.528430805352745,
                32.0657279344656,
                22.90971008282227,
                24.962198583234795,
                19.995535828295512,
                31.089063574623083,
                20.385702689063013,
                23.84832159169944,
                20.180484915174958,
                21.53748648028256,
                28.05997129103357,
                19.382154265840377,
                26.101427907252635,
                23.413905835496248,
                25.38095837807355,
                26.196208777357114,
                24.692735775247478,
                22.767190309941462,
                26.850887416121548,
                20.24519108848085,
                25.203125765531162,
                19.516722497076962,
                22.617051852811013,
                28.130150181329665,
                25.378767906359585,
                22.674142196058234,
                21.48869833578106,
                24.788789327956703,
                22.189055766104207,
                19.08441916426374,
                22.335793903044845,
                23.285420037080204,
                18.25517682224191,
                24.457334864783355,
                21.346995995880203,
                21.947100519032983,
                25.086445678167138,
                18.479066635659567,
                23.02277500742045,
                22.82658067824725,
                22.00618262047293,
                22.151310020610655,
                26.38801220597979,
                29.17463635474628,
                17.12311904236446,
                22.512285181217727,
                25.99850900213875,
                23.04963762790396,
                24.029974398664724,
                20.34818636619215,
                28.03373863598754,
                22.391074543646628,
                21.753619901068834,
                22.23107386808571
            ],
            "train_lr": [
                0.0018000000000000002,
                0.001717157287525381,
                0.0016535898384862247,
                0.0016,
                0.0015527864045000422,
                0.0015101020514433645,
                0.001470849737787082,
                0.0014343145750507621,
                0.0014,
                0.001367544467966324,
                0.00133667504192892,
                0.0013071796769724491,
                0.0012788897449072022,
                0.0012516685226452117,
                0.0012254033307585166,
                0.0012,
                0.001175378874876468,
                0.001151471862576143,
                0.0011282202112918654,
                0.0011055728090000843,
                0.0010834848610088322,
                0.001061916848035314,
                0.0010408336953374561,
                0.001020204102886729,
                0.001,
                0.000980196097281443,
                0.0009607695154586736,
                0.0009416994755741637,
                0.0009229670385730993,
                0.0009045548849896678,
                0.0008864471274339956,
                0.000868629150101524,
                0.0008510874706923943,
                0.0008338096210309398,
                0.0008167840433800769,
                0.0008,
                0.0007834474939403562,
                0.0007671171994062048,
                0.0007510004003203203,
                0.0007350889359326483,
                0.0007193751525134302,
                0.0007038518603184281,
                0.0006885122951395999,
                0.0006733500838578401,
                0.0006583592135001262,
                0.0006435340033749463,
                0.0006288690799197912,
                0.0006143593539448982,
                0.0006000000000000001,
                0.0005857864376269049,
                0.0005717143142914301,
                0.0005577794898144042,
                0.0005439780221438964,
                0.0005303061543300931,
                0.0005167603025808674,
                0.0005033370452904234,
                0.0004900331129458502,
                0.00047684537882721845,
                0.0004637708504262783,
                0.0004508066615170332,
                0.00043795006481866914,
                0.00042519842519763774,
                0.0004125492133612456,
                0.0003999999999999999,
                0.00038754845034028994,
                0.00037519231907280794,
                0.0003629294456255099,
                0.0003507577497529357,
                0.0003386752274163851,
                0.00032667994693184887,
                0.00031477004536472844,
                0.00030294372515228595,
                0.0002911992509364938,
                0.0002795349465914747,
                0.0002679491924311228,
                0.0002564404225837307,
                0.0002450071225215755,
                0.00023364782673443064,
                0.0002223611165368822,
                0.0002111456180001683,
                0.00019999999999999996,
                0.00018892297237251677,
                0.00017791328417114015,
                0.00016696972201766402,
                0.0001560911085414225,
                0.0001452763009008593,
                0.0001345241893822371,
                0.00012383369607062812,
                0.00011320377358867929,
                0.00010263340389897247,
                9.212159716610868e-05,
                8.166739067491213e-05,
                7.126984780140888e-05,
                6.092805703346849e-05,
                5.0641131038207336e-05,
                4.040820577345761e-05,
                3.022843964077904e-05,
                2.010101267766684e-05,
                1.002512578676007e-05,
                0
            ],
            "train_loss": [
                3.181030750274658,
                3.1092376708984375,
                3.243863105773926,
                3.2550392150878906,
                3.0151875019073486,
                3.4107234477996826,
                3.3082690238952637,
                2.9770216941833496,
                3.261030912399292,
                3.234933614730835,
                3.2205193042755127,
                3.3846185207366943,
                3.1185264587402344,
                3.333754539489746,
                3.244969606399536,
                3.193619966506958,
                3.2839176654815674,
                3.235093355178833,
                3.2422473430633545,
                3.34148907661438,
                3.5154380798339844,
                3.2179527282714844,
                3.205906867980957,
                3.173715114593506,
                3.27248477935791,
                2.999082565307617,
                2.998615264892578,
                3.247823715209961,
                3.1014959812164307,
                3.2226479053497314,
                3.1571338176727295,
                3.2905468940734863,
                3.2875542640686035,
                3.1274516582489014,
                3.0507748126983643,
                3.287689208984375,
                3.3030998706817627,
                3.1871426105499268,
                3.028391122817993,
                3.260852813720703,
                3.4055135250091553,
                3.232771635055542,
                3.1334571838378906,
                3.1657092571258545,
                3.193786859512329,
                3.276907205581665,
                3.3152215480804443,
                3.467790126800537,
                3.1315629482269287,
                3.21736478805542,
                2.995511054992676,
                3.4368584156036377,
                3.014835834503174,
                3.1717159748077393,
                3.004718065261841,
                3.0697970390319824,
                3.334346294403076,
                2.9643547534942627,
                3.2619922161102295,
                3.153332233428955,
                3.234001398086548,
                3.2656168937683105,
                3.2065112590789795,
                3.1253225803375244,
                3.2903010845184326,
                3.0079193115234375,
                3.2269701957702637,
                2.97127366065979,
                3.118706226348877,
                3.3368442058563232,
                3.233915090560913,
                3.121227264404297,
                3.0675292015075684,
                3.2103936672210693,
                3.0996012687683105,
                2.9488742351531982,
                3.1061925888061523,
                3.147829532623291,
                2.9044506549835205,
                3.196932315826416,
                3.0609130859375,
                3.088637113571167,
                3.22232985496521,
                2.916640520095825,
                3.136486053466797,
                3.127927780151367,
                3.091325521469116,
                3.0978987216949463,
                3.27291202545166,
                3.3733019828796387,
                2.8404314517974854,
                3.114063262939453,
                3.2580413818359375,
                3.1376521587371826,
                3.1793041229248047,
                3.012993812561035,
                3.3334109783172607,
                3.1086645126342773,
                3.079782247543335,
                3.1014931201934814
            ]
        },
        "wa": {
            "iter": [],
            "val_perplexity_wa": [],
            "val_loss_wa": [],
            "val_acc_wa": [],
            "val_best_perplexity_wa": []
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}