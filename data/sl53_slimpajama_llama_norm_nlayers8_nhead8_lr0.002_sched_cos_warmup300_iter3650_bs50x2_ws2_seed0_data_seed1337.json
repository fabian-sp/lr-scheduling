{
    "summary": {
        "lr": 0.00020000039575153976,
        "_wandb": {
            "runtime": 1039
        },
        "val/acc": 0.39961302280426025,
        "final-val/perplexity_wa": 33.69119372735723,
        "iter_dt": 0.245445471,
        "final-val/perplexity": 33.68913744422042,
        "final-val/best_loss_wa": 3.5172388553619385,
        "val/perplexity": 32.35512247569128,
        "_step": 110,
        "_runtime": 1039.3660230636597,
        "val/loss": 3.4767746925354004,
        "_timestamp": 1715368907.8537211,
        "parameters": 53027328,
        "train/loss": 3.5289306640625,
        "final-val/loss": 3.5171778202056885,
        "wa_best_horizon": 500,
        "train/perplexity": 34.08741621800441,
        "val/best_loss_wa": 3.4757447242736816,
        "final-val/loss_wa": 3.5172388553619385,
        "optimized_parameters": 53027328,
        "val/best_perplexity_wa": 32.32181490465675,
        "iter": 3650,
        "val/loss_wa": 3.4757447242736816,
        "final-val/acc": 0.3939042389392853,
        "val/perplexity_wa": 32.32181490465675,
        "final-val/best_perplexity_wa": 33.69119372735723
    },
    "config": {
        "lr": 0.002,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 512,
        "n_head": 8,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 8,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "cos",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 3650,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": null,
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            3650,
            7500,
            11250
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": true,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": true,
        "wandb_run_prefix": "sl53",
        "max_num_wa_sweeps": 10,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "sl53_slimpajama_llama_norm_nlayers8_nhead8_lr0.002_sched_cos_warmup300_iter3650_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                3650
            ],
            "final_val_best_perplexity_wa": [
                33.69119372735723
            ],
            "final_val_best_loss_wa": [
                3.5172388553619385
            ],
            "final_val_loss": [
                3.5171778202056885
            ],
            "final_val_perplexity": [
                33.68913744422042
            ]
        },
        "val": {
            "iter": [
                0,
                200,
                400,
                600,
                800,
                1000,
                1200,
                1400,
                1600,
                1800,
                2000,
                2200,
                2400,
                2600,
                2800,
                3000,
                3200,
                3400,
                3600
            ],
            "val_perplexity": [
                51677.89673145973,
                244.37550077089446,
                101.6328419181986,
                68.01040999539715,
                57.72156325096344,
                51.9816485878046,
                48.077369287308585,
                45.040783220489125,
                42.65343816809735,
                40.77221270980532,
                39.14343301381957,
                37.574282119390936,
                36.37168175024774,
                35.34641514983006,
                34.4439329471416,
                33.73381755084114,
                33.11307653859267,
                32.693560299057296,
                32.35512247569128
            ],
            "val_loss": [
                10.852792739868164,
                5.498709678649902,
                4.6213698387146,
                4.219663619995117,
                4.055633544921875,
                3.9508934020996094,
                3.872814178466797,
                3.8075709342956543,
                3.753110408782959,
                3.708003282546997,
                3.6672351360321045,
                3.6263222694396973,
                3.5937929153442383,
                3.565199375152588,
                3.539335250854492,
                3.518503189086914,
                3.4999306201934814,
                3.487180471420288,
                3.4767746925354004
            ],
            "val_acc": [
                0.009324951097369194,
                0.2168920934200287,
                0.2873595952987671,
                0.3300402760505676,
                0.34447264671325684,
                0.35425904393196106,
                0.36103758215904236,
                0.3670031726360321,
                0.3721374571323395,
                0.3761633038520813,
                0.38011839985847473,
                0.3844396770000458,
                0.38755857944488525,
                0.3899194598197937,
                0.39307862520217896,
                0.3952673375606537,
                0.39738038182258606,
                0.3986779749393463,
                0.39961302280426025
            ]
        },
        "train": {
            "iter": [
                50,
                100,
                150,
                200,
                250,
                300,
                350,
                400,
                450,
                500,
                550,
                600,
                650,
                700,
                750,
                800,
                850,
                900,
                950,
                1000,
                1050,
                1100,
                1150,
                1200,
                1250,
                1300,
                1350,
                1400,
                1450,
                1500,
                1550,
                1600,
                1650,
                1700,
                1750,
                1800,
                1850,
                1900,
                1950,
                2000,
                2050,
                2100,
                2150,
                2200,
                2250,
                2300,
                2350,
                2400,
                2450,
                2500,
                2550,
                2600,
                2650,
                2700,
                2750,
                2800,
                2850,
                2900,
                2950,
                3000,
                3050,
                3100,
                3150,
                3200,
                3250,
                3300,
                3350,
                3400,
                3450,
                3500,
                3550,
                3600,
                3650
            ],
            "train_perplexity": [
                3505.086122243988,
                664.3611797477861,
                386.23646810912925,
                228.7768438763546,
                234.80640310682173,
                161.81995829268837,
                151.17430866279832,
                111.38719626607046,
                107.22294466398175,
                92.25772490846926,
                83.30118930612853,
                76.41782016092206,
                84.44644328403062,
                62.86798570582042,
                64.87510424163429,
                61.94846344181882,
                72.42014538049021,
                54.26119864478172,
                47.993960115537455,
                56.87584927243906,
                56.0091056870818,
                44.586890545353704,
                55.60451771348499,
                46.09280263651238,
                58.96187591551399,
                50.42293559833565,
                55.59385999348363,
                51.32962948114558,
                41.78263724518239,
                54.264846964534435,
                54.690555460553085,
                46.5139042197136,
                39.90451544413864,
                50.801338677280384,
                37.99225056368666,
                44.939643137161525,
                49.14531847324485,
                42.88477564626644,
                43.52034332579059,
                41.90328851463255,
                50.32838908220527,
                50.26770966369767,
                40.26934996503326,
                45.0949810605149,
                40.028035835182614,
                31.272588256994958,
                42.9467400650595,
                42.62169106093231,
                49.90861704478325,
                39.76661141660902,
                43.02541910665319,
                36.79403249186084,
                41.35103766251326,
                35.684972459203166,
                50.19410534350123,
                34.80889200638168,
                40.486733766442526,
                36.794664108285296,
                38.682777668994746,
                35.5493841906889,
                41.49255658343993,
                37.69226995280222,
                42.59929018906791,
                41.285921993399775,
                39.55385799180504,
                36.863777486055085,
                41.09290406075071,
                30.407669821550677,
                46.08702258869154,
                35.11405121481804,
                28.378747984656552,
                34.519270609944755,
                34.08741621800441
            ],
            "train_lr": [
                0.00015350299180558842,
                0.0005180058079879229,
                0.0010152009405027529,
                0.0015109933636896634,
                0.001871666366821391,
                0.00199999960424846,
                0.0019989708463696897,
                0.0019959659554682346,
                0.001990991536946444,
                0.00198405852565582,
                0.00197518216185984,
                0.001964381957732553,
                0.0019516816544665836,
                0.0019371091700848388,
                0.0019206965380706355,
                0.001902479836951151,
                0.001882499110988991,
                0.001860798282156208,
                0.0018374250535842774,
                0.001812430804702258,
                0.0017858704782936596,
                0.0017578024597202776,
                0.0017282884485784985,
                0.001697393323070196,
                0.0016651849973863624,
                0.0016317342724169773,
                0.0015971146801152874,
                0.0015614023218586126,
                0.0015246757011610028,
                0.001487015551105478,
                0.0014485046568751892,
                0.001409227673773619,
                0.0013692709411338522,
                0.001328722292525984,
                0.0012876708626798697,
                0.001246206891547645,
                0.0012044215259367252,
                0.0011624066191493407,
                0.0011202545290690464,
                0.0010780579151380468,
                0.0010359095346716336,
                0.0009939020389574742,
                0.0009521277695879755,
                0.0009106785554734228,
                0.000869645510982103,
                0.0008291188356511515,
                0.0007891876159083924,
                0.000749939629241036,
                0.0007114611512417126,
                0.0006738367659559929,
                0.0006371491799483023,
                0.0006014790404949404,
                0.000566904758303865,
                0.0005335023351509394,
                0.0005013451968115342,
                0.0004705040316547374,
                0.000441046635254978,
                0.00041303776136263916,
                0.00038653897956126247,
                0.0003616085399242403,
                0.00033830124496851243,
                0.000316668329186741,
                0.00029675734642277483,
                0.00027861206533798163,
                0.0002622723731982303,
                0.0002477741881930241,
                0.00023514938047952515,
                0.00022442570212503148,
                0.00021562672610191095,
                0.00020877179446909182,
                0.0002038759758540189,
                0.00020095003232854078,
                0.00020000039575153976
            ],
            "train_loss": [
                8.161975860595703,
                6.498830318450928,
                5.956453800201416,
                5.432750701904297,
                5.458765029907227,
                5.086487770080566,
                5.018436908721924,
                4.713015556335449,
                4.67491340637207,
                4.5245890617370605,
                4.422465801239014,
                4.33621883392334,
                4.436120510101318,
                4.141039848327637,
                4.17246675491333,
                4.12630558013916,
                4.282487392425537,
                3.993812084197998,
                3.8710777759552,
                4.0408735275268555,
                4.025516986846924,
                3.7974424362182617,
                4.0182671546936035,
                3.8306593894958496,
                4.0768938064575195,
                3.9204487800598145,
                4.018075466156006,
                3.9382708072662354,
                3.732483386993408,
                3.9938793182373047,
                4.0016937255859375,
                3.8397538661956787,
                3.6864919662475586,
                3.9279253482818604,
                3.6373846530914307,
                3.8053228855133057,
                3.8947842121124268,
                3.758519411087036,
                3.773231029510498,
                3.7353668212890625,
                3.918571949005127,
                3.917365550994873,
                3.6955931186676025,
                3.8087735176086426,
                3.689582586288452,
                3.442744255065918,
                3.759963274002075,
                3.752365827560425,
                3.910196304321289,
                3.683030128479004,
                3.761793613433838,
                3.6053380966186523,
                3.722100019454956,
                3.5747320652008057,
                3.915900230407715,
                3.549875259399414,
                3.700976848602295,
                3.6053552627563477,
                3.6553969383239746,
                3.570925235748291,
                3.7255165576934814,
                3.629457473754883,
                3.751840114593506,
                3.7205240726470947,
                3.6776657104492188,
                3.607231855392456,
                3.7158379554748535,
                3.4146971702575684,
                3.830533981323242,
                3.5586037635803223,
                3.3456428050994873,
                3.541520118713379,
                3.5289306640625
            ]
        },
        "wa": {
            "iter": [
                600,
                800,
                1000,
                1200,
                1400,
                1600,
                1800,
                2000,
                2200,
                2400,
                2600,
                2800,
                3000,
                3200,
                3400,
                3600
            ],
            "val_perplexity_wa": [
                141.65410702884688,
                141.65410702884688,
                50.50755553770605,
                50.50755553770605,
                50.50755553770605,
                41.13698616974948,
                41.13698616974948,
                37.11612582793367,
                37.11579841016075,
                37.11579841016075,
                34.698821411578045,
                34.69908614340817,
                33.25378308202355,
                33.25378308202355,
                33.25378308202355,
                32.32181490465675
            ],
            "val_loss_wa": [
                4.9533915519714355,
                4.9533915519714355,
                3.9221255779266357,
                3.9221255779266357,
                3.9221255779266357,
                3.7169101238250732,
                3.7169101238250732,
                3.614053964614868,
                3.6140451431274414,
                3.6140451431274414,
                3.546708106994629,
                3.54671573638916,
                3.5041708946228027,
                3.5041708946228027,
                3.5041708946228027,
                3.4757447242736816
            ],
            "val_acc_wa": [],
            "val_best_perplexity_wa": [
                141.65410702884688,
                141.65410702884688,
                50.50755553770605,
                50.50755553770605,
                50.50755553770605,
                41.13698616974948,
                41.13698616974948,
                37.11612582793367,
                37.11579841016075,
                37.11579841016075,
                34.698821411578045,
                34.69908614340817,
                33.25378308202355,
                33.25378308202355,
                33.25378308202355,
                32.32181490465675
            ]
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}