{
    "summary": {
        "val/loss_wa": 3.6456198692321777,
        "final-val/acc": 0.3806382417678833,
        "final-val/loss_wa": 3.653209686279297,
        "final-val/perplexity": 38.79852921709308,
        "_runtime": 702.1951909065247,
        "val/loss": 3.627285480499267,
        "_timestamp": 1715206006.1839309,
        "parameters": 33479040,
        "final-val/loss": 3.6583847999572754,
        "train/perplexity": 39.37809040710461,
        "optimized_parameters": 33479040,
        "val/best_perplexity_wa": 38.30641658444316,
        "iter": 3000,
        "_wandb": {
            "runtime": 702
        },
        "val/acc": 0.3855541944503784,
        "train/loss": 3.6732120513916016,
        "final-val/best_perplexity_wa": 38.59826120439407,
        "iter_dt": 0.636516804,
        "val/perplexity": 37.61049149496339,
        "val/best_loss_wa": 3.6456198692321777,
        "final-val/perplexity_wa": 38.59826120439407,
        "final-val/best_loss_wa": 3.653209686279297,
        "lr": 0.00020000060923477085,
        "_step": 89,
        "wa_best_horizon": 500,
        "val/perplexity_wa": 38.30641658444316
    },
    "config": {
        "lr": 0.002,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 384,
        "n_head": 6,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 8,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "cos",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 3000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": null,
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            3000,
            7000,
            10000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": true,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": true,
        "wandb_run_prefix": "sl",
        "max_num_wa_sweeps": 10,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "sl_slimpajama_llama_norm_nlayers8_nhead6_lr0.002_sched_cos_warmup300_iter3000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                3000
            ],
            "final_val_best_perplexity_wa": [
                38.59826120439407
            ],
            "final_val_best_loss_wa": [
                3.653209686279297
            ],
            "final_val_loss": [
                3.6583847999572754
            ],
            "final_val_perplexity": [
                38.79852921709308
            ]
        },
        "val": {
            "iter": [
                0,
                200,
                400,
                600,
                800,
                1000,
                1200,
                1400,
                1600,
                1800,
                2000,
                2200,
                2400,
                2600,
                2800
            ],
            "val_perplexity": [
                49927.02736884548,
                273.28146839666044,
                125.58413738513501,
                75.1397147986758,
                62.6445098452788,
                56.04565306214612,
                51.91016318289133,
                48.42642641695203,
                45.80272068985644,
                43.723647771985405,
                41.83044112521019,
                40.33458362687475,
                39.15678078609988,
                38.25665606011014,
                37.61049149496339
            ],
            "val_loss": [
                10.81832504272461,
                5.610506057739258,
                4.832979202270508,
                4.319352149963379,
                4.137478828430176,
                4.026169300079346,
                3.949517250061035,
                3.8800482749938965,
                3.8243460655212402,
                3.7778916358947754,
                3.7336268424987793,
                3.697211742401123,
                3.6675760746002197,
                3.644320011138916,
                3.6272854804992676
            ],
            "val_acc": [
                0.02794555574655533,
                0.21135619282722473,
                0.2584265172481537,
                0.3211462199687958,
                0.3374059796333313,
                0.34810179471969604,
                0.354583740234375,
                0.36067870259284973,
                0.3661779761314392,
                0.3706909120082855,
                0.3748205602169037,
                0.3781213164329529,
                0.3812853693962097,
                0.38337159156799316,
                0.3855541944503784
            ]
        },
        "train": {
            "iter": [
                50,
                100,
                150,
                200,
                250,
                300,
                350,
                400,
                450,
                500,
                550,
                600,
                650,
                700,
                750,
                800,
                850,
                900,
                950,
                1000,
                1050,
                1100,
                1150,
                1200,
                1250,
                1300,
                1350,
                1400,
                1450,
                1500,
                1550,
                1600,
                1650,
                1700,
                1750,
                1800,
                1850,
                1900,
                1950,
                2000,
                2050,
                2100,
                2150,
                2200,
                2250,
                2300,
                2350,
                2400,
                2450,
                2500,
                2550,
                2600,
                2650,
                2700,
                2750,
                2800,
                2850,
                2900,
                2950,
                3000
            ],
            "train_perplexity": [
                6650.860205415372,
                852.7413096554614,
                448.3500619684347,
                257.68412877832196,
                267.99419636256374,
                183.14258322370284,
                168.31989454704765,
                134.03742016150886,
                124.51803757573204,
                105.99134701869995,
                93.30642400094679,
                84.20072875169647,
                91.33650196620452,
                67.83994558336855,
                71.31298227345276,
                66.79066953285498,
                78.9786640268095,
                58.472464797352636,
                51.80038990018099,
                62.205069716041486,
                61.18652474011196,
                47.82105358238753,
                60.60465152109111,
                49.56776947330712,
                63.60068228220369,
                54.32403055791763,
                60.484985411034884,
                55.4595942337321,
                44.13250001918557,
                58.42079473641204,
                59.33710941408554,
                49.808324959362544,
                42.88961211711818,
                54.71640533295105,
                41.143450027742304,
                48.40404437773484,
                52.68916223020168,
                45.62180341510794,
                47.12152148570151,
                44.856554570042114,
                53.71919107620215,
                53.9915678426034,
                42.63072585518837,
                48.59740840832039,
                42.521998671460736,
                33.71980996598252,
                46.26354128426433,
                45.67813792478206,
                53.79246230472731,
                42.98221338181476,
                46.860815311732864,
                40.008238134135176,
                44.98060166097118,
                39.16494103611749,
                54.591560012234176,
                37.85111715904507,
                44.600286780699996,
                40.100937530509896,
                42.898130949047236,
                39.37809040710461
            ],
            "train_lr": [
                0.00015350299180558842,
                0.0005180058079879229,
                0.0010152009405027529,
                0.0015109933636896634,
                0.001871666366821391,
                0.001999999390765229,
                0.001998415845131389,
                0.001993792344664454,
                0.0019861445338264705,
                0.0019754982903884568,
                0.001961889637868218,
                0.0019453646236381654,
                0.0019259791631155829,
                0.0019037988505625572,
                0.0018788987371357543,
                0.0018513630769370658,
                0.0018212850419243966,
                0.0017887664066472521,
                0.0017539172038738783,
                0.0017168553522752057,
                0.001677706257425392,
                0.0016366023874690543,
                0.0015936828248910024,
                0.0015490927959051328,
                0.0015029831790548927,
                0.001455509994688049,
                0.001406833877033216,
                0.0013571195306644763,
                0.0013065351731932366,
                0.0012552519660730783,
                0.00120344343544358,
                0.001151284884972788,
                0.001098952802685096,
                0.0010466242637816347,
                0.0009944763314738453,
                0.0009426854578576191,
                0.0008914268868552585,
                0.0008408740612455174,
                0.0007911980357881394,
                0.0007425668984286975,
                0.0006951452015421921,
                0.0006490934051399036,
                0.000604567333923504,
                0.0005617176500235947,
                0.0005206893432067454,
                0.00048162124027601946,
                0.0004446455353250183,
                0.00040988734243491316,
                0.00037746427232799706,
                0.00034748603441023105,
                0.0003200540655493414,
                0.0002952611868445687,
                0.0002731912895494488,
                0.0002539190512103672,
                0.0002375096829813801,
                0.00022401870897031153,
                0.00021349177836274772,
                0.00020596451095964322,
                0.00020146237665119004,
                0.00020000060923477085
            ],
            "train_loss": [
                8.802507400512695,
                6.74846076965332,
                6.105578422546387,
                5.551738262176514,
                5.590969085693359,
                5.210268497467041,
                5.1258697509765625,
                4.898122310638428,
                4.824453830718994,
                4.663360595703125,
                4.535892009735107,
                4.433206558227539,
                4.514553546905518,
                4.217154026031494,
                4.267081260681152,
                4.201566219329834,
                4.369180679321289,
                4.068558692932129,
                3.9474003314971924,
                4.130439281463623,
                4.113929748535156,
                3.8674685955047607,
                4.104374408721924,
                3.903343439102173,
                4.152626991271973,
                3.994969367980957,
                4.102397918701172,
                4.015657424926758,
                3.787199020385742,
                4.06767463684082,
                4.083237648010254,
                3.908184766769409,
                3.758632183074951,
                4.002166271209717,
                3.717067241668701,
                3.8795859813690186,
                3.9644124507904053,
                3.8203883171081543,
                3.8527324199676514,
                3.8034722805023193,
                3.9837729930877686,
                3.98883056640625,
                3.752577781677246,
                3.883572816848755,
                3.7500240802764893,
                3.518087863922119,
                3.8343567848205566,
                3.821622371673584,
                3.985136032104492,
                3.760788917541504,
                3.847184419631958,
                3.6890878677368164,
                3.8062338829040527,
                3.6677844524383545,
                3.9998819828033447,
                3.6336629390716553,
                3.7977428436279297,
                3.6914021968841553,
                3.7588307857513428,
                3.6732120513916016
            ]
        },
        "wa": {
            "iter": [
                600,
                800,
                1000,
                1200,
                1400,
                1600,
                1800,
                2000,
                2200,
                2400,
                2600,
                2800
            ],
            "val_perplexity_wa": [
                167.66607637161755,
                167.66607637161755,
                55.72969976876901,
                55.72969976876901,
                55.72969976876901,
                44.98667196995992,
                44.98667196995992,
                40.6839652963901,
                40.68363550429988,
                40.68363550429988,
                38.30669970710278,
                38.30641658444316
            ],
            "val_loss_wa": [
                5.121977806091309,
                5.121977806091309,
                4.0205159187316895,
                4.0205159187316895,
                4.0205159187316895,
                3.806368827819824,
                3.806368827819824,
                3.705836534500122,
                3.7058284282684326,
                3.7058284282684326,
                3.64562726020813,
                3.6456198692321777
            ],
            "val_acc_wa": [],
            "val_best_perplexity_wa": [
                167.66607637161755,
                167.66607637161755,
                55.72969976876901,
                55.72969976876901,
                55.72969976876901,
                44.98667196995992,
                44.98667196995992,
                40.6839652963901,
                40.68363550429988,
                40.68363550429988,
                38.30669970710278,
                38.30641658444316
            ]
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}