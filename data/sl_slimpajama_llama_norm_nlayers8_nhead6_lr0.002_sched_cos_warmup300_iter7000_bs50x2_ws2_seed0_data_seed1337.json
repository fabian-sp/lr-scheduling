{
    "summary": {
        "final-val/best_perplexity_wa": 32.643244991102975,
        "val/perplexity": 31.78842440791354,
        "train/perplexity": 38.77940434495198,
        "val/best_loss_wa": 3.4521284103393555,
        "final-val/perplexity_wa": 32.643244991102975,
        "train/loss": 3.657891750335694,
        "final-val/loss_wa": 3.485640287399292,
        "val/best_perplexity_wa": 31.567436168215103,
        "iter": 7000,
        "_step": 209,
        "val/acc": 0.40190550684928894,
        "_runtime": 1887.2295095920565,
        "final-val/acc": 0.39613911509513855,
        "final-val/loss": 3.4969418048858643,
        "val/perplexity_wa": 31.567436168215103,
        "final-val/perplexity": 33.014255487523315,
        "lr": 0.0002000000989378904,
        "iter_dt": 0.67847497,
        "val/loss": 3.459104537963867,
        "_timestamp": 1715207874.2071755,
        "optimized_parameters": 33479040,
        "final-val/best_loss_wa": 3.485640287399292,
        "_wandb": {
            "runtime": 1887
        },
        "parameters": 33479040,
        "val/loss_wa": 3.4521284103393555,
        "wa_best_horizon": 500
    },
    "config": {
        "lr": 0.002,
        "moe": false,
        "opt": "adamw",
        "bias": false,
        "seed": 0,
        "beta1": 0.9,
        "beta2": 0.95,
        "dtype": "bfloat16",
        "model": "llama_norm",
        "wandb": true,
        "device": "cuda:0",
        "n_embd": 384,
        "n_head": 6,
        "compile": true,
        "dataset": "slimpajama",
        "dropout": 0,
        "n_layer": 8,
        "init_std": 0.02,
        "wa_dtype": "float32",
        "acc_steps": 2,
        "data_seed": 1337,
        "ema_decay": 0.95,
        "grad_clip": 1,
        "scale_emb": 10,
        "scheduler": "cos",
        "tokenizer": "gpt2",
        "batch_size": 50,
        "from_dense": false,
        "iterations": 7000,
        "vocab_size": 50304,
        "wa_horizon": 500,
        "world_size": 2,
        "auto_resume": true,
        "data_in_ram": false,
        "moe_routing": "standard_gating",
        "multiple_of": 256,
        "resume_from": null,
        "rmsnorm_eps": 1e-05,
        "scale_depth": 1.4,
        "wa_interval": 5,
        "datasets_dir": "./datasets/",
        "ema_interval": 10,
        "eval_batches": 32,
        "full_eval_at": [
            3000,
            7000,
            10000
        ],
        "log_dynamics": false,
        "log_interval": 50,
        "warmup_steps": 300,
        "weight_decay": 0.1,
        "config_format": "base",
        "eval_interval": 200,
        "wandb_project": "scaling-laws-slimpajama",
        "parallel_block": false,
        "use_pretrained": "none",
        "weight_average": true,
        "capacity_factor": 2,
        "eval_seq_prefix": "none",
        "experiment_name": null,
        "moe_num_experts": 8,
        "moe_router_loss": "load_balancing_z_loss",
        "sequence_length": 512,
        "wa_use_temp_dir": false,
        "wsd_fract_decay": 0,
        "ema_after_warmup": false,
        "scale_base_model": 256,
        "wa_sweep_horizon": true,
        "wandb_run_prefix": "sl",
        "max_num_wa_sweeps": 10,
        "moe_softmax_order": "topk_softmax",
        "moe_z_loss_factor": 0.01,
        "mlp_dim_exp_factor": 1,
        "plot_router_logits": false,
        "wsd_final_lr_scale": 0,
        "distributed_backend": "nccl",
        "dynamics_logger_cfg": "./src/logger/rotational_logger.yaml",
        "moe_aux_loss_factor": 0.1,
        "results_base_folder": "./exps",
        "latest_ckpt_interval": 1000,
        "wsd_exponential_decay": false,
        "moe_num_shared_experts": 0,
        "moe_entropy_loss_factor": 0.01,
        "moe_num_experts_per_tok": 2,
        "permanent_ckpt_interval": 0,
        "exponential_moving_average": false
    },
    "name": "sl_slimpajama_llama_norm_nlayers8_nhead6_lr0.002_sched_cos_warmup300_iter7000_bs50x2_ws2_seed0_data_seed1337",
    "history": {
        "final-val": {
            "iter": [
                3000,
                7000
            ],
            "final_val_best_perplexity_wa": [
                38.15443597942987,
                32.643244991102975
            ],
            "final_val_best_loss_wa": [
                3.6416444778442383,
                3.485640287399292
            ],
            "final_val_loss": [
                3.718482732772827,
                3.4969418048858643
            ],
            "final_val_perplexity": [
                41.20172941329293,
                33.014255487523315
            ]
        },
        "val": {
            "iter": [
                0,
                200,
                400,
                600,
                800,
                1000,
                1200,
                1400,
                1600,
                1800,
                2000,
                2200,
                2400,
                2600,
                2800,
                3200,
                3400,
                3600,
                3800,
                4000,
                4200,
                4400,
                4600,
                4800,
                5000,
                5200,
                5400,
                5600,
                5800,
                6000,
                6200,
                6400,
                6600,
                6800
            ],
            "val_perplexity": [
                49927.02736884548,
                282.0636567423154,
                124.74630510917707,
                74.28152339744241,
                62.27442767378967,
                55.94936684383077,
                52.24973715588626,
                49.62356938240116,
                47.381836678070776,
                45.70152583393657,
                44.283918248368956,
                43.03158463785601,
                41.87103157063314,
                40.958304267139816,
                40.17273642848783,
                38.7418017354815,
                38.18655181423978,
                37.422261828431985,
                36.89466618930485,
                36.2569287239184,
                35.719156768230384,
                35.25195429377807,
                34.77554568361401,
                34.380069488408076,
                33.98145798946423,
                33.54239003569123,
                33.24455580451802,
                32.94642037503699,
                32.68047553804899,
                32.451777126184666,
                32.20530855551001,
                32.02258532881605,
                31.883272134292756,
                31.78842440791354
            ],
            "val_loss": [
                10.81832504272461,
                5.642136573791504,
                4.826285362243652,
                4.307865142822266,
                4.131553649902344,
                4.024449825286865,
                3.9560375213623047,
                3.904468536376953,
                3.858241558074951,
                3.822134256362915,
                3.7906241416931152,
                3.761936902999878,
                3.7345967292785645,
                3.712557077407837,
                3.6931910514831543,
                3.656921625137329,
                3.6424858570098877,
                3.6222681999206543,
                3.60806941986084,
                3.590632915496826,
                3.5756895542144775,
                3.562523365020752,
                3.548916816711426,
                3.5374794006347656,
                3.525817394256592,
                3.512812376022339,
                3.5038933753967285,
                3.494884967803955,
                3.4867801666259766,
                3.47975754737854,
                3.4721336364746094,
                3.4664437770843506,
                3.4620838165283203,
                3.459104537963867
            ],
            "val_acc": [
                0.02794555574655533,
                0.20858153700828552,
                0.2588866949081421,
                0.3217089772224426,
                0.33812010288238525,
                0.34804201126098633,
                0.35435301065444946,
                0.35773801803588867,
                0.36244750022888184,
                0.3652307093143463,
                0.3686559796333313,
                0.3706139922142029,
                0.3732653856277466,
                0.37544676661491394,
                0.37782958149909973,
                0.3818298280239105,
                0.3830493092536926,
                0.3850146234035492,
                0.3864428400993347,
                0.3878747522830963,
                0.3896484375,
                0.3909912109375,
                0.3921484351158142,
                0.3928283751010895,
                0.39433711767196655,
                0.39617919921875,
                0.3968444764614105,
                0.3983996510505676,
                0.3986437916755676,
                0.40018919110298157,
                0.4010644555091858,
                0.401214599609375,
                0.4014025926589966,
                0.40190550684928894
            ]
        },
        "train": {
            "iter": [
                50,
                100,
                150,
                200,
                250,
                300,
                350,
                400,
                450,
                500,
                550,
                600,
                650,
                700,
                750,
                800,
                850,
                900,
                950,
                1000,
                1050,
                1100,
                1150,
                1200,
                1250,
                1300,
                1350,
                1400,
                1450,
                1500,
                1550,
                1600,
                1650,
                1700,
                1750,
                1800,
                1850,
                1900,
                1950,
                2000,
                2050,
                2100,
                2150,
                2200,
                2250,
                2300,
                2350,
                2400,
                2450,
                2500,
                2550,
                2600,
                2650,
                2700,
                2750,
                2800,
                2850,
                2900,
                2950,
                3000,
                3050,
                3100,
                3150,
                3200,
                3250,
                3300,
                3350,
                3400,
                3450,
                3500,
                3550,
                3600,
                3650,
                3700,
                3750,
                3800,
                3850,
                3900,
                3950,
                4000,
                4050,
                4100,
                4150,
                4200,
                4250,
                4300,
                4350,
                4400,
                4450,
                4500,
                4550,
                4600,
                4650,
                4700,
                4750,
                4800,
                4850,
                4900,
                4950,
                5000,
                5050,
                5100,
                5150,
                5200,
                5250,
                5300,
                5350,
                5400,
                5450,
                5500,
                5550,
                5600,
                5650,
                5700,
                5750,
                5800,
                5850,
                5900,
                5950,
                6000,
                6050,
                6100,
                6150,
                6200,
                6250,
                6300,
                6350,
                6400,
                6450,
                6500,
                6550,
                6600,
                6650,
                6700,
                6750,
                6800,
                6850,
                6900,
                6950,
                7000
            ],
            "train_perplexity": [
                6651.101234293891,
                862.6911235372714,
                442.41216945397923,
                265.9994511260124,
                258.3772043843285,
                178.71192102167709,
                169.07668747027353,
                134.2433172407962,
                122.22521811016523,
                104.95020322592902,
                93.13955065767618,
                83.11439223518802,
                91.50010124922596,
                67.86337000215663,
                70.36788446778561,
                66.80767866465943,
                78.40684434101921,
                58.715204553543415,
                52.00318035133321,
                62.413792330899966,
                61.82248839196342,
                48.24727988472576,
                61.04055660152182,
                50.30837837089458,
                64.11066547727751,
                55.50795709310883,
                61.55078745181486,
                56.59241637225551,
                45.06506963264813,
                60.681252096502554,
                61.05720772499398,
                51.99289060116873,
                44.86041549719338,
                57.20506494773192,
                42.721077343716665,
                50.11587694974251,
                55.42023134008189,
                48.39923226359466,
                49.67733567632247,
                47.531856653420824,
                57.349490282574955,
                57.41699342307326,
                45.59662992675552,
                51.57917808947436,
                45.635358267848204,
                36.06498148486941,
                49.53985171327589,
                49.084075973795024,
                58.01255996230086,
                46.11344530025987,
                49.71859357906239,
                42.79017041867439,
                47.94870292458014,
                41.5948729792239,
                59.01132314974061,
                40.49966090627345,
                47.75377556757415,
                42.58285006090994,
                46.11300553056843,
                41.9349904166899,
                48.47565942158215,
                44.55717803061326,
                50.302141646619155,
                49.131388757430905,
                46.11397302942566,
                43.0058922073457,
                47.99125972750648,
                35.20554881309189,
                54.30715691917653,
                40.94464501069306,
                32.74315688150716,
                39.86894905019668,
                39.724944896253206,
                36.96071559270123,
                46.38001087363321,
                31.461269070685624,
                41.72196447139851,
                44.314652985112275,
                33.490321234171056,
                49.194238468222395,
                40.536630765647715,
                35.256367045423545,
                41.06691023755634,
                46.24460651216548,
                31.029304584907045,
                39.60492808622906,
                43.87006504061298,
                34.21763237293784,
                31.33620749302469,
                42.125143694934366,
                47.7293715514057,
                42.73893624245943,
                39.530845159986924,
                41.87215964506951,
                36.548457210904395,
                45.418107630340195,
                39.97643921046856,
                36.44077385501646,
                35.27108861663088,
                37.420414987612055,
                37.787719730067145,
                43.55690312661709,
                42.798659295278114,
                29.507201844229133,
                36.8183663309428,
                37.00257920702045,
                47.21791202622502,
                37.885560920465345,
                33.09695934731788,
                39.67683215670423,
                32.764233599107776,
                44.9922389273483,
                32.165482622665785,
                35.55058775023339,
                35.07757733553987,
                41.08274551110207,
                34.82571830907908,
                40.43629081379845,
                49.3211551812245,
                29.804471359030646,
                33.91237130225992,
                35.67487494584601,
                33.42401804871178,
                31.22836842141834,
                38.67412775613934,
                34.369997045598645,
                35.84928939237304,
                49.155747842437414,
                36.13935819418898,
                42.628672786677164,
                31.604502155277192,
                38.96834647478932,
                38.553434092718334,
                46.84799105809286,
                45.82336454181282,
                29.649935576994856,
                41.47844225904137,
                33.227225910746434,
                34.413011974364174,
                38.77940434495198
            ],
            "train_lr": [
                0.00015350299180558842,
                0.0005180058079879229,
                0.0010152009405027529,
                0.0015109933636896634,
                0.001871666366821391,
                0.0019999999010621096,
                0.001999742674805614,
                0.0019989909231803763,
                0.0019977450593714786,
                0.001996005768142772,
                0.0019937740054605125,
                0.0019910509979679325,
                0.001987838242311043,
                0.00198413750431603,
                0.001979950818018704,
                0.0019752804845465355,
                0.0019701290708538854,
                0.00196449940831113,
                0.0019583945911484557,
                0.00195181797475518,
                0.0019447731738355255,
                0.001937264060421875,
                0.0019292947617465847,
                0.0019208696579735348,
                0.0019119933797906623,
                0.0019026708058647952,
                0.0018929070601601927,
                0.0018827075091222617,
                0.0018720777587279997,
                0.0018610236514047807,
                0.0018495512628191853,
                0.0018376668985376316,
                0.0018253770905606501,
                0.0018126885937326995,
                0.0017996083820295047,
                0.0017861436447249514,
                0.001772301782439647,
                0.001758090403073319,
                0.0017435173176232872,
                0.0017285905358913076,
                0.0017133182620811445,
                0.0016977088902892976,
                0.001681770999891357,
                0.0016655133508265215,
                0.001648944878782876,
                0.0016320746902860708,
                0.0016149120576941043,
                0.0015974664141009585,
                0.00157974734815189,
                0.0015617645987732244,
                0.0015435280498195534,
                0.0015250477246412728,
                0.0015063337805754516,
                0.0014873965033630567,
                0.0014682463014956029,
                0.0014488937004943367,
                0.001429349337125096,
                0.0014096239535520269,
                0.00138972839143337,
                0.0013696735859625637,
                0.0013494705598579334,
                0.0013291304173042799,
                0.001308664337849688,
                0.001288083570260913,
                0.0012673994263407244,
                0.0012466232747106027,
                0.0012257665345622051,
                0.0012048406693810382,
                0.0011838571806457856,
                0.0011628276015067528,
                0.0011417634904469023,
                0.0011206764249289706,
                0.0010995779950321457,
                0.0010784797970818192,
                0.0010573934272758959,
                0.001036330475311181,
                0.0010153025180133371,
                0.0009943211129739152,
                0.0009733977921979593,
                0.0009525440557656715,
                0.0009317713655116272,
                0.0009110911387250084,
                0.0008905147418743218,
                0.0008700534843600492,
                0.0008497186122986642,
                0.0008295213023414317,
                0.0008094726555313874,
                0.0007895836912018744,
                0.0007698653409199892,
                0.0007503284424782657,
                0.0007309837339379038,
                0.0007118418477268098,
                0.000692913304795698,
                0.0006742085088354624,
                0.0006557377405589979,
                0.0006375111520506157,
                0.0006195387611861549,
                0.0006018304461268585,
                0.0005843959398900438,
                0.0005672448249995441,
                0.0005503865282188697,
                0.0005338303153699781,
                0.0005175852862405005,
                0.0005016603695822299,
                0.0004860643182036114,
                0.00047080570415893887,
                0.000455892914036898,
                0.00044133414435104873,
                0.000427137397034776,
                0.00041331047504318893,
                0.00039986097806438505,
                0.0003867962983424345,
                0.0003741236166143841,
                0.000361849898163508,
                0.00034998188899098333,
                0.00033852611210808466,
                0.0003274888639509439,
                0.0003168762109198419,
                0.0003066939860449329,
                0.0002969477857802392,
                0.00028764296692767086,
                0.0002787846436927708,
                0.0002703776848737926,
                0.000262426711185666,
                0.00025493609272031253,
                0.0002479099465447141,
                0.00024135213443805042,
                0.000235266260769149,
                0.00022965567051541803,
                0.00022452344742434637,
                0.00021987241231858428,
                0.00021570512154553542,
                0.00021202386557231227,
                0.00020883066772682662,
                0.00020612728308570927,
                0.0002039151975096665,
                0.00020219562682680776,
                0.0002009695161643898,
                0.00020023753942934654,
                0.0002000000989378904
            ],
            "train_loss": [
                8.802543640136719,
                6.760061264038086,
                6.092246055603027,
                5.583498001098633,
                5.554424285888672,
                5.185778617858887,
                5.1303558349609375,
                4.899657249450684,
                4.805868625640869,
                4.653489112854004,
                4.534101963043213,
                4.420220851898193,
                4.516343116760254,
                4.217499256134033,
                4.253739833831787,
                4.2018208503723145,
                4.361914157867432,
                4.072701454162598,
                3.951307535171509,
                4.1337890625,
                4.124269962310791,
                3.8763420581817627,
                4.111541271209717,
                3.9181742668151855,
                4.160613536834717,
                4.016529083251953,
                4.119865417480469,
                4.035877704620361,
                3.808109998703003,
                4.105637550354004,
                4.111814022064209,
                3.9511096477508545,
                3.803558349609375,
                4.046645164489746,
                3.754694938659668,
                3.9143404960632324,
                4.014947414398193,
                3.879486560821533,
                3.9055514335632324,
                3.861402750015259,
                4.049166679382324,
                4.050343036651611,
                3.819836378097534,
                3.9431207180023193,
                3.820685386657715,
                3.585324764251709,
                3.902780055999756,
                3.8935372829437256,
                4.060662269592285,
                3.8311071395874023,
                3.906381607055664,
                3.7563109397888184,
                3.8701343536376953,
                3.7279794216156006,
                4.077732086181641,
                3.701296091079712,
                3.866060733795166,
                3.7514541149139404,
                3.8310976028442383,
                3.7361230850219727,
                3.8810644149780273,
                3.7967758178710938,
                3.9180502891540527,
                3.894500732421875,
                3.831118583679199,
                3.7613396644592285,
                3.8710215091705322,
                3.561206102371216,
                3.9946587085723877,
                3.712223529815674,
                3.488696336746216,
                3.6856002807617188,
                3.6819818019866943,
                3.6098580360412598,
                3.8368711471557617,
                3.4487595558166504,
                3.731030225753784,
                3.791317939758301,
                3.511258840560913,
                3.8957791328430176,
                3.7022085189819336,
                3.5626485347747803,
                3.715205192565918,
                3.8339474201202393,
                3.434934377670288,
                3.6789560317993164,
                3.7812347412109375,
                3.532743453979492,
                3.4447765350341797,
                3.740647315979004,
                3.8655495643615723,
                3.755112886428833,
                3.677083730697632,
                3.734623670578003,
                3.5986413955688477,
                3.815913438796997,
                3.6882927417755127,
                3.5956907272338867,
                3.563066005706787,
                3.6222188472747803,
                3.631986618041992,
                3.7740707397460938,
                3.756509304046631,
                3.384636640548706,
                3.605999231338501,
                3.610990047454834,
                3.854775905609131,
                3.6345725059509277,
                3.499443769454956,
                3.680769920349121,
                3.489339828491211,
                3.806492567062378,
                3.4708962440490723,
                3.5709590911865234,
                3.5575644969940186,
                3.715590715408325,
                3.550358533859253,
                3.699730157852173,
                3.898355722427368,
                3.394660711288452,
                3.523782253265381,
                3.574449062347412,
                3.509277105331421,
                3.44132924079895,
                3.6551733016967773,
                3.53718638420105,
                3.5793261528015137,
                3.894996404647827,
                3.5873849391937256,
                3.7525296211242676,
                3.4533019065856934,
                3.662752151489258,
                3.652047634124756,
                3.8469107151031494,
                3.824796676635742,
                3.3894622325897217,
                3.7251763343811035,
                3.5033719539642334,
                3.5384371280670166,
                3.6578917503356934
            ]
        },
        "wa": {
            "iter": [
                600,
                800,
                1000,
                1200,
                1400,
                1600,
                1800,
                2000,
                2200,
                2400,
                2600,
                2800,
                3200,
                3400,
                3600,
                3800,
                4000,
                4200,
                4400,
                4600,
                4800,
                5000,
                5200,
                5400,
                5600,
                5800,
                6000,
                6200,
                6400,
                6600,
                6800
            ],
            "val_perplexity_wa": [
                164.6244282877096,
                164.6244282877096,
                55.029500201487075,
                55.029500201487075,
                55.029500201487075,
                44.663515992339036,
                44.663515992339036,
                40.5999161118537,
                40.59934500957027,
                40.59934500957027,
                38.158775361754685,
                38.158065743472136,
                36.55476656500474,
                36.55476656500474,
                35.32060352650114,
                35.32060352650114,
                34.345594474774096,
                34.345594474774096,
                34.345594474774096,
                33.50404177476853,
                33.50404177476853,
                32.84194163049513,
                32.84194163049513,
                32.84194163049513,
                32.31528077884192,
                32.31528077884192,
                31.907591191019208,
                31.907591191019208,
                31.907591191019208,
                31.567436168215103,
                31.567436168215103
            ],
            "val_loss_wa": [
                5.103670120239258,
                5.103670120239258,
                4.007872104644775,
                4.007872104644775,
                4.007872104644775,
                3.799159526824951,
                3.799159526824951,
                3.703768491744995,
                3.703754425048828,
                3.703754425048828,
                3.6417582035064697,
                3.6417396068573,
                3.598814010620117,
                3.598814010620117,
                3.5644688606262207,
                3.5644688606262207,
                3.5364761352539062,
                3.5364761352539062,
                3.5364761352539062,
                3.5116684436798096,
                3.5116684436798096,
                3.491708755493164,
                3.491708755493164,
                3.491708755493164,
                3.4755425453186035,
                3.4755425453186035,
                3.462846279144287,
                3.462846279144287,
                3.462846279144287,
                3.4521284103393555,
                3.4521284103393555
            ],
            "val_acc_wa": [],
            "val_best_perplexity_wa": [
                164.6244282877096,
                164.6244282877096,
                55.029500201487075,
                55.029500201487075,
                55.029500201487075,
                44.663515992339036,
                44.663515992339036,
                40.5999161118537,
                40.59934500957027,
                40.59934500957027,
                38.158775361754685,
                38.158065743472136,
                36.55476656500474,
                36.55476656500474,
                35.32060352650114,
                35.32060352650114,
                34.345594474774096,
                34.345594474774096,
                34.345594474774096,
                33.50404177476853,
                33.50404177476853,
                32.84194163049513,
                32.84194163049513,
                32.84194163049513,
                32.31528077884192,
                32.31528077884192,
                31.907591191019208,
                31.907591191019208,
                31.907591191019208,
                31.567436168215103,
                31.567436168215103
            ]
        },
        "ema": {
            "iter": [],
            "val_perplexity_ema": [],
            "val_acc_ema": [],
            "val_loss_ema": []
        }
    }
}